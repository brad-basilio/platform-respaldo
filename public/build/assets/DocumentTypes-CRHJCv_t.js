import{r as d,j as e,H as z,a as f}from"./app-BYV62cDu.js";import{A as F}from"./AuthenticatedLayout-Cb0wyeIV.js";import{A as I,t as L,M as $,a as H}from"./index.esm-BuQJb_CW.js";import{I as b}from"./input-wZYB9Xbp.js";import{R as q,a as G,b as Q,c as O,C as E,d as P,S as l}from"./DocumentConfirmationModal-BYN4fF8Y.js";import{S as W}from"./search-CPJkh1N6.js";/* empty css            */import"./index-l3Zsz6n-.js";import"./button-BJn5UaVm.js";import"./clsx-B-dksMZM.js";import"./dropdown-menu-BAEe9cJy.js";import"./createLucideIcon-6SHTFon0.js";import"./index-B8HOWM92.js";import"./index-Bju26oEr.js";import"./badge-DsPICywl.js";import"./x-DsmFtbob.js";import"./triangle-alert-CMUJ9rsX.js";import"./circle-check-big-CfJpx-x5.js";import"./clock-B4cKxM-S.js";$.registerModules([H]);const ue=({documentTypes:D})=>{const[i,m]=d.useState(D),[_,w]=d.useState(!1),[a,g]=d.useState(null),[u,j]=d.useState(!1),[v,y]=d.useState(""),[c,p]=d.useState({name:"",code:"",description:"",is_active:!0,sort_order:0}),N=t=>{t?(g(t),p({name:t.name,code:t.code,description:t.description||"",is_active:t.is_active,sort_order:t.sort_order})):(g(null),p({name:"",code:"",description:"",is_active:!0,sort_order:0})),w(!0)},x=()=>{w(!1),g(null),p({name:"",code:"",description:"",is_active:!0,sort_order:0})},B=t=>t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9\s-]/g,"").trim().replace(/\s+/g,"_").replace(/-+/g,"_"),S=async()=>{if(!c.name){await l.fire({title:"Campo Requerido",text:"El nombre es obligatorio",icon:"warning",confirmButtonColor:"#f59e0b"});return}j(!0);try{const t=a?`/admin/document-types/${a.id}`:"/admin/document-types",r=a?"put":"post",o={...c,code:a?a.code:B(c.name)},s=await f[r](t,o);s.data.success&&(m(a?i.map(h=>h.id===a.id?s.data.document_type:h):[...i,s.data.document_type]),x(),await l.fire({title:"¡Éxito!",text:a?"Tipo de documento actualizado":"Tipo de documento creado",icon:"success",timer:2e3,showConfirmButton:!1}))}catch(t){console.error("Error saving document type:",t),await l.fire({title:"Error",text:t.response?.data?.message||"Error al guardar el tipo de documento",icon:"error",confirmButtonColor:"#ef4444"})}finally{j(!1)}},T=async t=>{try{const r=await f.post(`/admin/document-types/${t.id}/toggle-active`);r.data.success&&m(i.map(o=>o.id===t.id?r.data.document_type:o))}catch(r){console.error("Error toggling active:",r),await l.fire({title:"Error",text:r.response?.data?.message||"Error al cambiar el estado",icon:"error",confirmButtonColor:"#ef4444"})}},R=async t=>{if((await l.fire({title:"¿Eliminar Tipo de Documento?",html:`
        <p>¿Estás seguro de eliminar <strong>${t.name}</strong>?</p>
        <p class="text-sm text-red-600 mt-2">Esta acción no se puede deshacer.</p>
      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:"Sí, Eliminar",cancelButtonText:"Cancelar"})).isConfirmed)try{(await f.delete(`/admin/document-types/${t.id}`)).data.success&&(m(i.filter(s=>s.id!==t.id)),await l.fire({title:"¡Eliminado!",text:"Tipo de documento eliminado exitosamente",icon:"success",timer:2e3,showConfirmButton:!1}))}catch(o){console.error("Error deleting document type:",o),await l.fire({title:"Error",text:o.response?.data?.message||"Error al eliminar el tipo de documento",icon:"error",confirmButtonColor:"#ef4444"})}},k=async t=>{const r=t.node.data,o=t.overIndex,s=[...i],h=s.findIndex(n=>n.id===r.id);s.splice(h,1),s.splice(o,0,r);const C=s.map((n,A)=>({...n,sort_order:A+1}));m(C);try{await f.post("/admin/document-types/reorder",{order:C.map(n=>({id:n.id,sort_order:n.sort_order}))})}catch(n){console.error("Error reordering:",n),m(i),await l.fire({title:"Error",text:"No se pudo actualizar el orden",icon:"error",confirmButtonColor:"#ef4444"})}},M=d.useMemo(()=>[{headerName:"",rowDrag:!0,width:50,suppressMenu:!0,cellClass:"cursor-move"},{headerName:"Nombre",field:"name",flex:1,filter:"agTextColumnFilter",cellRenderer:t=>e.jsx("div",{className:"flex items-center h-full",children:e.jsx("span",{className:"font-medium text-gray-900",children:t.value})})},{headerName:"Descripción",field:"description",flex:2,cellRenderer:t=>e.jsx("div",{className:"flex items-center h-full",children:e.jsx("span",{className:"text-sm text-gray-600",children:t.value||"Sin descripción"})})},{headerName:"Estado",field:"is_active",width:120,cellRenderer:t=>{const r=t.data;return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("button",{onClick:()=>T(r),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${t.value?"bg-[#17BC91]":"bg-gray-300"}`,title:t.value?"Activo - Clic para desactivar":"Inactivo - Clic para activar",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.value?"translate-x-6":"translate-x-1"}`})})})}},{headerName:"Acciones",width:150,cellRenderer:t=>{const r=t.data;return e.jsxs("div",{className:"flex items-center justify-center gap-2 h-full",children:[e.jsx("button",{onClick:()=>N(r),className:"p-2 text-[#073372] hover:bg-blue-50 rounded-lg transition-colors",title:"Editar",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(r),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar",children:e.jsx(G,{className:"h-4 w-4"})})]})}}],[i]);return e.jsxs(F,{children:[e.jsx(z,{title:"Tipos de Documentos"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Q,{className:"text-[#17BC91]"}),"Tipos de Documentos"]}),e.jsx("p",{className:"text-gray-600",children:"Gestiona los tipos de documentos para verificación de matrícula"})]}),e.jsxs("button",{onClick:()=>N(),className:"flex items-center gap-2 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-6 py-3 rounded-xl font-medium hover:shadow-lg transition-all",children:[e.jsx(O,{className:"h-5 w-5"}),"Agregar Tipo"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{type:"text",label:"Buscar por nombre o descripción...",value:v,onChange:t=>y(t.target.value),icon:e.jsx(W,{className:"w-4 h-4"}),className:"pr-10"}),v&&e.jsx("button",{onClick:()=>y(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors z-20",children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"ag-theme-quartz",style:{height:"600px",width:"100%"},children:e.jsx(I,{theme:L,rowData:i,columnDefs:M,quickFilterText:v,defaultColDef:{sortable:!0,filter:!0,resizable:!0,minWidth:100},rowDragManaged:!0,animateRows:!0,onRowDragEnd:k,pagination:!1,rowHeight:60,headerHeight:48})})})]}),_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",onClick:x,children:e.jsxs("div",{className:"bg-white rounded-3xl max-w-2xl w-full shadow-2xl animate-scale-in",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] px-8 py-6 flex items-center justify-between rounded-t-3xl",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:a?"Editar Tipo de Documento":"Nuevo Tipo de Documento"}),e.jsx("p",{className:"text-blue-100 text-sm",children:a?"Modifica la información del tipo":"Completa los datos del nuevo tipo"})]}),e.jsx("button",{onClick:x,className:"text-white hover:bg-white/20 rounded-full p-2 transition-colors",children:e.jsx(E,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-8 space-y-6",children:[e.jsx(b,{label:"Nombre del Tipo *",type:"text",value:c.name,onChange:t=>p({...c,name:t.target.value}),placeholder:"Ej: Contrato, Reglamento, Términos...",disabled:u}),e.jsx(b,{label:"Descripción",type:"text",value:c.description,onChange:t=>p({...c,description:t.target.value}),placeholder:"Descripción opcional del tipo de documento",disabled:u})]}),e.jsxs("div",{className:"bg-gray-50 px-8 py-5 border-t border-gray-200 flex justify-end gap-3 rounded-b-3xl",children:[e.jsx("button",{onClick:x,disabled:u,className:"px-6 py-2.5 rounded-xl font-medium text-gray-700 hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:S,disabled:u,className:"flex items-center gap-2 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-6 py-2.5 rounded-xl font-medium hover:shadow-lg transition-all disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-5 w-5"}),a?"Actualizar":"Crear"]})})]})]})})]})};export{ue as default};
