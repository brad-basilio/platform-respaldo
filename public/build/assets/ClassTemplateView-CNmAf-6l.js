import{d as Ye,r as l,a as L,j as e,H as We,L as Xe,b as Be}from"./app-CtWtaj7p.js";import{A as Ze,F as O,D as Je,C as Ke,t as w}from"./AuthenticatedLayout-SRBeiTFQ.js";import{B as o}from"./button-DRYv1lcU.js";import{T as ae}from"./textarea-CRRi7P1E.js";import{B as $}from"./badge-BaAYWB2b.js";import{P as es}from"./progress-C2xfgt2_.js";import{A as ss}from"./arrow-left-CJA0ERAF.js";import{P as te}from"./play-5CyyZGuL.js";import{V as as}from"./video-884q4xKt.js";import{F as Fe}from"./film-BeXf1alC.js";import{C as pe}from"./clock-CTBaN94k.js";import{F as j}from"./file-question-BoZlBymz.js";import{c as Pe}from"./createLucideIcon-IGXxbhrr.js";import{T as ts}from"./target--or_6rQ4.js";import{B as rs}from"./book-open-8OKZ4RKV.js";import{C as y}from"./circle-check-big-C4v64KOU.js";import{A as be}from"./award-DCFf_Z7x.js";import{E as G}from"./eye-ttyVXeft.js";import{L as je}from"./lock-C931F0PZ.js";import{E as ls}from"./external-link-Cxh88Vat.js";import{G as is}from"./graduation-cap-9TJJ5FE0.js";import{U as re}from"./users-OEOvzJZ_.js";import{C as k}from"./calendar-weWaR35u.js";import{S as Ee}from"./send-Ck1BwVIk.js";import{U as ns}from"./user-plus-Cz2qlJ1m.js";import{P as cs}from"./plus-DSgA9FaP.js";import{T as $e}from"./triangle-alert-DyhuHxC7.js";import{X as fe}from"./x-DO28QfK-.js";import{L as le}from"./loader-circle-V4ODuXON.js";import{C as os}from"./chevron-right-DP6IksD9.js";import{L as ds,I as ms}from"./link-CLBXlQH4.js";/* empty css            */import"./dropdown-menu-BzgWwHrw.js";import"./index-DH28hQTN.js";import"./index-0zIPZUJh.js";import"./index-Dm-T3bbY.js";import"./clsx-B-dksMZM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],hs=Pe("ChevronLeft",xs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],gs=Pe("Sparkles",us),ea=({template:t,existingRequest:f,enrollment:d,studentInfo:Ne})=>{const{props:Q}=Ye(),h=d?.scheduled_class||null,ie=!!h,A=h?.status==="completed",[z,I]=l.useState(!1),[H,P]=l.useState(""),[M,ne]=l.useState(!1),[ce,Y]=l.useState([]),[Me,W]=l.useState(!1),[C,De]=l.useState(null),[_,X]=l.useState([]),[oe,Z]=l.useState(!1),[m,g]=l.useState(null),[R,Te]=l.useState(null),[p,V]=l.useState(""),[Le,D]=l.useState(!1),[b,Ae]=l.useState([]),[ze,ve]=l.useState(!1),[v,J]=l.useState(0),[S,ye]=l.useState({}),[we,de]=l.useState(!1),[i,K]=l.useState(null),[Ie,q]=l.useState(!1),[He,Ce]=l.useState(!1),[n,Re]=l.useState(null),me=Ne?.studentType??"regular",xe=Ne?.isVerified??!1,B=me==="regular"&&xe,F=me==="daily"&&xe,E=me==="weekly"&&xe;l.useEffect(()=>{(B||F||E)&&L.get("/api/student/class-config").then(s=>De(s.data)).catch(s=>console.error("Error loading class config:",s))},[B,F,E]);const T=l.useMemo(()=>{if(!C)return null;const s=new Date,{min_advance_hours:a,operation_start_hour:r,operation_end_hour:c}=C;let u=s.getHours()+a;s.getMinutes()>0&&(u+=1);const x=new Date(s);return x.setHours(u,0,0,0),x.getHours()>=c&&(x.setDate(x.getDate()+1),x.setHours(r,0,0,0)),x.getHours()<r&&x.setHours(r,0,0,0),x},[C]),U=s=>{const a=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),c=String(s.getDate()).padStart(2,"0"),u=String(s.getHours()).padStart(2,"0"),x=String(s.getMinutes()).padStart(2,"0"),ge=String(s.getSeconds()).padStart(2,"0");return`${a}-${r}-${c}T${u}:${x}:${ge}`};l.useEffect(()=>{z&&B&&T&&(Z(!0),g(null),L.get(`/api/student/available-classes/${t.id}`,{params:{datetime:U(T)}}).then(s=>{const a=s.data.classes||[];X(a);const r=a.find(c=>c.available_spots>0);g(r?r.id:null)}).catch(s=>{console.error("Error loading available classes:",s),X([])}).finally(()=>Z(!1)))},[z,B,T,t.id]),l.useEffect(()=>{z&&(F||E)&&p&&(Z(!0),g(null),L.get(`/api/student/available-classes/${t.id}`,{params:{datetime:p}}).then(s=>{const a=s.data.classes||[];X(a);const r=a.find(c=>c.available_spots>0);g(r?r.id:null)}).catch(s=>{console.error("Error loading available classes:",s),X([])}).finally(()=>Z(!1)))},[z,F,E,p,t.id]),l.useEffect(()=>{T&&Te(T)},[T]),l.useEffect(()=>{Q.flash?.alternative_slots&&Q.flash.alternative_slots.length>0&&(Y(Q.flash.alternative_slots),W(!0),ne(!1))},[Q.flash?.alternative_slots]);const he=s=>{if(f||h)return;ne(!0),W(!1);let a=s||null,r=null;s||(B?m?(a=_.find(x=>x.id===m)?.scheduled_at||null,r=m):R&&(a=U(R)):F||E?p&&(a=p,m&&(r=m)):p&&(a=p));const c={class_template_id:t.id,message:H.trim()||null,requested_datetime:a,target_scheduled_class_id:r};Be.post("/student/class-requests",c,{onSuccess:()=>{r?w.success("¬°Te has inscrito exitosamente en el grupo!"):w.success("¬°Tu clase ha sido programada exitosamente!"),I(!1),P(""),g(null),V(""),Y([])},onError:u=>{if(u.no_teacher)w.error(u.no_teacher);else{const x=Object.values(u)[0]||"Error al enviar la solicitud";w.error(x)}ne(!1)}})},Ve=s=>s.toLocaleString("es-PE",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}),ee=async()=>{if(d){ve(!0),D(!0),ye({}),J(0),K(null);try{const s=await L.get(`/api/student/class-enrollments/${d.id}/exam-questions`);Ae(s.data.questions)}catch(s){const a=s;w.error(a.response?.data?.error||"Error al cargar el examen"),D(!1)}finally{ve(!1)}}},qe=(s,a)=>{ye(r=>({...r,[s]:a}))},Ue=async()=>{if(!d||b.length===0)return;de(!0);const s=b.map((a,r)=>({question_id:a.id,answer:S[r]||null}));try{const a=await L.post(`/student/class-enrollments/${d.id}/submit-exam`,{answers:s});K(a.data),de(!1),a.data.passed?w.success("¬°Felicitaciones! Has aprobado la evaluaci√≥n."):w.error("No alcanzaste el puntaje m√≠nimo. Puedes intentar de nuevo.")}catch(a){const r=a;w.error(r.response?.data?.message||"Error al enviar el examen"),de(!1)}},_e=()=>{D(!1),K(null),Be.reload()},ue=async()=>{if(d){Ce(!0),q(!0);try{const s=await L.get(`/api/student/class-enrollments/${d.id}/exam-results`);Re(s.data)}catch(s){const a=s;w.error(a.response?.data?.error||"Error al cargar los resultados"),q(!1)}finally{Ce(!1)}}},Oe=b.length>0?Math.round(Object.keys(S).length/b.length*100):0,N=h?{type:"enrolled",color:"bg-[#17BC91]",textColor:"text-[#17BC91]",bgColor:"bg-[#17BC91]/10",borderColor:"border-[#17BC91]/30",label:"Inscrito",description:`Clase programada para el ${new Date(h.scheduled_at).toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})}`}:f?{type:"requested",...{pending:{color:"bg-[#F98613]",textColor:"text-[#F98613]",bgColor:"bg-[#F98613]/10",borderColor:"border-[#F98613]/30",label:"Solicitud Pendiente",description:"Tu solicitud est√° siendo revisada por el equipo acad√©mico"},approved:{color:"bg-[#17BC91]",textColor:"text-[#17BC91]",bgColor:"bg-[#17BC91]/10",borderColor:"border-[#17BC91]/30",label:"Solicitud Aprobada",description:"Tu solicitud fue aprobada. Pronto te asignar√°n una clase"},scheduled:{color:"bg-[#17BC91]",textColor:"text-[#17BC91]",bgColor:"bg-[#17BC91]/10",borderColor:"border-[#17BC91]/30",label:"Clase Programada",description:f.scheduled_class?`Tu clase est√° programada para el ${new Date(f.scheduled_class.scheduled_at).toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})}${f.scheduled_class.teacher?` con ${f.scheduled_class.teacher.name}`:""}`:"Ya tienes una clase asignada"},rejected:{color:"bg-red-500",textColor:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Solicitud Rechazada",description:f.admin_response||"Tu solicitud no fue aprobada"}}[f.status]}:{type:"available",color:"bg-gray-400",textColor:"text-gray-700",bgColor:"bg-gray-50",borderColor:"border-gray-200",label:"Disponible",description:"Puedes solicitar esta clase"},se=ie,Ge=s=>{if(!s)return null;const a=s.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);if(a)return`https://www.youtube.com/embed/${a[1]}`;const r=s.match(/vimeo\.com\/(\d+)/);return r?`https://player.vimeo.com/video/${r[1]}`:s},Se=A&&h?.recording_url?h.recording_url:t.intro_video_url,ke=Se?Ge(Se):null,Qe=A&&!!h?.recording_url;return e.jsxs(Ze,{children:[e.jsx(We,{title:t.title}),e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs(Xe,{href:"/student/my-classes",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(ss,{className:"w-5 h-5"}),e.jsx("span",{children:"Volver a mis clases"})]})})}),e.jsx("div",{className:"bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"relative aspect-video bg-gray-900 rounded-2xl overflow-hidden shadow-lg",children:[ke?e.jsx("iframe",{src:ke,className:"absolute inset-0 w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):t.intro_video_thumbnail?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:t.intro_video_thumbnail,alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/90 flex items-center justify-center",children:e.jsx(te,{className:"w-10 h-10 text-gray-800 ml-1"})})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(as,{className:"w-16 h-16 mb-3 opacity-50"}),e.jsx("span",{className:"text-sm",children:"Video de introducci√≥n no disponible"})]}),Qe&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs($,{className:"bg-red-600 text-white border-0",children:[e.jsx(Fe,{className:"w-3 h-3 mr-1"}),"Grabaci√≥n de la clase"]})})]})}),e.jsxs("div",{className:"lg:col-span-2 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx($,{style:{backgroundColor:t.academic_level?.color||"#3B82F6"},className:"text-white border-0",children:t.academic_level?.name}),e.jsxs($,{variant:"outline",children:["Sesi√≥n ",t.session_number]}),t.modality&&e.jsx($,{variant:"outline",className:"capitalize",children:t.modality==="theoretical"?"Te√≥rico":"Pr√°ctico"})]}),e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-3",children:t.title}),t.description&&e.jsx("p",{className:"text-gray-600 mb-4 leading-relaxed",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-[#073372]/5 px-3 py-1.5 rounded-full",children:[e.jsx(pe,{className:"w-4 h-4 text-[#073372]"}),e.jsxs("span",{className:"text-[#073372] font-medium",children:[t.duration_minutes," min"]})]}),t.has_exam&&e.jsxs("div",{className:"flex items-center gap-2 bg-[#F98613]/10 px-3 py-1.5 rounded-full",children:[e.jsx(j,{className:"w-4 h-4 text-[#F98613]"}),e.jsxs("span",{className:"text-[#F98613] font-medium",children:[t.exam_questions_count," preguntas"]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-[#17BC91]/10 px-3 py-1.5 rounded-full",children:[e.jsx(O,{className:"w-4 h-4 text-[#17BC91]"}),e.jsxs("span",{className:"text-[#17BC91] font-medium",children:[t.resources.length," recursos"]})]})]}),e.jsxs("div",{className:`rounded-xl p-4 ${N.bgColor} border ${N.borderColor} mb-4`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${N.color}`}),e.jsx("span",{className:`font-semibold ${N.textColor}`,children:N.label})]}),e.jsx("p",{className:`text-sm ${N.textColor} opacity-80`,children:N.description})]}),e.jsxs("div",{className:"mt-auto",children:[N.type==="available"&&e.jsxs(o,{className:"w-full bg-[#073372] hover:bg-[#052555] text-white h-12 text-base",onClick:()=>I(!0),children:[e.jsx(gs,{className:"w-5 h-5 mr-2"}),"Solicitar esta Clase"]}),N.type==="enrolled"&&h?.meet_url&&!A&&e.jsx("a",{href:h.meet_url,target:"_blank",rel:"noopener noreferrer",className:"block w-full",children:e.jsxs(o,{className:"w-full bg-green-600 hover:bg-green-700 h-12 text-base",children:[e.jsx(te,{className:"w-5 h-5 mr-2"}),"Entrar a la clase"]})}),N.type==="requested"&&f?.status==="scheduled"&&f?.scheduled_class?.meet_url&&e.jsx("a",{href:f.scheduled_class.meet_url,target:"_blank",rel:"noopener noreferrer",className:"block w-full",children:e.jsxs(o,{className:"w-full bg-green-600 hover:bg-green-700 h-12 text-base",children:[e.jsx(te,{className:"w-5 h-5 mr-2"}),"Entrar a la clase"]})}),N.type==="requested"&&f?.status==="rejected"&&e.jsx(o,{variant:"outline",className:"w-full h-12 text-base",onClick:()=>I(!0),children:"Volver a solicitar"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[t.objectives&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#073372]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#073372] rounded-lg flex items-center justify-center",children:e.jsx(ts,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Objetivos de Aprendizaje"})]})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"rich-content text-gray-900 max-w-none whitespace-pre-line",children:t.objectives})})]}),t.content&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#17BC91]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#17BC91] rounded-lg flex items-center justify-center",children:e.jsx(rs,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contenido de la Clase"})]})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"rich-content max-w-none",dangerouslySetInnerHTML:{__html:t.content}})})]}),t.has_exam&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#F98613]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#F98613] rounded-lg flex items-center justify-center",children:e.jsx(j,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Examen de Evaluaci√≥n"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Eval√∫a tu comprensi√≥n del tema"})]})]}),se&&d?.exam_completed&&e.jsxs($,{className:"bg-emerald-500 text-white",children:[e.jsx(y,{className:"w-3.5 h-3.5 mr-1"}),"Completado"]})]})}),e.jsx("div",{className:"p-6",children:se?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-[#073372]/5 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#073372] rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(j,{className:"w-6 h-6 text-white"})}),e.jsx("p",{className:"text-2xl font-bold text-[#073372]",children:t.exam_questions_count}),e.jsx("p",{className:"text-xs text-gray-500",children:"Preguntas"})]}),e.jsxs("div",{className:"bg-[#17BC91]/5 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#17BC91] rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(be,{className:"w-6 h-6 text-white"})}),e.jsxs("p",{className:"text-2xl font-bold text-[#17BC91]",children:[t.exam_passing_score,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Para aprobar"})]}),e.jsxs("div",{className:"bg-[#F98613]/5 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#F98613] rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(pe,{className:"w-6 h-6 text-white"})}),e.jsxs("p",{className:"text-2xl font-bold text-[#F98613]",children:["~",Math.ceil(t.exam_questions_count*1.5)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Minutos aprox."})]})]}),d?.exam_completed?e.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-emerald-800",children:"¬°Examen aprobado!"}),e.jsxs("p",{className:"text-sm text-emerald-600",children:["Tu puntuaci√≥n: ",d.latest_exam_percentage??d.exam_score,"%",d.exam_attempts_count&&d.exam_attempts_count>1&&e.jsxs("span",{className:"text-emerald-500 ml-2",children:["(",d.exam_attempts_count," intentos)"]})]})]})]}),e.jsxs(o,{variant:"outline",className:"border-emerald-300 text-emerald-700 hover:bg-emerald-100",onClick:ue,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Ver examen"]})]})}):d?.exam_attempts_count&&d.exam_attempts_count>0?(()=>{const s=t.exam_max_attempts??3,a=d.exam_attempts_count,r=s-a,c=r<=0;return e.jsx("div",{className:`${c?"bg-red-50 border-red-200":"bg-amber-50 border-amber-200"} border rounded-xl p-4`,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 ${c?"bg-red-500":"bg-amber-500"} rounded-full flex items-center justify-center flex-shrink-0`,children:e.jsx(j,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-semibold ${c?"text-red-800":"text-amber-800"}`,children:c?"Sin intentos restantes":"Examen no aprobado a√∫n"}),e.jsxs("p",{className:`text-sm ${c?"text-red-600":"text-amber-600"}`,children:["√öltimo intento: ",d.latest_exam_percentage,"%",e.jsxs("span",{className:`ml-1 ${c?"text-red-500":"text-amber-500"}`,children:["(m√≠nimo: ",t.exam_passing_score,"%)"]})]}),e.jsxs("p",{className:`text-xs mt-1 ${c?"text-red-500":"text-amber-500"}`,children:[a," de ",s," intento",s!==1?"s":""," usado",a!==1?"s":"",!c&&e.jsxs("span",{className:"font-medium ml-1",children:["‚Ä¢ ",r," restante",r!==1?"s":""]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[e.jsxs(o,{variant:"outline",className:`${c?"border-red-300 text-red-700 hover:bg-red-100":"border-amber-300 text-amber-700 hover:bg-amber-100"}`,onClick:ue,children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Ver mi examen"]}),!c&&e.jsxs(o,{className:"bg-[#F98613] hover:bg-[#d96f0a] text-white",onClick:ee,children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Intentar de nuevo"]})]})]})})})():e.jsx("div",{className:"bg-gradient-to-r from-[#F98613]/10 to-[#F98613]/5 border border-[#F98613]/20 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"¬øListo para el examen?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pon a prueba lo que has aprendido"})]}),e.jsxs(o,{className:"bg-[#F98613] hover:bg-[#d96f0a] text-white",onClick:ee,children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Iniciar Examen"]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(je,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-1",children:"Examen bloqueado"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Inscr√≠bete en la clase para acceder al examen"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#17BC91]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#17BC91] rounded-lg flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recursos de la Clase"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.resources.length," materiales disponibles"]})]})]}),!se&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Bloqueado"})]})]})}),se?e.jsx("div",{className:"p-6",children:t.resources.length>0?e.jsx("div",{className:"space-y-3",children:t.resources.map(s=>{const a=()=>{switch(s.file_type){case"video":return e.jsx(Fe,{className:"w-5 h-5"});case"pdf":return e.jsx(O,{className:"w-5 h-5"});case"image":return e.jsx(ms,{className:"w-5 h-5"});case"link":return e.jsx(ds,{className:"w-5 h-5"});default:return e.jsx(O,{className:"w-5 h-5"})}},r=()=>{switch(s.file_type){case"video":return"bg-red-500";case"pdf":return"bg-red-600";case"image":return"bg-blue-500";case"link":return"bg-[#17BC91]";default:return"bg-gray-500"}};return e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl border border-gray-200 hover:border-[#17BC91]/50 hover:shadow-md transition-all duration-200 group cursor-pointer",children:[e.jsx("div",{className:`w-12 h-12 ${r()} rounded-xl flex items-center justify-center flex-shrink-0 text-white`,children:a()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 group-hover:text-[#073372] transition-colors",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 line-clamp-1",children:s.description}),e.jsx("p",{className:"text-xs text-gray-400 capitalize mt-1",children:s.file_type})]}),e.jsx(o,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity text-[#17BC91] hover:text-[#14a77f] hover:bg-[#17BC91]/10",children:s.file_type==="link"?e.jsxs(e.Fragment,{children:[e.jsx(ls,{className:"w-4 h-4 mr-1"}),"Abrir"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4 mr-1"}),"Descargar"]})})]},s.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(O,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500",children:"No hay recursos disponibles para esta clase"})]})}):e.jsxs("div",{className:"px-6 py-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(je,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-1",children:"Contenido bloqueado"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Solicita esta clase para acceder a los recursos"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(is,{className:"w-5 h-5 text-[#073372]"}),"Informaci√≥n de la Clase"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Nivel"}),e.jsx($,{style:{backgroundColor:t.academic_level?.color||"#3B82F6"},className:"text-white border-0",children:t.academic_level?.name})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Sesi√≥n"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.session_number})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Modalidad"}),e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:t.modality==="theoretical"?"Te√≥rico":t.modality==="practical"?"Pr√°ctico":"-"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Duraci√≥n"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[t.duration_minutes," min"]})]}),t.has_exam&&e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Examen"}),e.jsxs($,{className:"bg-[#F98613] text-white border-0",children:[t.exam_questions_count," preguntas"]})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Recursos"}),e.jsx("span",{className:"font-medium text-gray-900",children:t.resources.length})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#073372]/5 via-white to-[#17BC91]/5 rounded-xl border border-[#073372]/10 p-6",children:[e.jsx("h3",{className:"font-semibold text-[#073372] mb-3 flex items-center gap-2",children:"üí° Consejos para la clase"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"Revisa los objetivos antes de la clase"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"Prepara vocabulario relacionado al tema"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"No tengas miedo de cometer errores"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"Participa activamente en las discusiones"})]})]})]}),ie&&h?.teacher&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(re,{className:"w-5 h-5 text-[#073372]"}),"Tu Instructor"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#073372] to-[#17BC91] flex items-center justify-center text-white font-bold",children:h.teacher.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:h.teacher.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Instructor"})]})]})]}),ie&&h&&e.jsxs("div",{className:"bg-gradient-to-br from-[#17BC91]/10 to-[#17BC91]/5 rounded-xl border border-[#17BC91]/20 p-6",children:[e.jsxs("h3",{className:"font-semibold text-[#17BC91] mb-3 flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5"}),A?"Clase Completada":"Clase Programada"]}),e.jsx("p",{className:"text-gray-800 font-medium",children:new Date(h.scheduled_at).toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}),h.meet_url&&!A&&e.jsx("a",{href:h.meet_url,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-block",children:e.jsxs(o,{size:"sm",className:"bg-[#17BC91] hover:bg-[#14a77f] text-white",children:[e.jsx(te,{className:"w-4 h-4 mr-1"}),"Entrar a clase"]})})]})]})]})})]}),e.jsx("style",{children:`
        .rich-content h1 { 
          font-size: 1.75rem; 
          font-weight: 700; 
          margin: 1.5rem 0 0.75rem; 
          line-height: 1.2;
          color: #111827;
        }
        .rich-content h2 { 
          font-size: 1.375rem; 
          font-weight: 600; 
          margin: 1.25rem 0 0.5rem; 
          line-height: 1.3;
          color: #1f2937;
        }
        .rich-content h3 { 
          font-size: 1.125rem; 
          font-weight: 600; 
          margin: 1rem 0 0.5rem;
          color: #374151;
        }
        .rich-content p {
          margin: 0.5rem 0;
          line-height: 1.6;
          color: #374151;
        }
        .rich-content ul, .rich-content ol { 
          padding-left: 1.5rem; 
          margin: 0.75rem 0; 
        }
        .rich-content li { 
          margin: 0.25rem 0;
          line-height: 1.6;
        }
        .rich-content ul { list-style-type: disc; }
        .rich-content ol { list-style-type: decimal; }
        .rich-content blockquote { 
          border-left: 4px solid #e5e7eb; 
          padding-left: 1rem; 
          margin: 1rem 0;
          color: #6b7280;
          font-style: italic;
        }
        .rich-content pre {
          background: #1f2937;
          color: #e5e7eb;
          padding: 1rem;
          border-radius: 0.5rem;
          font-family: 'Fira Code', 'Monaco', monospace;
          overflow-x: auto;
          margin: 1rem 0;
        }
        .rich-content code {
          background: #f3f4f6;
          padding: 0.125rem 0.25rem;
          border-radius: 0.25rem;
          font-family: 'Fira Code', 'Monaco', monospace;
          font-size: 0.875em;
        }
        .rich-content pre code {
          background: none;
          padding: 0;
          color: inherit;
        }
        .rich-content img {
          max-width: 100%;
          height: auto;
          border-radius: 0.5rem;
          margin: 1rem 0;
        }
        .rich-content a {
          color: #073372;
          text-decoration: underline;
          cursor: pointer;
        }
        .rich-content a:hover {
          color: #17BC91;
        }
        .rich-content hr {
          border: none;
          border-top: 2px solid #e5e7eb;
          margin: 1.5rem 0;
        }
        .rich-content strong {
          font-weight: 600;
        }
        .rich-content em {
          font-style: italic;
        }
        .rich-content u {
          text-decoration: underline;
        }
        /* Text alignment */
        .rich-content [style*="text-align: center"] {
          text-align: center;
        }
        .rich-content [style*="text-align: right"] {
          text-align: right;
        }
        .rich-content [style*="text-align: left"] {
          text-align: left;
        }
      `}),z&&e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>!M&&I(!1),children:e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] px-6 py-5 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(Ee,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Solicitar Clase"}),e.jsx("p",{className:"text-blue-100 text-sm",children:t.title})]})]})}),e.jsx("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:B?e.jsxs(e.Fragment,{children:[R&&e.jsxs("div",{className:"bg-[#073372]/5 border border-[#073372]/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#073372] mb-2",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Tu pr√≥ximo horario disponible"})]}),e.jsx("p",{className:"text-[#073372] font-medium capitalize",children:Ve(R)}),e.jsxs("p",{className:"text-sm text-[#073372]/70 mt-1",children:["Las clases deben solicitarse con al menos ",C?.min_advance_hours||1," hora(s) de anticipaci√≥n"]})]}),oe?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-3 border-[#073372]/30 border-t-[#073372] rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Buscando clases disponibles..."})]}):_.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-700 font-medium flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-[#17BC91]"}),"Grupos disponibles para este horario:"]}),_.map(s=>e.jsxs("div",{onClick:()=>g(s.id===m?null:s.id),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${m===s.id?"border-[#17BC91] bg-[#17BC91]/5":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${m===s.id?"bg-[#17BC91] text-white":"bg-gray-100 text-gray-600"}`,children:e.jsx(ns,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.teacher?.name||"Instructor por asignar"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.scheduled_at).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${s.available_spots<=2?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[s.enrolled_count,"/",s.max_students," aprendices"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.available_spots," cupo",s.available_spots!==1?"s":""," disponible",s.available_spots!==1?"s":""]})]})]}),m===s.id&&e.jsx("div",{className:"mt-3 pt-3 border-t border-[#17BC91]/20",children:e.jsxs("p",{className:"text-sm text-[#17BC91] flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),"Solicitar unirse a este grupo"]})})]},s.id)),e.jsx("div",{className:_.some(s=>s.available_spots>0)?"hidden":"pt-2 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>g(null),className:`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-3 ${m===null?"border-[#073372] bg-[#073372]/5":"border-dashed border-gray-300 hover:border-gray-400"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${m===null?"bg-[#073372] text-white":"bg-gray-100 text-gray-600"}`,children:e.jsx(cs,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Solicitar nueva clase"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Se crear√° un nuevo grupo para este horario"})]})]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(k,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-700 font-medium",children:"No hay grupos disponibles"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Se solicitar√° crear una nueva clase para este horario"})]}),e.jsx(ae,{label:"Mensaje (opcional)",value:H,onChange:s=>P(s.target.value),placeholder:"¬øTienes alg√∫n comentario adicional?",rows:2})]}):F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-[#17BC91]/5 border border-[#17BC91]/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#17BC91] mb-2",children:[e.jsx(pe,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Plan Diario"})]}),e.jsx("p",{className:"text-sm text-[#17BC91]/80",children:"Puedes elegir cualquier hora disponible para hoy. La clase debe ser al menos 30 minutos en el futuro."})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-gray-700 mb-3",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Selecciona la hora de tu clase (hoy)"})]}),e.jsxs("select",{value:p,onChange:s=>V(s.target.value),className:"w-full h-14 px-4 bg-white border-2 border-gray-200 rounded-lg text-gray-900 text-base focus:outline-none focus:border-[#17BC91] focus:ring-2 focus:ring-[#17BC91]/20 transition-all",children:[e.jsx("option",{value:"",children:"Selecciona una hora..."}),(()=>{const s=new Date,a=C?.operation_start_hour||8,r=C?.operation_end_hour||22,c=[];for(let u=a;u<r;u++){const x=new Date(s);if(x.setHours(u,0,0,0),x.getTime()>s.getTime()+1800*1e3){const ge=U(x);c.push(e.jsxs("option",{value:ge,children:[u.toString().padStart(2,"0"),":00"]},u))}}return c})()]})]}),p&&e.jsx(e.Fragment,{children:oe?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-[#17BC91]/30 border-t-[#17BC91] rounded-full animate-spin"}),e.jsx("span",{className:"ml-2 text-gray-600 text-sm",children:"Buscando grupos..."})]}):_.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-700 font-medium text-sm flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-[#17BC91]"}),"Grupos disponibles:"]}),_.map(s=>e.jsx("div",{onClick:()=>g(s.id===m?null:s.id),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${m===s.id?"border-[#17BC91] bg-[#17BC91]/5":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.teacher?.name||"Por asignar"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.available_spots," cupos"]})]})},s.id)),e.jsx("button",{onClick:()=>g(null),className:`w-full p-3 rounded-lg border-2 border-dashed transition-all ${m===null?"border-[#073372] bg-[#073372]/5":"border-gray-300"}`,children:e.jsx("span",{className:"text-sm text-gray-700",children:"+ Solicitar nueva clase"})})]}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No hay grupos. Se crear√° una nueva clase."})}),e.jsx(ae,{label:"Mensaje (opcional)",value:H,onChange:s=>P(s.target.value),placeholder:"¬øTienes alg√∫n comentario adicional?",rows:2})]}):E?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-700 mb-2",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Plan Semanal"})]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Puedes elegir cualquier hora y d√≠a dentro de los pr√≥ximos 7 d√≠as."})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-gray-700 mb-3",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Selecciona fecha y hora"})]}),e.jsx("input",{type:"datetime-local",value:p,onChange:s=>V(s.target.value),min:(()=>{const s=new Date;return s.setMinutes(s.getMinutes()+30),U(s).slice(0,16)})(),max:(()=>{const s=new Date;return s.setDate(s.getDate()+7),U(s).slice(0,16)})(),className:"w-full h-14 px-4 bg-white border-2 border-gray-200 rounded-lg text-gray-900 text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all",style:{colorScheme:"light"}}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Horarios disponibles: ",C?.operation_start_hour||8,":00 - ",C?.operation_end_hour||22,":00"]})]}),p&&e.jsx(e.Fragment,{children:oe?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-purple-300 border-t-purple-600 rounded-full animate-spin"}),e.jsx("span",{className:"ml-2 text-gray-600 text-sm",children:"Buscando grupos..."})]}):_.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-700 font-medium text-sm flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4 text-purple-600"}),"Grupos disponibles para este horario:"]}),_.map(s=>e.jsx("div",{onClick:()=>g(s.id===m?null:s.id),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${m===s.id?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.teacher?.name||"Por asignar"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.scheduled_at).toLocaleString("es-PE",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.available_spots," cupos"]})]})},s.id)),e.jsx("button",{onClick:()=>g(null),className:`w-full p-3 rounded-lg border-2 border-dashed transition-all ${m===null?"border-purple-500 bg-purple-50":"border-gray-300"}`,children:e.jsx("span",{className:"text-sm text-gray-700",children:"+ Solicitar nueva clase"})})]}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No hay grupos para este horario. Se crear√° una nueva clase."})}),e.jsx(ae,{label:"Mensaje (opcional)",value:H,onChange:s=>P(s.target.value),placeholder:"¬øTienes alg√∫n comentario adicional?",rows:2})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600",children:"¬øDeseas solicitar esta clase? Nuestro equipo acad√©mico revisar√° tu solicitud y te programar√° una sesi√≥n."}),e.jsxs("div",{className:"bg-[#F98613]/5 border border-[#F98613]/30 rounded-xl p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-[#F98613] mb-3",children:[e.jsx(k,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"¬øCu√°ndo te gustar√≠a tomar la clase?"})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"datetime-local",value:p,onChange:s=>V(s.target.value),className:"w-full h-14 px-4 bg-white border-2 border-[#F98613]/40 rounded-lg text-gray-900 text-base cursor-pointer focus:outline-none focus:border-[#F98613] focus:ring-2 focus:ring-[#F98613]/20 hover:border-[#F98613]/60 transition-all duration-200",style:{colorScheme:"light"}})}),e.jsx("p",{className:"text-xs text-[#F98613]/80 mt-2",children:"Haz clic en el campo para seleccionar fecha y hora. El equipo acad√©mico lo revisar√° y confirmar√°."})]}),e.jsx(ae,{label:"Mensaje adicional (opcional)",value:H,onChange:s=>P(s.target.value),placeholder:"¬øAlg√∫n comentario o preferencia adicional?",rows:2})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3 border-t",children:[e.jsx(o,{variant:"outline",onClick:()=>{I(!1),g(null),P(""),V("")},disabled:M,children:"Cancelar"}),e.jsx(o,{onClick:()=>he(),disabled:M||B&&!R||(F||E)&&!p,className:"bg-[#073372] hover:bg-[#052555]",children:M?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),m?"Solicitar Unirme":"Enviar Solicitud"]})})]})]})}),Me&&ce.length>0&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"px-6 py-4 bg-gradient-to-r from-amber-500 to-orange-500 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3 text-white",children:[e.jsx($e,{className:"w-6 h-6"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"No hay profesores disponibles"}),e.jsx("p",{className:"text-sm text-white/80",children:"Te mostramos horarios alternativos"})]})]}),e.jsx("button",{onClick:()=>{W(!1),Y([])},className:"text-white/80 hover:text-white transition-colors",children:e.jsx(fe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"No encontramos un profesor disponible en el horario que seleccionaste. Aqu√≠ tienes algunos horarios alternativos con profesores disponibles:"}),e.jsx("div",{className:"space-y-3 max-h-[400px] overflow-y-auto",children:ce.map((s,a)=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl border border-gray-200 hover:border-[#17BC91] hover:bg-[#17BC91]/5 transition-all cursor-pointer group",onClick:()=>he(s.datetime),children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-[#17BC91]/10 flex items-center justify-center",children:e.jsx(k,{className:"w-5 h-5 text-[#17BC91]"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-gray-900 capitalize",children:[s.day_name,", ",new Date(s.datetime).toLocaleDateString("es-PE",{day:"numeric",month:"long"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.time," hrs ‚Ä¢ Profesor: ",e.jsx("span",{className:"text-[#17BC91] font-medium",children:s.teacher_name})]})]})]}),e.jsx(o,{size:"sm",className:"bg-[#17BC91] hover:bg-[#14a57f] text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:r=>{r.stopPropagation(),he(s.datetime)},disabled:M,children:M?e.jsx(le,{className:"w-4 h-4 animate-spin"}):"Seleccionar"})]},a))}),ce.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx($e,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),e.jsx("p",{children:"No hay horarios alternativos disponibles en este momento."}),e.jsx("p",{className:"text-sm mt-1",children:"Por favor, intenta m√°s tarde."})]})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-100 flex justify-end",children:e.jsx(o,{variant:"outline",onClick:()=>{W(!1),Y([])},children:"Cerrar"})})]})}),Le&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between ${i?i.passed?"bg-gradient-to-r from-[#17BC91] to-[#14a57f]":"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-[#F98613] to-[#d96f0a]"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:i?i.passed?e.jsx(be,{className:"w-5 h-5 text-white"}):e.jsx(j,{className:"w-5 h-5 text-white"}):e.jsx(j,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:i?i.passed?"¬°Aprobado!":"No aprobado":"Evaluaci√≥n"}),e.jsx("p",{className:"text-white/80 text-sm",children:t.title})]})]}),e.jsx("button",{onClick:i?_e:()=>D(!1),className:"w-8 h-8 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center transition",children:e.jsx(fe,{className:"w-5 h-5 text-white"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:ze?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(le,{className:"w-12 h-12 text-[#F98613] animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando preguntas del examen..."})]}):i?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 ${i.passed?"bg-[#17BC91]/10":"bg-red-50"}`,children:i.passed?e.jsx(be,{className:"w-12 h-12 text-[#17BC91]"}):e.jsx(j,{className:"w-12 h-12 text-red-500"})}),e.jsx("h3",{className:`text-2xl font-bold mb-2 ${i.passed?"text-[#17BC91]":"text-red-600"}`,children:i.passed?"¬°Felicitaciones!":"Sigue intentando"}),e.jsx("p",{className:"text-gray-600 mb-6",children:i.passed?"Has aprobado la evaluaci√≥n exitosamente.":"No alcanzaste el puntaje m√≠nimo para aprobar."}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 mb-6 max-w-sm mx-auto",children:[e.jsxs("div",{className:"text-5xl font-bold mb-2",style:{color:i.passed?"#17BC91":"#ef4444"},children:[i.percentage,"%"]}),e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:[i.score," de ",i.total_points," puntos"]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[i.passing_score,"%"]}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Puntaje m√≠nimo"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-200"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[i.attempts," / ",t.exam_max_attempts??3]}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Intentos usados"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[!i.passed&&i.attempts<(t.exam_max_attempts??3)&&e.jsxs(o,{onClick:ee,className:"bg-[#F98613] hover:bg-[#d96f0a]",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Intentar de nuevo"]}),!i.passed&&e.jsxs(o,{variant:"outline",onClick:()=>{D(!1),K(null),ue()},children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Ver mi examen"]}),e.jsxs(o,{variant:i.passed?"default":"outline",onClick:_e,className:i.passed?"bg-[#17BC91] hover:bg-[#14a57f]":"",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),i.passed?"Continuar":"Cerrar"]})]})]}):b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No hay preguntas disponibles para este examen."}),e.jsx(o,{variant:"outline",onClick:()=>D(!1),className:"mt-4",children:"Cerrar"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Pregunta ",v+1," de ",b.length]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Object.keys(S).length," de ",b.length," respondidas"]})]}),e.jsx(es,{value:Oe,className:"h-2"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-6",children:b[v].question}),e.jsx("div",{className:"space-y-2",children:b[v].options.map((s,a)=>e.jsxs("div",{onClick:()=>qe(v,s.text),className:`flex items-center space-x-3 p-4 rounded-lg cursor-pointer transition-all ${S[v]===s.text?"bg-[#F98613]/10 border-2 border-[#F98613]":"bg-white border-2 border-gray-200 hover:border-[#F98613]/50 hover:bg-[#F98613]/5"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${S[v]===s.text?"border-[#F98613] bg-[#F98613]":"border-gray-300"}`,children:S[v]===s.text&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsx("span",{className:"flex-1 text-gray-700",children:s.text})]},a))})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-6",children:b.map((s,a)=>e.jsx("button",{onClick:()=>J(a),className:`w-10 h-10 rounded-lg text-sm font-medium transition ${a===v?"bg-[#F98613] text-white shadow-lg":S[a]?"bg-[#17BC91] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:a+1},a))}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs(o,{variant:"outline",onClick:()=>J(s=>Math.max(0,s-1)),disabled:v===0,children:[e.jsx(hs,{className:"w-4 h-4 mr-1"}),"Anterior"]}),v===b.length-1?e.jsx(o,{onClick:Ue,disabled:Object.keys(S).length<b.length||we,className:"bg-[#17BC91] hover:bg-[#14a57f]",children:we?e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4 mr-2 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Enviar Examen"]})}):e.jsxs(o,{onClick:()=>J(s=>Math.min(b.length-1,s+1)),className:"bg-[#073372] hover:bg-[#052555]",children:["Siguiente",e.jsx(os,{className:"w-4 h-4 ml-1"})]})]})]})})]})}),Ie&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between ${n?.attempt.passed?"bg-gradient-to-r from-[#17BC91] to-[#14a57f]":n?.attempts_exhausted?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-amber-500 to-amber-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(G,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Revisi√≥n del Examen"}),e.jsx("p",{className:"text-white/80 text-sm",children:t.title})]})]}),e.jsx("button",{onClick:()=>q(!1),className:"w-8 h-8 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center transition",children:e.jsx(fe,{className:"w-5 h-5 text-white"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:He?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(le,{className:"w-12 h-12 text-[#F98613] animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando resultados del examen..."})]}):n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`rounded-xl p-4 ${n.attempt.passed?"bg-emerald-50 border border-emerald-200":n.attempts_exhausted?"bg-red-50 border border-red-200":"bg-amber-50 border border-amber-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`text-4xl font-bold ${n.attempt.passed?"text-emerald-600":n.attempts_exhausted?"text-red-600":"text-amber-600"}`,children:[n.attempt.percentage,"%"]}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${n.attempt.passed?"text-emerald-800":n.attempts_exhausted?"text-red-800":"text-amber-800"}`,children:n.attempt.passed?"¬°Aprobado!":n.attempts_exhausted?"No aprobado":"En progreso"}),e.jsxs("p",{className:`text-sm ${n.attempt.passed?"text-emerald-600":n.attempts_exhausted?"text-red-600":"text-amber-600"}`,children:[n.attempt.score," de ",n.attempt.total_points," puntos"]})]})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:["Intentos: ",n.attempts_used,"/",n.max_attempts]}),e.jsxs("p",{className:"text-gray-500",children:["M√≠nimo para aprobar: ",n.passing_score,"%"]})]})]})}),!n.show_correct_answers&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(G,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Modo de revisi√≥n limitado"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Puedes ver si tus respuestas fueron correctas o incorrectas. Las respuestas correctas se mostrar√°n cuando agotes tus intentos o apruebes el examen."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Detalle de respuestas"}),n.questions.map((s,a)=>e.jsx("div",{className:`rounded-xl border-2 p-4 ${s.is_correct?"border-emerald-200 bg-emerald-50/50":"border-red-200 bg-red-50/50"}`,children:e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${s.is_correct?"bg-emerald-500":"bg-red-500"}`,children:s.is_correct?e.jsx(y,{className:"w-5 h-5 text-white"}):e.jsx(Ke,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900 mb-2",children:[a+1,". ",s.question]}),e.jsxs("div",{className:`rounded-lg p-3 mb-2 ${s.is_correct?"bg-emerald-100 border border-emerald-300":"bg-red-100 border border-red-300"}`,children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Tu respuesta:"}),e.jsx("p",{className:`${s.is_correct?"text-emerald-800":"text-red-800"}`,children:s.student_answer||e.jsx("span",{className:"italic text-gray-400",children:"Sin respuesta"})})]}),n.show_correct_answers&&s.correct_answer&&!s.is_correct&&e.jsxs("div",{className:"rounded-lg p-3 bg-emerald-100 border border-emerald-300",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Respuesta correcta:"}),e.jsx("p",{className:"text-emerald-800",children:s.correct_answer})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[s.points_earned," / ",s.points_possible," punto",s.points_possible!==1?"s":""]})]})]})},a))]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center pt-4 border-t",children:[!n.attempt.passed&&!n.attempts_exhausted&&e.jsxs(o,{onClick:()=>{q(!1),ee()},className:"bg-[#F98613] hover:bg-[#d96f0a]",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Intentar de nuevo"]}),e.jsx(o,{variant:"outline",onClick:()=>q(!1),children:"Cerrar"})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No se pudieron cargar los resultados."})]})})]})})]})};export{ea as default};
