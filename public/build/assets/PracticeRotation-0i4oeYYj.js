import{r as j,j as e,H,a as M}from"./app-CQeM4NTb.js";import{A as G}from"./AuthenticatedLayout-OG1PzA-V.js";import{e as U,f as k,g as V,h as q,i as Y,j as J}from"./index-BgTr9QC4.js";import{B as C}from"./button-BKXWnkj-.js";import{S as K,a as Q,b as W,c as X,d as Z}from"./select-CFQy8Sok.js";import{n as ee,c as B,b as se,e as te,t as y,d as D}from"./DocumentConfirmationModal-CydVsQCm.js";import{i as ae,s as E,a as re,b as ne}from"./subMonths-CFEPo_nA.js";import{f as o,p as S}from"./parseISO-BFv_fMw0.js";/* empty css            */import"./clsx-B-dksMZM.js";import"./index-C4O0F4F3.js";import"./index-It-Ttbr5.js";import"./dropdown-menu-Op_UaWhc.js";import"./createLucideIcon-tB2FwKGp.js";import"./index-D6_jR_BQ.js";import"./index-CAsqRJnA.js";import"./index-DZ3cRJY4.js";import"./chevron-down-DQGWHuCn.js";import"./check-BnE8Ldxl.js";import"./chevron-up-CoZjgXeS.js";import"./badge-CKsZe3hD.js";import"./x-BdSfRFNn.js";import"./triangle-alert-DNn7VdNb.js";import"./circle-check-big-DrsNThf7.js";import"./clock-CVkQKfJ0.js";function ie(r,d){const[t,i]=ee(r,d.start,d.end);return{start:t,end:i}}function le(r,d){const{start:t,end:i}=ie(d?.in,r);let u=+t>+i;const N=u?+t:+i,m=u?i:t;m.setHours(0,0,0,0);let v=1;const g=[];for(;+m<=N;)g.push(B(t,m)),m.setDate(m.getDate()+v),m.setHours(0,0,0,0);return u?g.reverse():g}function ce(r,d){return ae(B(r,r),se(r))}const Ae=({auth:r,teachers:d})=>{const[t,i]=j.useState(new Date),[u,N]=j.useState([]),[m,v]=j.useState(!1),[g,F]=j.useState(!1),w=r.user.role==="admin",R=async()=>{v(!0);try{const x=(await M.get("/api/admin/practice-rotations",{params:{month:t.getMonth()+1,year:t.getFullYear()}})).data.map(s=>({...s,date:o(S(s.date),"yyyy-MM-dd")}));N(x)}catch{y.error("Error al cargar el cronograma")}finally{v(!1)}};j.useEffect(()=>{R()},[t]);const I=()=>i(re(t,1)),A=()=>i(ne(t,1)),z=()=>i(new Date),L=async(n,x)=>{try{const s=await M.post("/api/admin/practice-rotations",{date:n,teacher_id:x}),l={...s.data.rotation,date:o(S(s.data.rotation.date),"yyyy-MM-dd")};N(h=>{const a=h.findIndex(p=>p.date===n);if(a!==-1){const p=[...h];return p[a]=l,p}return[...h,l]}),y.success(`Turno asignado para el ${o(S(n),"dd/MM/yyyy")}`)}catch{y.error("Error al guardar el turno")}},_=async()=>{F(!0);try{await M.post("/api/admin/practice-rotations/generate",{start_date:o(E(t),"yyyy-MM-dd"),days:31}),y.success("Cronograma generado automáticamente para este mes"),R()}catch{y.error("Error al generar el cronograma")}finally{F(!1)}},$=E(t),P=te(t),T=le({start:$,end:P});return e.jsxs(G,{children:[e.jsx(H,{title:"Cronograma de Prácticas"}),e.jsx("div",{className:"py-6 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-xl flex items-center justify-center shadow-lg shadow-[#073372]/20",children:e.jsx(U,{className:"text-white text-2xl"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 leading-none mb-1",children:"Cronograma de Prácticas"}),e.jsx("p",{className:"text-sm text-gray-500 font-medium font-outfit uppercase tracking-wider",children:"Asignación diaria de instructores"})]})]}),w&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(C,{variant:"outline",onClick:_,disabled:g,className:"border-[#073372] text-[#073372] hover:bg-[#073372]/5 font-semibold",children:[g?e.jsx(k,{className:"animate-spin mr-2"}):e.jsx(k,{className:"mr-2"}),"Generar Rotación Automática"]})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{variant:"ghost",size:"icon",onClick:I,className:"rounded-full hover:bg-gray-100",children:e.jsx(V,{className:"text-2xl"})}),e.jsxs("div",{className:"text-center min-w-[200px]",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 capitalize leading-none mb-1",children:o(t,"MMMM yyyy",{locale:D})}),e.jsx("button",{onClick:z,className:"text-xs font-semibold text-[#17BC91] hover:underline",children:"Ir a hoy"})]}),e.jsx(C,{variant:"ghost",size:"icon",onClick:A,className:"rounded-full hover:bg-gray-100",children:e.jsx(q,{className:"text-2xl"})})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-6 text-sm",children:w?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#17BC91]"}),e.jsx("span",{className:"text-gray-600",children:"Asignado"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-400"}),e.jsx("span",{className:"text-gray-600",children:"Sin asignar"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-[#F98613]"}),e.jsx("span",{className:"text-gray-600 font-medium",children:"Mis días"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-gray-500",children:"Otros instructores"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-amber-400"}),e.jsx("span",{className:"text-gray-600",children:"Pendiente de asignar"})]})]})})]})}),e.jsxs("div",{className:"bg-blue-50/50 border border-blue-100 rounded-xl p-4 mb-6 flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Y,{className:"text-blue-600 text-lg"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-800 font-medium",children:"Información de Rotación"}),e.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:"El instructor seleccionado para un día específico se dedicará exclusivamente a gestionar las sesiones de práctica. El sistema asignará automáticamente cualquier solicitud de práctica a este instructor."})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:T.map(n=>{const x=o(n,"yyyy-MM-dd"),s=u.find(c=>c.date===x),l=ce(n),h=r.user.role==="teacher",a=h&&s?.teacher_id===r.user.id,p=h&&s&&s.teacher_id!==r.user.id,O=!s;let b="relative bg-white rounded-2xl border transition-all duration-300 overflow-hidden ",f="px-4 py-3 flex items-center justify-between ";return l?(b+="border-[#073372] ring-1 ring-[#073372] shadow-md ",f+="bg-[#073372]/5 "):a?(b+="border-[#F98613] ring-1 ring-[#F98613]/50 shadow-lg shadow-[#F98613]/10 scale-[1.02] z-10 ",f+="bg-[#F98613]/10 "):h&&(p||O)?(b+="border-gray-100 opacity-60 grayscale-[0.5] ",f+="bg-gray-50/50 "):(b+="border-gray-100 hover:border-gray-200 hover:shadow-sm ",f+="bg-gray-50/50 "),e.jsxs("div",{className:b,children:[e.jsxs("div",{className:f,children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-xs font-bold uppercase tracking-wider ${l?"text-[#073372]":a?"text-[#F98613]":"text-gray-400"}`,children:o(n,"EEEE",{locale:D})}),e.jsx("h4",{className:`text-lg font-bold leading-none mt-0.5 ${l?"text-[#073372]":a?"text-[#F98613]":"text-gray-900"}`,children:o(n,"d")})]}),s&&e.jsx("div",{className:`w-6 h-6 rounded-full flex items-center justify-center border ${a?"bg-[#F98613]/20 border-[#F98613]/30":"bg-[#17BC91]/10 border-[#17BC91]/20"}`,children:e.jsx(J,{className:a?"text-[#F98613]":"text-[#17BC91]"})})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-semibold text-gray-400 uppercase tracking-widest mb-1 block",children:"Instructor de Práctica"}),w?e.jsxs(K,{value:s?.teacher_id?.toString()||"",onValueChange:c=>L(x,parseInt(c)),children:[e.jsx(Q,{className:`h-10 text-xs ${s?"border-gray-100 bg-white":"border-amber-200 bg-amber-50/30"}`,children:e.jsx(W,{placeholder:"Seleccionar..."})}),e.jsx(X,{children:d.map(c=>e.jsx(Z,{value:c.id.toString(),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-[#073372] flex items-center justify-center text-[8px] text-white",children:c.name.charAt(0)}),e.jsx("span",{children:c.name})]})},c.id))})]}):e.jsx("div",{className:`h-10 flex items-center px-3 rounded-md border text-xs font-semibold ${a?"bg-[#F98613]/5 border-[#F98613]/20 text-[#F98613]":s?"bg-gray-50 border-gray-100 text-gray-700":"bg-amber-50 border-amber-100 text-amber-600 italic"}`,children:s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center text-[8px] text-white uppercase ${a?"bg-[#F98613]":"bg-[#073372]"}`,children:s.teacher?.name.charAt(0)}),e.jsx("span",{className:"truncate",children:s.teacher?.name}),a&&e.jsx("span",{className:"ml-1 text-[10px] font-black",children:"(TÚ)"})]}):"Sin asignar"})]}),s?e.jsx("div",{className:"flex items-center gap-2 pt-1",children:e.jsx("div",{className:`px-2 py-0.5 rounded-full border ${a?"bg-[#F98613]/10 border-[#F98613]/20":"bg-[#17BC91]/10 border-[#17BC91]/20"}`,children:e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-tighter ${a?"text-[#F98613]":"text-[#17BC91]"}`,children:a?"Tu Turno":"Confirmado"})})}):e.jsx("div",{className:"flex items-center gap-2 pt-1",children:e.jsx("div",{className:"px-2 py-0.5 rounded-full bg-amber-100 border border-amber-200",children:e.jsx("span",{className:"text-[10px] font-bold text-amber-600 uppercase tracking-tighter",children:"Pendiente"})})})]})}),l&&e.jsx("div",{className:"absolute top-0 right-0 z-20",children:e.jsx("div",{className:"bg-[#073372] text-white text-[9px] font-bold px-3 py-1 rounded-bl-xl uppercase tracking-widest shadow-sm",children:"Hoy"})}),a&&!l&&e.jsx("div",{className:"absolute top-0 right-0 z-20",children:e.jsx("div",{className:"bg-[#F98613] text-white text-[9px] font-bold px-3 py-1 rounded-bl-xl uppercase tracking-widest shadow-sm",children:"Mi Día"})})]},x)})})]})})]})};export{Ae as default};
