import{r as d,j as e,H as ae,a as T}from"./app-BHPs7N3P.js";import{A as te,t as l}from"./AuthenticatedLayout-DvSiEFKj.js";import{I as re}from"./input-DxJE_uoa.js";import{e as ie,d as le,a as oe}from"./dialog-C8kcQMKF.js";import{B as o}from"./button-06jbzzbJ.js";import{C as A,c as M,d as D,a as B}from"./card-CVhVcmnC.js";import{S as ne}from"./switch-BIMwTa9r.js";import{C as E}from"./calendar-dHjrC_IN.js";import{S as de}from"./save-Cjy-Nyfn.js";import{L as H}from"./link-2-CrWOslH-.js";import{C as ce}from"./copy-BzOFdpR_.js";import{C as me}from"./circle-alert-CsafnAHX.js";import{C as I}from"./circle-check-big--ehG1MeI.js";import{C as L}from"./clock-CruE9NGa.js";import{P as O}from"./plus-kpyiJNIV.js";import{X as xe}from"./x-DoGSKmO9.js";import{T as ge}from"./trash-2-DM5DWV_j.js";/* empty css            */import"./dropdown-menu-Cqk0GMeM.js";import"./createLucideIcon-BEwjrUWg.js";import"./index-cA7h04hZ.js";import"./index-DGZ9o9tf.js";import"./index-pum1ZMD1.js";import"./badge-7IgZiIUm.js";import"./triangle-alert-BgKoL3ck.js";import"./index-B1l7BLxl.js";import"./clsx-B-dksMZM.js";import"./index-D-I4WZeI.js";const w=["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado","Domingo"],Je=({teacher:j})=>{const[p,he]=d.useState(j.meet_url||""),[c,z]=d.useState(j.not_available_today),[n,u]=d.useState((j.time_slots||[]).map(s=>({...s,start_time:s.start_time.substring(0,5),end_time:s.end_time.substring(0,5)}))),[v,k]=d.useState(!1),[R,C]=d.useState(!1),[V,b]=d.useState(!1),[i,x]=d.useState([]),[m,g]=d.useState([{start:"09:00",end:"12:00"}]),P=s=>{u([...n,{day_of_week:s,start_time:"09:00",end_time:"12:00"}])},$=s=>{u(n.filter((a,t)=>t!==s))},S=(s,a,t)=>{const r=[...n];r[s]={...r[s],[a]:t},u(r)},J=()=>{g([...m,{start:"14:00",end:"17:00"}])},F=s=>{m.length>1&&g(m.filter((a,t)=>t!==s))},_=(s,a,t)=>{const r=[...m];r[s]={...r[s],[a]:t},g(r)},G=()=>{if(i.length===0){l.error("Selecciona al menos un dÃ­a");return}const s=[];i.forEach(a=>{m.forEach(t=>{s.push({day_of_week:a,start_time:t.start,end_time:t.end})})}),u([...n,...s]),b(!1),x([]),g([{start:"09:00",end:"12:00"}]),l.success(`Se agregaron ${s.length} horarios`)},U=s=>{i.includes(s)?x(i.filter(a=>a!==s)):x([...i,s])},q=()=>{p&&(navigator.clipboard.writeText(p),l.success("Link copiado al portapapeles"))},f=s=>{let a=[];switch(s){case"morning":a=[{start:"08:00",end:"12:00"}];break;case"afternoon":a=[{start:"14:00",end:"18:00"}];break;case"evening":a=[{start:"19:00",end:"22:00"}];break;case"full":a=[{start:"09:00",end:"13:00"},{start:"15:00",end:"19:00"}];break}g(a),i.length===0&&x(["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes"])},K=async()=>{if(n.filter(a=>{const[t,r]=a.start_time.split(":").map(Number),[N,h]=a.end_time.split(":").map(Number);return N*60+h-(t*60+r)<=0}).length>0){l.error("Hay horarios invÃ¡lidos (Fin debe ser mayor a Inicio)");return}k(!0);try{await T.put("/teacher/availability",{meet_url:p||null,time_slots:n.map(a=>({day_of_week:a.day_of_week,start_time:a.start_time.substring(0,5),end_time:a.end_time.substring(0,5)}))}),l.success("ConfiguraciÃ³n guardada exitosamente")}catch{l.error("Error al guardar la configuraciÃ³n")}finally{k(!1)}},W=async()=>{C(!0);try{const s=await T.post("/teacher/toggle-availability");z(s.data.not_available_today),s.data.not_available_today?l.warning("Marcado como NO DISPONIBLE por hoy"):l.success("Marcado como DISPONIBLE hoy")}catch{l.error("Error al cambiar disponibilidad")}finally{C(!1)}},X=s=>({Lunes:"#073372",Martes:"#0ea5e9",MiÃ©rcoles:"#17BC91",Jueves:"#8b5cf6",Viernes:"#ec4899",SÃ¡bado:"#f59e0b",Domingo:"#ef4444"})[s]||"#64748b";return e.jsxs(te,{children:[e.jsx(ae,{title:"Mi Disponibilidad"}),e.jsxs("div",{className:"bg-gray-50 min-h-screen pb-12",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-30 shadow-sm",children:e.jsx("div",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mi Disponibilidad"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Administra tus horarios de clase y preferencias"})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs(o,{variant:"outline",onClick:()=>b(!0),className:"flex-1 sm:flex-none",children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Agregar Varios"]}),e.jsxs(o,{onClick:K,disabled:v,className:"bg-[#073372] hover:bg-[#062b61] text-white flex-1 sm:flex-none",children:[v?"Guardando...":"Guardar Cambios",!v&&e.jsx(de,{className:"w-4 h-4 ml-2"})]})]})]})})}),e.jsxs("div",{className:"w-full px-6 py-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(A,{className:"md:col-span-2 shadow-sm border-gray-200",children:[e.jsx(M,{className:"pb-3",children:e.jsxs(D,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(H,{className:"w-4 h-4 text-blue-700"})}),"Link de Google Meet"]})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"relative flex-1",children:e.jsx(re,{readOnly:!0,placeholder:"https://meet.google.com/...",value:p,className:"font-mono text-sm bg-gray-50 text-gray-500 cursor-not-allowed",icon:e.jsx(H,{className:"w-4 h-4"})})}),e.jsx(o,{variant:"outline",size:"icon",onClick:q,title:"Copiar Link",className:"shrink-0",children:e.jsx(ce,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Este enlace es asignado administrativamente y no puede ser modificado."})]})})]}),e.jsxs(A,{className:`shadow-sm border transition-colors ${c?"border-red-200 bg-red-50/50":"border-emerald-200 bg-emerald-50/50"}`,children:[e.jsx(M,{className:"pb-3",children:e.jsxs(D,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${c?"bg-red-100":"bg-emerald-100"}`,children:c?e.jsx(me,{className:"w-4 h-4 text-red-700"}):e.jsx(I,{className:"w-4 h-4 text-emerald-700"})}),"Estado de Hoy"]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm font-medium ${c?"text-red-700":"text-emerald-700"}`,children:c?"NO Disponible":"Disponible"}),e.jsx(ne,{checked:!c,onCheckedChange:W,disabled:R,className:"data-[state=checked]:bg-[#17BC91]"})]}),e.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:c?"Has indicado que no puedes atender hoy. No recibirÃ¡s nuevas asignaciones por el resto del dÃ­a.":"EstÃ¡s disponible para recibir clases hoy segÃºn tus horarios configurados."})]})})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5 text-gray-400"}),"Horarios Semanales"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:w.map(s=>{const a=n.filter(r=>r.day_of_week===s),t=X(s);return e.jsxs("div",{className:"flex flex-col bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden h-full",children:[e.jsxs("div",{className:"px-4 py-3 border-b flex items-center justify-between bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white shadow-sm text-xs",style:{backgroundColor:t},children:s.substring(0,3).toUpperCase()}),e.jsx("span",{className:"font-semibold text-gray-900",children:s})]}),e.jsx(o,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-[#073372] hover:bg-white",onClick:()=>P(s),title:"Agregar Horario",children:e.jsx(O,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 space-y-3 flex-1",children:a.length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 py-6 text-sm",children:e.jsx("span",{children:"No hay horarios"})}):a.map((r,N)=>{const h=n.indexOf(r),[Y,Q]=r.start_time.split(":").map(Number),[Z,ee]=r.end_time.split(":").map(Number),se=Z*60+ee>Y*60+Q;return e.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left-2 duration-200",children:[e.jsxs("div",{className:`flex-1 flex items-center gap-2 p-1.5 rounded-lg border ${se?"border-gray-200 bg-white":"border-red-300 bg-red-50"}`,children:[e.jsx("input",{type:"time",className:"flex-1 min-w-0 bg-transparent border-none text-sm font-medium text-gray-900 focus:ring-0 p-0 text-center",value:r.start_time,onChange:y=>S(h,"start_time",y.target.value)}),e.jsx("span",{className:"text-gray-400 text-xs",children:"âžœ"}),e.jsx("input",{type:"time",className:"flex-1 min-w-0 bg-transparent border-none text-sm font-medium text-gray-900 focus:ring-0 p-0 text-center",value:r.end_time,onChange:y=>S(h,"end_time",y.target.value)})]}),e.jsx("button",{onClick:()=>$(h),className:"text-gray-300 hover:text-red-500 transition-colors p-1",children:e.jsx(xe,{className:"w-4 h-4"})})]},N)})}),a.length>0&&e.jsxs("div",{className:"bg-gray-50 px-4 py-2 border-t text-xs text-gray-500 text-center",children:[a.length," horarios configurados"]})]},s)})})]})]}),e.jsx(ie,{open:V,onOpenChange:b,children:e.jsxs(le,{className:"w-[95vw] min-w-[60vw] max-w-[1400px] p-0 overflow-hidden gap-0",classNameIcon:"text-white [&_svg:not([class*='size-'])]:size-6",children:[e.jsxs("div",{className:"bg-[#073372] px-6 py-4 text-white",children:[e.jsx(oe,{className:"text-xl",children:"ConfiguraciÃ³n RÃ¡pida de Horarios"}),e.jsx("p",{className:"text-blue-100 text-sm mt-1",children:"Asigna horarios a mÃºltiples dÃ­as simultÃ¡neamente de forma masiva"})]}),e.jsxs("div",{className:"p-8 grid grid-cols-1 lg:grid-cols-2 gap-10",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2 text-sm",children:[e.jsx(E,{className:"w-4 h-4 text-[#073372]"}),"1. Selecciona DÃ­as"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>x(["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes"]),className:"text-xs h-7 text-[#073372] hover:bg-blue-50 hover:text-black",children:"Lun-Vie"}),e.jsx(o,{variant:"ghost",size:"sm",onClick:()=>x(w),className:"text-xs h-7 text-[#073372] hover:bg-blue-50 hover:text-black",children:"Todos"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:w.map(s=>e.jsxs("button",{onClick:()=>U(s),className:`
                                        flex items-center justify-between px-4 py-3 rounded-xl border transition-all duration-200 text-sm font-medium
                                        ${i.includes(s)?"border-[#073372] bg-[#073372] text-white shadow-md transform scale-[1.02]":"border-gray-200 bg-white text-gray-600 hover:bg-gray-50 hover:border-gray-300"}
                                    `,children:[e.jsx("span",{children:s}),i.includes(s)&&e.jsx(I,{className:"w-4 h-4 text-white"})]},s))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2 text-sm",children:[e.jsx(L,{className:"w-4 h-4 text-[#F98613]"}),"2. Define Horarios"]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-100 space-y-3",children:[m.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-white p-2 rounded-lg border border-gray-200 shadow-sm focus-within:border-[#073372] focus-within:ring-1 focus-within:ring-[#073372] transition-all",children:[e.jsx("label",{className:"text-[10px] text-gray-500 font-bold uppercase block mb-1",children:"Inicio"}),e.jsx("input",{type:"time",className:"w-full text-sm font-medium border-none p-0 focus:ring-0 text-gray-900 h-6",value:s.start,onChange:t=>_(a,"start",t.target.value)})]}),e.jsxs("div",{className:"bg-white p-2 rounded-lg border border-gray-200 shadow-sm focus-within:border-[#073372] focus-within:ring-1 focus-within:ring-[#073372] transition-all",children:[e.jsx("label",{className:"text-[10px] text-gray-500 font-bold uppercase block mb-1",children:"Fin"}),e.jsx("input",{type:"time",className:"w-full text-sm font-medium border-none p-0 focus:ring-0 text-gray-900 h-6",value:s.end,onChange:t=>_(a,"end",t.target.value)})]})]}),m.length>1&&e.jsx("button",{onClick:()=>F(a),className:"p-2 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(ge,{className:"w-4 h-4"})})]},a)),e.jsxs(o,{variant:"outline",size:"sm",onClick:J,className:"w-full border-dashed bg-white text-[#073372] border-[#073372]/30 hover:bg-blue-50",children:[e.jsx(O,{className:"w-4 h-4 mr-2"})," Agregar otro intervalo"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Plantillas RÃ¡pidas (Aplica a dÃ­as no seleccionados)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:()=>f("morning"),className:"text-left p-3 rounded-lg border border-gray-200 hover:border-amber-400 hover:bg-amber-50 group transition-all",children:[e.jsxs("div",{className:"font-semibold text-gray-700 group-hover:text-amber-700 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸŒ…"})," MaÃ±anas"]}),e.jsx("div",{className:"text-xs text-gray-500 group-hover:text-amber-600 mt-1",children:"08:00 - 12:00"})]}),e.jsxs("button",{onClick:()=>f("afternoon"),className:"text-left p-3 rounded-lg border border-gray-200 hover:border-orange-400 hover:bg-orange-50 group transition-all",children:[e.jsxs("div",{className:"font-semibold text-gray-700 group-hover:text-orange-700 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"â˜€ï¸"})," Tardes"]}),e.jsx("div",{className:"text-xs text-gray-500 group-hover:text-orange-600 mt-1",children:"14:00 - 18:00"})]}),e.jsxs("button",{onClick:()=>f("evening"),className:"text-left p-3 rounded-lg border border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 group transition-all",children:[e.jsxs("div",{className:"font-semibold text-gray-700 group-hover:text-indigo-700 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸŒ™"})," Noches"]}),e.jsx("div",{className:"text-xs text-gray-500 group-hover:text-indigo-600 mt-1",children:"19:00 - 22:00"})]}),e.jsxs("button",{onClick:()=>f("full"),className:"text-left p-3 rounded-lg border border-gray-200 hover:border-blue-400 hover:bg-blue-50 group transition-all",children:[e.jsxs("div",{className:"font-semibold text-gray-700 group-hover:text-blue-700 text-sm flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ¢"})," Jornada"]}),e.jsx("div",{className:"text-xs text-gray-500 group-hover:text-blue-600 mt-1",children:"2 turnos"})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 flex items-center justify-between border-t border-gray-100",children:[e.jsx("div",{className:"text-sm text-gray-500",children:i.length>0?e.jsxs("span",{children:["Aplicando a ",e.jsxs("span",{className:"font-bold text-[#073372]",children:[i.length," dÃ­as"]})," seleccionados"]}):e.jsx("span",{children:"Selecciona dÃ­as primero"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(o,{variant:"ghost",onClick:()=>b(!1),children:"Cancelar"}),e.jsx(o,{onClick:G,disabled:i.length===0,className:"bg-[#073372] hover:bg-[#062b61] text-white min-w-[140px]",children:"Aplicar Horarios"})]})]})]})})]})]})};export{Je as default};
