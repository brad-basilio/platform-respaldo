import{r as t,d as H,j as e,H as P,b as G}from"./app-Bln9jPqa.js";import{R as y,A as O,l as g,o as I,p as C,q as R,r as S,s as $,u as Q,v as W,w as X,t as l}from"./AuthenticatedLayout-DtFj7hl5.js";import{A as J,t as K,M as Y,a as Z}from"./index.esm-CrCo5IUa.js";import{I as c}from"./input-B50Edrz7.js";import{S as ee}from"./Select2-DvTxg42T.js";import{S as se}from"./sweetalert2.esm.all-NNS-RXd7.js";import{S as re}from"./search-Bz8wQm_H.js";import{C as ae}from"./circle-x-CEIsuFe9.js";/* empty css            */import"./button-BxBrMaaj.js";import"./dropdown-menu-Cu0UiIWZ.js";import"./createLucideIcon-D1a2ovW4.js";import"./index-C_UtxC_Z.js";import"./index-Bou8IgRN.js";import"./badge-Dtg1LwIH.js";Y.registerModules([Z]);const be=({users:i})=>{const[E,m]=t.useState(!1),[a,x]=t.useState(null),[u,j]=t.useState(!1),[h,b]=t.useState(""),B=t.useRef(null),{data:n,setData:o,post:U,put:A,processing:p,errors:d,reset:v}=H({name:"",email:"",role:"sales_advisor",password:""}),k=[{value:"admin",label:"Administrador"},{value:"sales_advisor",label:"Asesor de Ventas"},{value:"cashier",label:"Cajero"},{value:"verifier",label:"Verificador"}],M=s=>{switch(s){case"admin":return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#F98613]/10 text-[#F98613] border border-[#F98613]/30",children:[e.jsx(g,{className:"w-3 h-3 mr-1"}),"Administrador"]});case"sales_advisor":return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-50 text-purple-700 border border-purple-200",children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),"Asesor de Ventas"]});case"cashier":return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-cyan-50 text-cyan-700 border border-cyan-200",children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),"Cajero"]});case"verifier":return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#17BC91]/10 text-[#17BC91] border border-[#17BC91]/30",children:[e.jsx(S,{className:"w-3 h-3 mr-1"}),"Verificador"]});default:return s}},F=()=>{x(null),v(),m(!0)},L=s=>{x(s),o({name:s.name,email:s.email,role:s.role,password:""}),m(!0)},f=()=>{m(!1),x(null),v(),j(!1)},N=s=>{s.preventDefault(),a?A(`/admin/users/${a.id}`,{onSuccess:()=>{f(),l.success("Usuario actualizado",{description:"Los datos del usuario han sido actualizados exitosamente",duration:4e3})},onError:()=>{l.error("Error",{description:"No se pudo actualizar el usuario",duration:4e3})}}):U("/admin/users",{onSuccess:()=>{f(),l.success("Usuario creado",{description:"El nuevo usuario ha sido agregado al sistema",duration:4e3})},onError:()=>{l.error("Error",{description:"No se pudo crear el usuario",duration:4e3})}})},z=async(s,r)=>{(await se.fire({title:"¿Eliminar Usuario?",html:`
        <div class="text-left">
          <p class="text-gray-700 mb-3">¿Estás seguro de que quieres eliminar a <strong>${r}</strong>?</p>
          <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
            <p class="text-sm text-red-800">
              <strong>Advertencia:</strong> Esta acción no se puede deshacer.
            </p>
          </div>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:'<i class="fas fa-trash"></i> Sí, Eliminar',cancelButtonText:"Cancelar",reverseButtons:!0})).isConfirmed&&G.delete(`/admin/users/${s}`,{onSuccess:()=>{l.success("Usuario eliminado",{description:"El usuario ha sido eliminado del sistema",duration:4e3})},onError:()=>{l.error("Error",{description:"No se pudo eliminar el usuario",duration:4e3})}})},D=s=>{const r=s.data;return e.jsxs("div",{className:"flex items-center space-x-2 h-full",children:[e.jsx("button",{onClick:()=>L(r),className:"text-[#073372] hover:text-[#17BC91] transition-colors p-1.5 hover:bg-[#17BC91]/10 rounded",title:"Editar",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(r.id,r.name),className:"text-red-600 hover:text-red-800 transition-colors p-1.5 hover:bg-red-50 rounded",title:"Eliminar",children:e.jsx(X,{className:"h-4 w-4"})})]})},q=s=>e.jsx("div",{className:"flex items-center h-full",children:M(s.value)}),T=s=>{if(!s.value)return"";const r=new Date(s.value);return e.jsx("div",{className:"flex items-center h-full",children:e.jsx("span",{className:"text-sm text-gray-600",children:r.toLocaleDateString("es-PE",{year:"numeric",month:"short",day:"numeric"})})})},V=t.useMemo(()=>[{headerName:"Usuario",field:"name",minWidth:300,filter:"agTextColumnFilter",cellRenderer:s=>{const r=s.data;return e.jsxs("div",{className:"flex items-center py-2 w-full h-full",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-[#073372] to-[#17BC91] rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:r.name.split(" ").map(w=>w[0]).join("").slice(0,2).toUpperCase()})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r.name}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(y,{className:"w-3 h-3 mr-1"}),r.email]})]})]})}},{headerName:"Rol",field:"role",width:200,cellRenderer:q,filter:"agTextColumnFilter"},{headerName:"Fecha de Creación",field:"created_at",width:180,cellRenderer:T,filter:"agDateColumnFilter"},{headerName:"Acciones",cellRenderer:D,width:120,sortable:!1,filter:!1,pinned:"right"}],[]),_={sortable:!0,resizable:!0,filter:!0};return e.jsxs(O,{children:[e.jsx(P,{title:"Gestión de Usuarios"}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-xl shadow-lg",children:e.jsx(g,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Gestión de Usuarios"}),e.jsx("p",{className:"text-sm text-slate-600",children:"Administra asesores, cajeros y verificadores del sistema"})]})]}),e.jsxs("button",{onClick:F,className:"inline-flex items-center px-4 py-2.5 bg-[#073372] hover:bg-[#17BC91] text-white text-sm font-medium rounded-lg transition-all shadow-md hover:shadow-lg",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Nuevo Usuario"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Administradores"}),e.jsx("p",{className:"text-3xl font-bold text-[#F98613] mt-1",children:i.filter(s=>s.role==="admin").length})]}),e.jsx("div",{className:"p-3 bg-[#F98613]/10 rounded-lg",children:e.jsx(g,{className:"w-8 h-8 text-[#F98613]"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Asesores de Ventas"}),e.jsx("p",{className:"text-3xl font-bold text-purple-600 mt-1",children:i.filter(s=>s.role==="sales_advisor").length})]}),e.jsx("div",{className:"p-3 bg-purple-50 rounded-lg",children:e.jsx(C,{className:"w-8 h-8 text-purple-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cajeros"}),e.jsx("p",{className:"text-3xl font-bold text-cyan-600 mt-1",children:i.filter(s=>s.role==="cashier").length})]}),e.jsx("div",{className:"p-3 bg-cyan-50 rounded-lg",children:e.jsx(R,{className:"w-8 h-8 text-cyan-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Verificadores"}),e.jsx("p",{className:"text-3xl font-bold text-[#17BC91] mt-1",children:i.filter(s=>s.role==="verifier").length})]}),e.jsx("div",{className:"p-3 bg-[#17BC91]/10 rounded-lg",children:e.jsx(S,{className:"w-8 h-8 text-[#17BC91]"})})]})})]}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"relative",children:[e.jsx(c,{type:"text",value:h,onChange:s=>b(s.target.value),label:"Buscar por nombre, email o rol...",icon:e.jsx(re,{className:"w-4 h-4"}),className:"pr-10"}),h&&e.jsx("button",{onClick:()=>b(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ae,{className:"h-5 w-5"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:e.jsx("div",{className:"ag-theme-quartz",style:{height:"600px",width:"100%"},children:e.jsx(J,{ref:B,theme:K,rowData:i,columnDefs:V,defaultColDef:_,quickFilterText:h,pagination:!0,paginationPageSize:20,paginationPageSizeSelector:[10,20,50,100],animateRows:!0,rowSelection:{mode:"singleRow"},domLayout:"normal",rowHeight:70,headerHeight:48,suppressCellFocus:!0,rowClass:"hover:bg-gray-50"})})})]}),E&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] px-8 py-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:a?"Editar Usuario":"Nuevo Usuario"}),e.jsx("p",{className:"text-white/80 text-sm mt-1",children:a?"Modifica los datos del usuario":"Completa los datos del nuevo usuario"})]}),e.jsx("div",{className:"p-8 overflow-y-auto max-h-[calc(90vh-200px)]",children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsx(c,{label:"Nombre Completo",type:"text",value:n.name,onChange:s=>o("name",s.target.value),error:d.name,required:!0,variant:"outlined"}),e.jsx(c,{label:"Correo Electrónico",type:"email",value:n.email,onChange:s=>o("email",s.target.value),icon:e.jsx(y,{className:"w-5 h-5"}),error:d.email,required:!0,variant:"outlined"}),e.jsx("div",{children:e.jsx(ee,{label:"Rol del Usuario",options:k,value:n.role,onChange:s=>o("role",s),placeholder:"Selecciona un rol",helperText:d.role})}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{label:a?"Contraseña (opcional)":"Contraseña",type:u?"text":"password",value:n.password,onChange:s=>o("password",s.target.value),error:d.password,required:!a,variant:"outlined",helperText:a?"Dejar en blanco para mantener la contraseña actual":"Mínimo 8 caracteres"}),e.jsx("button",{type:"button",onClick:()=>j(!u),className:"absolute right-3 top-[18px] text-gray-400 hover:text-gray-600 transition-colors z-10",children:u?e.jsx($,{className:"h-5 w-5"}):e.jsx(Q,{className:"h-5 w-5"})})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-8 py-4 border-t border-gray-200 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:f,className:"px-6 py-2.5 text-sm font-medium text-slate-700 bg-white border border-slate-300 rounded-lg hover:bg-slate-50 transition-colors",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",onClick:N,className:"px-6 py-2.5 text-sm font-medium text-white bg-[#073372] hover:bg-[#17BC91] rounded-lg transition-colors shadow-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:p,children:p?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Guardando..."]}):a?"Actualizar Usuario":"Crear Usuario"})]})]})})]})};export{be as default};
