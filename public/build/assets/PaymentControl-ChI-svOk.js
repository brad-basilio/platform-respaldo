import{c as we,r as l,j as e,a as $,U as ge}from"./app-DBgbPuMu.js";import{t as d,U as G,A as de,D as Ce}from"./AuthenticatedLayout-CDC4-kpR.js";import{I as ke}from"./input-BXTTnMh3.js";import{S as ee}from"./smartphone-COCr3gED.js";import{B as se}from"./building-2-C4u5egMM.js";import{C as xe}from"./credit-card-BW6WK1lP.js";import{X as H}from"./dropdown-menu-DlG3qvZy.js";import{c as re}from"./createLucideIcon-CARAMrd8.js";import{L as Pe}from"./lock-q299_5iN.js";import{C as Y}from"./circle-alert-Ddx8u-47.js";import{C as te}from"./circle-check-Da-jVqps.js";import{C as ce}from"./check-DBqco0Sz.js";import{C as ae}from"./copy-B1FEAwYs.js";import{D as ue}from"./dollar-sign-CaUR9KAO.js";import{T as Se}from"./trending-up--R1kVADw.js";import{C as be}from"./circle-check-big-DFeh0OgZ.js";import{C as Z}from"./clock-j7Zpjt81.js";import{F as fe}from"./file-text-BThQLhe7.js";import{C as Be}from"./calendar-C90gbz5d.js";/* empty css            */import"./button-CHuyEkIG.js";import"./clsx-B-dksMZM.js";import"./badge-BQE-VrJN.js";import"./index-9QHdgY5P.js";import"./triangle-alert-CvHxaLUB.js";import"./index-NvEw4eID.js";import"./index-BkMTO_VP.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],je=re("ArrowRight",Fe);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]],Me=re("QrCode",De);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],Ee=re("RefreshCcw",Te);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],qe=re("Shield",_e),Ie=n=>{const t=we.c(41),{isOpen:k,onClose:E,onSelectMethod:j,installmentAmount:u}=n,[N,y]=l.useState(null);if(!k)return null;const z=Le;let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c={id:"yape",name:"Yape",description:"Pago rÃ¡pido mediante aplicaciÃ³n Yape",icon:ee,color:"from-[#073372] to-[#17BC91]",bgColor:"bg-gradient-to-br from-[#073372]/5 to-[#17BC91]/5",borderColor:"border-[#17BC91]",hoverColor:"hover:border-[#073372]",enabled:!0},t[0]=c):c=t[0];let P;t[1]===Symbol.for("react.memo_cache_sentinel")?(P={id:"transfer",name:"Transferencia Bancaria",description:"Transferencia o depÃ³sito bancario interbancario",icon:se,color:"from-[#073372] to-[#17BC91]",bgColor:"bg-gradient-to-br from-[#073372]/5 to-[#17BC91]/5",borderColor:"border-[#17BC91]",hoverColor:"hover:border-[#073372]",enabled:!0},t[1]=P):P=t[1];let v;t[2]===Symbol.for("react.memo_cache_sentinel")?(v=[c,P,{id:"card",name:"Tarjeta de CrÃ©dito/DÃ©bito",description:"Pago con tarjeta Visa, Mastercard, American Express",icon:xe,color:"from-[#073372] to-[#17BC91]",bgColor:"bg-gradient-to-br from-[#073372]/5 to-[#17BC91]/5",borderColor:"border-[#17BC91]",hoverColor:"hover:border-[#073372]",enabled:!1}],t[2]=v):v=t[2];const A=v;let _;t[3]!==j||t[4]!==N?(_=()=>{N&&j(N)},t[3]=j,t[4]=N,t[5]=_):_=t[5];const w=_;let q;t[6]===Symbol.for("react.memo_cache_sentinel")?(q=e.jsx("h2",{className:"text-2xl font-bold",children:"Selecciona tu mÃ©todo de pago"}),t[6]=q):q=t[6];let S;t[7]!==u?(S=z(u),t[7]=u,t[8]=S):S=t[8];let x;t[9]!==S?(x=e.jsxs("div",{children:[q,e.jsxs("p",{className:"text-white/90 text-sm mt-1",children:["Monto a pagar: ",e.jsx("span",{className:"font-bold text-lg",children:S})]})]}),t[9]=S,t[10]=x):x=t[10];let f;t[11]===Symbol.for("react.memo_cache_sentinel")?(f=e.jsx(H,{className:"w-6 h-6"}),t[11]=f):f=t[11];let m;t[12]!==E?(m=e.jsx("button",{onClick:E,className:"text-white/80 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-lg",children:f}),t[12]=E,t[13]=m):m=t[13];let i;t[14]!==x||t[15]!==m?(i=e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-8 py-6 rounded-t-2xl flex items-center justify-between flex-shrink-0",children:[x,m]}),t[14]=x,t[15]=m,t[16]=i):i=t[16];let M;t[17]!==N?(M=A.map(C=>{const le=C.icon,J=N===C.id,X=!C.enabled;return e.jsx("button",{onClick:()=>C.enabled&&y(C.id),disabled:X,className:`w-full text-left p-6 rounded-2xl border-2 transition-all ${X?"border-slate-200 hover:border-slate-300 ":J?`${C.borderColor} ${C.bgColor} shadow-lg scale-[1.02]`:`border-slate-200 ${C.hoverColor} hover:shadow-md`}`,children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:`p-4 rounded-xl bg-gradient-to-br ${C.color} flex-shrink-0`,children:e.jsx(le,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:C.name}),J&&!X&&e.jsx("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-gradient-to-br from-[#17BC91] to-[#073372] flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),e.jsx("p",{className:"text-sm text-slate-600",children:C.description}),C.enabled&&e.jsxs("div",{className:"mt-3 flex items-center space-x-4 text-xs",children:[C.id==="card"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-700 font-medium",children:"âœ“ AprobaciÃ³n InstantÃ¡nea"}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-blue-100 text-blue-700 font-medium",children:"ðŸ’³ Guardar Tarjeta"})]}),(C.id==="yape"||C.id==="transfer")&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-[#F98613]/20 text-[#F98613] font-medium",children:"â³ Requiere VerificaciÃ³n"}),e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-[#17BC91]/20 text-[#17BC91] font-medium",children:"ðŸ“± Subir Comprobante"})]})]})]})]})},C.id)}),t[17]=N,t[18]=M):M=t[18];let B;t[19]===Symbol.for("react.memo_cache_sentinel")?(B=e.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-[#073372] to-[#17BC91] flex items-center justify-center",children:e.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),t[19]=B):B=t[19];let T;t[20]===Symbol.for("react.memo_cache_sentinel")?(T=e.jsx("p",{className:"text-sm font-semibold text-[#073372] mb-1",children:"ðŸ“Œ InformaciÃ³n Importante"}),t[20]=T):T=t[20];let r;t[21]===Symbol.for("react.memo_cache_sentinel")?(r=e.jsx("strong",{className:"text-[#073372]",children:"Yape"}),t[21]=r):r=t[21];let a;t[22]===Symbol.for("react.memo_cache_sentinel")?(a=e.jsx("strong",{className:"text-[#073372]",children:"Transferencia Bancaria"}),t[22]=a):a=t[22];let g;t[23]===Symbol.for("react.memo_cache_sentinel")?(g=e.jsx("div",{className:"mt-6 p-5 bg-gradient-to-br from-[#073372]/10 to-[#17BC91]/10 border-2 border-[#17BC91]/30 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[B,e.jsxs("div",{className:"flex-1",children:[T,e.jsxs("p",{className:"text-sm text-slate-700 leading-relaxed",children:["Para pagos con ",r," o ",a,", deberÃ¡s subir el comprobante despuÃ©s de realizar la operaciÃ³n. Nuestro equipo verificarÃ¡ tu pago en un plazo de ",e.jsx("strong",{className:"text-[#17BC91]",children:"24-48 horas"}),"."]})]})]})}),t[23]=g):g=t[23];let I;t[24]!==M?(I=e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-4",children:[M,g]}),t[24]=M,t[25]=I):I=t[25];let V;t[26]!==E?(V=e.jsx("button",{onClick:E,className:"px-6 py-3 border-2 border-slate-300 text-slate-700 font-semibold rounded-xl hover:bg-slate-100 transition-colors",children:"Cancelar"}),t[26]=E,t[27]=V):V=t[27];const W=!N,K=`px-8 py-3 rounded-xl font-semibold transition-all flex items-center space-x-2 ${N?"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white hover:shadow-lg hover:scale-105":"bg-slate-200 text-slate-400 cursor-not-allowed"}`;let O,F;t[28]===Symbol.for("react.memo_cache_sentinel")?(O=e.jsx("span",{children:"Continuar"}),F=e.jsx(je,{className:"w-5 h-5"}),t[28]=O,t[29]=F):(O=t[28],F=t[29]);let U;t[30]!==w||t[31]!==W||t[32]!==K?(U=e.jsxs("button",{onClick:w,disabled:W,className:K,children:[O,F]}),t[30]=w,t[31]=W,t[32]=K,t[33]=U):U=t[33];let L;t[34]!==V||t[35]!==U?(L=e.jsxs("div",{className:"bg-slate-50 px-8 py-6 rounded-b-2xl border-t border-slate-200 flex justify-end space-x-4 flex-shrink-0",children:[V,U]}),t[34]=V,t[35]=U,t[36]=L):L=t[36];let Q;return t[37]!==i||t[38]!==I||t[39]!==L?(Q=e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] flex flex-col",children:[i,I,L]})}),t[37]=i,t[38]=I,t[39]=L,t[40]=Q):Q=t[40],Q};function Le(n){return new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(n)}const Ae=({isOpen:n,onClose:t,installment:k,onSuccess:E})=>{const[j,u]=l.useState(!1),[N,y]=l.useState(!1),[z,c]=l.useState(!1),[P,v]=l.useState(""),[A,_]=l.useState(!1);l.useEffect(()=>{n&&(async()=>{try{const f=await $.get("/api/student/culqi/public-key");v(f.data.public_key)}catch(f){console.error("Error loading Culqi public key:",f),d.error("Error al cargar configuraciÃ³n de pagos")}})()},[n]),l.useEffect(()=>{if(!P)return;const x=document.createElement("script");return x.src="https://js.culqi.com/checkout-js",x.async=!0,x.onload=()=>{_(!0),w()},document.body.appendChild(x),()=>{document.body.removeChild(x)}},[P]);const w=()=>{if(!window.CulqiCheckout||!P)return;const x={title:"ANCED - Pago de Cuota",currency:"PEN",amount:Math.round(k.amount*100)},f={email:""},m={lang:"es",installments:!1,modal:!0,container:"#culqi-container",paymentMethods:{tarjeta:!0,yape:!1,billetera:!1,bancaMovil:!1,agente:!1,cuotealo:!1}},i={theme:"default",hiddenCulqiLogo:!1,menuType:"sidebar",buttonCardPayText:`Pagar S/. ${k.amount.toFixed(2)}`,logo:null,defaultStyle:{bannerColor:"#073372",buttonBackground:"#17BC91",menuColor:"#073372",linksColor:"#17BC91",buttonTextColor:"#ffffff",priceColor:"#073372"}},M={settings:x,client:f,options:m,appearance:i},B=new window.CulqiCheckout(P,M),T=()=>{if(window.Culqi.token){const r=window.Culqi.token;console.log("Token creado:",r.id),B.close(),S(r.id)}else window.Culqi.order?(B.close(),console.log("Order created:",window.Culqi.order)):(console.error("Culqi error:",window.Culqi.error),d.error(window.Culqi.error.user_message||"Error al procesar el pago"),u(!1))};B.culqi=T,window.Culqi=B},q=()=>{if(!window.Culqi){d.error("Culqi no estÃ¡ listo. Por favor intenta de nuevo.");return}u(!0),window.Culqi.open()},S=async x=>{try{u(!0);const f=await $.post("/api/student/culqi/process-payment",{token_id:x,installment_id:k.id,amount:k.amount,save_card:N,auto_payment:z});f.data.success?(d.success("Â¡Pago procesado exitosamente!",{description:`La cuota #${k.installment_number} ha sido pagada`,duration:5e3}),E(),t()):d.error("Error al procesar el pago",{description:f.data.error||"Intenta nuevamente"})}catch(f){console.error("Error processing payment:",f);const m=f.response?.data?.error||"Error al procesar el pago";d.error(m)}finally{u(!1)}};return n?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:t}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white shadow-2xl transition-all",children:[e.jsxs("div",{className:"relative bg-gradient-to-r from-[#073372] to-[#17BC91] px-8 py-6",children:[e.jsx("button",{onClick:t,className:"absolute right-4 top-4 rounded-full bg-white/20 p-2 text-white hover:bg-white/30 transition-colors",children:e.jsx(H,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-white/20 p-3",children:e.jsx(xe,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Pagar con Tarjeta"}),e.jsxs("p",{className:"text-sm text-white/90",children:["Cuota #",k.installment_number," - S/. ",k.amount.toFixed(2)]})]})]})]}),e.jsxs("div",{className:"px-8 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(qe,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-green-900",children:"Pago 100% Seguro"}),e.jsx("p",{className:"text-xs text-green-700",children:"Tu informaciÃ³n estÃ¡ protegida con encriptaciÃ³n SSL"})]}),e.jsx(Pe,{className:"h-5 w-5 text-green-600"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:'Al hacer clic en "Pagar con Tarjeta", se abrirÃ¡ el formulario seguro de Culqi donde podrÃ¡s ingresar los datos de tu tarjeta.'}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:x=>y(x.target.checked),className:"mt-1 w-4 h-4 text-[#17BC91] border-gray-300 rounded focus:ring-[#17BC91]"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 group-hover:text-[#17BC91] transition-colors",children:"Guardar tarjeta para futuros pagos"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PodrÃ¡s pagar mÃ¡s rÃ¡pido en tu prÃ³xima cuota"})]})]}),N&&e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group ml-7 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("input",{type:"checkbox",checked:z,onChange:x=>c(x.target.checked),className:"mt-1 w-4 h-4 text-blue-600 border-blue-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900 group-hover:text-blue-700 transition-colors",children:"Habilitar pagos automÃ¡ticos"}),e.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Tus cuotas futuras se pagarÃ¡n automÃ¡ticamente en la fecha de vencimiento"})]})]})]})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"Cuota"}),e.jsxs("span",{className:"font-medium text-gray-900",children:["S/. ",k.amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm mb-2",children:[e.jsx("span",{className:"text-gray-600",children:"ComisiÃ³n"}),e.jsx("span",{className:"font-medium text-gray-900",children:"S/. 0.00"})]}),e.jsx("div",{className:"border-t border-gray-300 pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-gray-900",children:"Total a Pagar"}),e.jsxs("span",{className:"text-2xl font-bold text-[#073372]",children:["S/. ",k.amount.toFixed(2)]})]})})]}),e.jsx("div",{id:"culqi-container"})]}),e.jsxs("div",{className:"px-8 py-6 bg-gray-50 border-t border-gray-200 flex gap-3",children:[e.jsx("button",{type:"button",onClick:t,disabled:j,className:"flex-1 px-6 py-3 border border-gray-300 rounded-lg text-gray-700 font-medium hover:bg-gray-100 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{type:"button",onClick:q,disabled:j||!A||!P,className:"flex-1 px-6 py-3 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-medium rounded-lg hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:j?"Procesando...":"Pagar con Tarjeta"})]}),e.jsx("div",{className:"px-8 py-3 bg-gray-100 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-center text-gray-500",children:["Procesado de forma segura por ",e.jsx("span",{className:"font-semibold",children:"Culqi"})]})})]})})]}):null},Ue=({isOpen:n,onClose:t,onSuccess:k,installmentId:E,amount:j})=>{const[u,N]=l.useState([]),[y,z]=l.useState(null),[c,P]=l.useState(null),[v,A]=l.useState(null),[_,w]=l.useState(!1),[q,S]=l.useState(!0),[x,f]=l.useState(!1),[m,i]=l.useState(1);l.useEffect(()=>{n&&(M(),i(1),P(null),A(null))},[n]);const M=async()=>{try{S(!0);const g=(await $.get("/api/student/active-payment-methods")).data.yapes||[];N(g),g.length>0&&z(g[0])}catch(a){console.error("Error fetching yape methods:",a),d.error("Error al cargar mÃ©todos Yape")}finally{S(!1)}},B=a=>{navigator.clipboard.writeText(a),f(!0),d.success("NÃºmero copiado"),setTimeout(()=>f(!1),2e3)},T=a=>{const g=a.target.files?.[0];if(g){if(!g.type.startsWith("image/")&&g.type!=="application/pdf"){d.error("Solo se permiten imÃ¡genes o archivos PDF");return}if(g.size>5*1024*1024){d.error("El archivo no debe superar 5MB");return}if(P(g),g.type.startsWith("image/")){const I=new FileReader;I.onloadend=()=>{A(I.result)},I.readAsDataURL(g)}else A(null)}},r=async()=>{if(!y){d.error("Selecciona un mÃ©todo Yape");return}if(!c){d.error("Debes subir el comprobante de pago");return}try{w(!0);const a=new FormData;a.append("voucher_file",c),a.append("installment_id",E),a.append("declared_amount",j.toString()),a.append("payment_date",new Date().toISOString().split("T")[0]),a.append("payment_method","yape"),await $.post("/api/student/upload-voucher",a,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Â¡Pago registrado exitosamente!",{description:"Tu comprobante estÃ¡ siendo verificado"}),k(),t()}catch(a){console.error("Error uploading voucher:",a);const I=a.response?.data?.message||"No se pudo procesar el pago";d.error("Error al subir comprobante",{description:I})}finally{w(!1)}};return n?e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-6 py-5 rounded-t-2xl flex items-center justify-between flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(ee,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"Pagar con Yape"}),e.jsxs("p",{className:"text-sm text-white/90",children:["Monto: ",e.jsx("span",{className:"font-bold",children:new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(j)})]})]})]}),e.jsx("button",{onClick:t,className:"text-white/80 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-lg",children:e.jsx(H,{className:"w-6 h-6"})})]}),q?e.jsx("div",{className:"flex-1 overflow-y-auto p-12 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#17BC91]"})}):u.length===0?e.jsxs("div",{className:"flex-1 overflow-y-auto p-12 text-center",children:[e.jsx(Y,{className:"w-16 h-16 text-[#F98613] mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No hay mÃ©todos Yape disponibles"}),e.jsx("p",{className:"text-slate-600",children:"Por favor, contacta con administraciÃ³n"})]}):e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsx("div",{className:"mb-6 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl p-4",children:e.jsx("div",{className:"flex items-center justify-between mb-3",children:[1,2,3].map(a=>e.jsxs(ge.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full font-bold transition-all ${m===a?"bg-gradient-to-br from-[#073372] to-[#17BC91] text-white shadow-lg ring-4 ring-[#17BC91]/20":m>a?"bg-[#17BC91] text-white":"bg-white border-2 border-slate-300 text-slate-400"}`,children:m>a?e.jsx(te,{className:"w-6 h-6"}):a}),e.jsx("span",{className:`text-xs font-semibold ${m===a?"text-[#073372]":m>a?"text-[#17BC91]":"text-slate-400"}`,children:a===1?"Instrucciones":a===2?"Pagar":"Comprobante"})]}),a<3&&e.jsx("div",{className:"flex-1 h-1 mx-3 rounded-full transition-all",style:{background:m>a?"#17BC91":"#e2e8f0"}})]},a))})}),u.length>1&&e.jsxs("div",{className:"mb-4 space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700",children:"Selecciona la cuenta Yape:"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:u.map(a=>e.jsx("button",{onClick:()=>z(a),className:`p-3 rounded-lg border-2 transition-all text-left ${y?.id===a.id?"border-[#17BC91] bg-[#17BC91]/5 shadow-sm":"border-slate-200 hover:border-slate-300 hover:bg-slate-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-slate-900",children:a.name}),a.description&&e.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:a.description}),e.jsxs("p",{className:"text-sm text-slate-700 mt-1 flex items-center gap-1",children:[e.jsx(ee,{className:"w-3.5 h-3.5"}),a.phone_number]})]}),y?.id===a.id&&e.jsx(ce,{className:"w-5 h-5 text-[#17BC91] flex-shrink-0"})]})},a.id))})]}),y&&m===1&&e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/20 rounded-xl p-5 space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-lg",children:e.jsx(ee,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"CÃ³mo pagar con Yape"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Sigue estos pasos desde tu celular"})]})]}),e.jsx("div",{className:"bg-[#F98613]/5 border border-[#F98613]/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-[#F98613] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-[#F98613] mb-1",children:"Â¿QuÃ© es Yape?"}),e.jsx("p",{className:"text-xs text-slate-700 leading-relaxed",children:"Yape es una app del BCP para hacer pagos desde tu celular de forma rÃ¡pida y segura."})]})]})}),e.jsxs("div",{className:"bg-[#17BC91]/5 border border-[#17BC91]/30 rounded-lg p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-[#073372] mb-2",children:"ðŸ“± PreparaciÃ³n:"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["AsegÃºrate de tener la ",e.jsx("span",{className:"font-semibold text-[#073372]",children:"app de Yape"})," instalada en tu celular"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["Ten saldo disponible de ",e.jsx("span",{className:"font-bold text-[#F98613]",children:new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(j)})," en tu cuenta Yape"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:"Abre la app de Yape en tu celular"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-slate-700 leading-relaxed",children:[e.jsx("span",{className:"font-semibold",children:"Siguiente paso:"})," Te mostraremos el cÃ³digo QR que debes escanear con Yape para realizar el pago."]})}),e.jsxs("button",{onClick:()=>i(2),className:"w-full py-2.5 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all flex items-center justify-center gap-2",children:["Ver cÃ³digo QR",e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),y&&m===2&&e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/20 rounded-xl p-5 space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-lg",children:e.jsx(Me,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Escanea y paga"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Usa tu app de Yape para escanear"})]})]}),e.jsx("div",{className:"flex flex-col items-center py-2",children:y.qr_image_url?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-white p-3 rounded-lg border-2 border-[#17BC91]/30 shadow-md mb-3",children:e.jsx("img",{src:y.qr_image_url,alt:"QR Yape",className:"w-56 h-56 object-contain"})}),e.jsx("p",{className:"text-xs text-slate-600 text-center mb-2",children:"Escanea este cÃ³digo con tu app de Yape"})]}):e.jsxs("div",{className:"w-full bg-[#17BC91]/5 border-2 border-[#17BC91]/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-2 text-center",children:"NÃºmero de Yape:"}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("p",{className:"text-2xl font-bold text-[#073372]",children:y.phone_number}),e.jsx("button",{onClick:()=>B(y.phone_number),className:"p-1.5 hover:bg-[#073372]/10 rounded-md transition-colors",title:"Copiar nÃºmero",children:e.jsx(ae,{className:`w-4 h-4 ${x?"text-[#17BC91]":"text-[#073372]"}`})})]}),e.jsx("p",{className:"text-xs text-slate-600 text-center mt-2",children:"Ingresa este nÃºmero manualmente en Yape"})]})}),e.jsxs("div",{className:"bg-[#17BC91]/5 border border-[#17BC91]/30 rounded-lg p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-[#073372] mb-2",children:"ðŸ“± Pasos en Yape:"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:y.qr_image_url?"Escanea el cÃ³digo QR desde la app de Yape":`Ingresa el nÃºmero: ${y.phone_number}`})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["Verifica que el monto sea ",e.jsx("span",{className:"font-bold text-[#F98613]",children:new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(j)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:"Confirma y completa el pago"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#17BC91] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"4"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:[e.jsx("span",{className:"font-semibold text-[#17BC91]",children:"Â¡Importante!"})," Toma captura de pantalla del comprobante"]})]})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-slate-700",children:[e.jsx("span",{className:"font-semibold",children:"No cierres Yape"})," hasta tomar la captura de pantalla del comprobante. La necesitarÃ¡s en el siguiente paso."]})]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>i(1),className:"flex-1 py-2.5 border-2 border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors",children:"Volver"}),e.jsx("button",{onClick:()=>i(3),className:"flex-1 py-2.5 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all",children:"Ya paguÃ©"})]})]}),y&&m===3&&e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/20 rounded-xl p-5 space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-lg",children:e.jsx(G,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Sube tu comprobante"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Carga la captura de pantalla del pago"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-slate-700 leading-relaxed",children:["Sube la captura de pantalla del comprobante de Yape. SerÃ¡ revisado por nuestro equipo en ",e.jsx("span",{className:"font-semibold text-[#073372]",children:"24-48 horas"}),"."]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Comprobante de pago ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:T,className:"hidden",id:"yape-voucher-upload"}),e.jsx("label",{htmlFor:"yape-voucher-upload",className:`block w-full px-4 py-6 border-2 border-dashed rounded-lg text-center cursor-pointer transition-all ${c?"border-[#17BC91] bg-[#17BC91]/5":"border-slate-300 hover:border-[#073372] hover:bg-slate-50"}`,children:v?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:v,alt:"Preview",className:"max-h-40 mx-auto rounded-md shadow-md border-2 border-[#17BC91]"}),e.jsx("div",{className:"absolute -top-1 -right-1 p-0.5 bg-[#17BC91] rounded-full",children:e.jsx(te,{className:"w-4 h-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-slate-700 font-medium",children:c?.name}),e.jsx("p",{className:"text-xs text-[#073372]",children:"âœ“ Listo | Click para cambiar"})]}):c?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-2 bg-[#17BC91]/10 rounded-full inline-block",children:e.jsx(G,{className:"w-6 h-6 text-[#17BC91]"})}),e.jsx("p",{className:"text-xs text-slate-900 font-medium",children:c.name}),e.jsx("p",{className:"text-xs text-[#073372]",children:"âœ“ Listo | Click para cambiar"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-full inline-block",children:e.jsx(G,{className:"w-6 h-6 text-slate-400"})}),e.jsx("p",{className:"text-sm text-slate-700 font-medium",children:"Click para subir el comprobante"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PNG, JPG o PDF â€¢ MÃ¡x. 5MB"})]})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>i(2),disabled:_,className:"flex-1 py-2.5 border-2 border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors disabled:opacity-50",children:"Volver"}),e.jsx("button",{onClick:r,disabled:_||!c,className:"flex-1 inline-flex items-center justify-center py-2.5 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:_?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Confirmar Pago"]})})]})]})]})]})}):null},$e=({isOpen:n,onClose:t,onSuccess:k,installmentId:E,amount:j})=>{const[u,N]=l.useState(1),[y,z]=l.useState([]),[c,P]=l.useState(null),[v,A]=l.useState(null),[_,w]=l.useState(null),[q,S]=l.useState(!1),[x,f]=l.useState(!0);l.useEffect(()=>{n&&(m(),N(1),A(null),w(null))},[n]);const m=async()=>{try{f(!0);const a=(await $.get("/api/student/active-payment-methods")).data.transfers||[];z(a),a.length>0&&P(a[0])}catch(r){console.error("Error fetching transfer methods:",r),d.error("Error al cargar cuentas bancarias")}finally{f(!1)}},i=(r,a)=>{navigator.clipboard.writeText(r),d.success(`${a} copiado al portapapeles`,{duration:2e3})},M=r=>{const a=r.target.files?.[0];if(a){if(!a.type.startsWith("image/")&&a.type!=="application/pdf"){d.error("Solo se permiten imÃ¡genes o archivos PDF");return}if(a.size>5*1024*1024){d.error("El archivo no debe superar 5MB");return}if(A(a),a.type.startsWith("image/")){const g=new FileReader;g.onloadend=()=>{w(g.result)},g.readAsDataURL(a)}else w(null)}},B=async()=>{if(!c){d.error("Selecciona una cuenta bancaria");return}if(!v){d.error("Debes subir el comprobante de pago");return}try{S(!0);const r=new FormData;r.append("voucher_file",v),r.append("installment_id",E),r.append("declared_amount",j.toString()),r.append("payment_date",new Date().toISOString().split("T")[0]),r.append("payment_method","transfer"),await $.post("/api/student/upload-voucher",r,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Â¡Pago registrado exitosamente!",{description:"Tu comprobante estÃ¡ siendo verificado. RecibirÃ¡s una notificaciÃ³n pronto."}),k(),t()}catch(r){console.error("Error uploading voucher:",r);const a=r;d.error("Error al subir comprobante",{description:a.response?.data?.message||"No se pudo procesar el pago"})}finally{S(!1)}};if(!n)return null;const T=r=>new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(r);return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-6 py-5 rounded-t-2xl flex items-center justify-between flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white/20 rounded-lg",children:e.jsx(se,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold",children:"Transferencia Bancaria"}),e.jsxs("p",{className:"text-sm text-white/90",children:["Monto: ",e.jsx("span",{className:"font-bold",children:T(j)})]})]})]}),e.jsx("button",{onClick:t,className:"text-white/80 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-lg",disabled:q,children:e.jsx(H,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:x?e.jsx("div",{className:"p-12 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#17BC91]"})}):y.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Y,{className:"w-16 h-16 text-[#F98613] mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No hay cuentas bancarias disponibles"}),e.jsx("p",{className:"text-slate-600 text-sm",children:"Por favor, contacta con administraciÃ³n"})]}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"mb-6 bg-gradient-to-r from-slate-50 to-slate-100 rounded-xl p-4",children:e.jsx("div",{className:"flex items-center justify-between mb-3",children:[1,2,3].map(r=>e.jsxs(ge.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("div",{className:`flex items-center justify-center w-12 h-12 rounded-full font-bold transition-all ${u===r?"bg-gradient-to-br from-[#073372] to-[#17BC91] text-white shadow-lg ring-4 ring-[#17BC91]/20":u>r?"bg-[#17BC91] text-white":"bg-white border-2 border-slate-300 text-slate-400"}`,children:u>r?e.jsx(ce,{className:"w-6 h-6"}):r}),e.jsx("span",{className:`text-xs font-semibold ${u===r?"text-[#073372]":u>r?"text-[#17BC91]":"text-slate-400"}`,children:r===1?"Instrucciones":r===2?"Datos Bancarios":"Comprobante"})]}),r<3&&e.jsx("div",{className:"flex-1 h-1 mx-3 rounded-full transition-all",style:{background:u>r?"#17BC91":"#e2e8f0"}})]},r))})}),u===1&&e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/20 rounded-xl p-5 space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-lg",children:e.jsx(se,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"CÃ³mo pagar con Transferencia"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Sigue estos pasos desde tu banco"})]})]}),e.jsx("div",{className:"bg-[#F98613]/5 border border-[#F98613]/30 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-[#F98613] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-[#F98613] mb-1",children:"Â¿QuÃ© es una transferencia bancaria?"}),e.jsx("p",{className:"text-xs text-slate-700 leading-relaxed",children:"Es el envÃ­o de dinero desde tu cuenta bancaria a nuestra cuenta. Puedes hacerlo desde tu app mÃ³vil o banca por internet de forma segura."})]})]})}),e.jsxs("div",{className:"bg-[#17BC91]/5 border border-[#17BC91]/30 rounded-lg p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-[#073372] mb-2",children:"ðŸ“± PreparaciÃ³n:"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["Ten acceso a tu ",e.jsx("span",{className:"font-semibold text-[#073372]",children:"app bancaria o banca por internet"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["Verifica tener saldo disponible de ",e.jsx("span",{className:"font-bold text-[#F98613]",children:T(j)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:"PrepÃ¡rate para capturar el comprobante de confirmaciÃ³n"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-slate-700 leading-relaxed",children:[e.jsx("span",{className:"font-semibold",children:"Siguiente paso:"})," Te mostraremos los datos de nuestra cuenta bancaria para que puedas realizar la transferencia."]})}),e.jsxs("button",{onClick:()=>N(2),className:"w-full py-2.5 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all flex items-center justify-center gap-2",children:["Ver Datos Bancarios",e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),u===2&&c&&e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/20 rounded-xl p-5 space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-lg",children:e.jsx(se,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Datos de nuestra cuenta"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Usa estos datos para transferir"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-[#F98613]/10 to-[#F98613]/5 border border-[#F98613]/30 rounded-lg p-4",children:[e.jsx("p",{className:"text-xs font-medium text-slate-700 mb-1",children:"Monto exacto a transferir:"}),e.jsx("p",{className:"text-2xl font-bold text-[#F98613]",children:T(j)})]}),e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/30 rounded-xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[c.bank_logo_url&&e.jsx("img",{src:c.bank_logo_url,alt:c.bank_name,className:"h-10 object-contain"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-900 text-sm",children:c.bank_name}),c.description&&e.jsx("p",{className:"text-xs text-slate-600",children:c.description})]})]}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs font-medium text-slate-600 mb-1",children:"Titular de la cuenta:"}),e.jsx("p",{className:"text-sm font-bold text-slate-900",children:c.account_holder})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-xs font-medium text-blue-900",children:"NÃºmero de Cuenta:"}),e.jsx("button",{onClick:()=>i(c.account_number,"NÃºmero de cuenta"),className:"p-1.5 hover:bg-blue-100 rounded transition-colors",title:"Copiar",children:e.jsx(ae,{className:"w-4 h-4 text-blue-600"})})]}),e.jsx("p",{className:"text-base font-bold text-blue-700 tracking-wider",children:c.account_number}),e.jsxs("p",{className:"text-xs text-blue-600 mt-1 capitalize",children:["Cuenta ",c.account_type]})]}),e.jsxs("div",{className:"bg-[#17BC91]/10 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("p",{className:"text-xs font-medium text-[#073372]",children:"CCI (Interbancario):"}),e.jsx("button",{onClick:()=>i(c.cci,"CCI"),className:"p-1.5 hover:bg-[#17BC91]/20 rounded transition-colors",title:"Copiar",children:e.jsx(ae,{className:"w-4 h-4 text-[#17BC91]"})})]}),e.jsx("p",{className:"text-base font-bold text-[#073372] tracking-wider",children:c.cci})]})]})]}),e.jsxs("div",{className:"bg-[#17BC91]/5 border border-[#17BC91]/30 rounded-lg p-4 space-y-3",children:[e.jsx("p",{className:"text-sm font-semibold text-[#073372] mb-2",children:"ðŸ“± Pasos para transferir:"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"1"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:"Abre tu app bancaria o banca por internet"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"2"}),e.jsx("p",{className:"text-sm text-slate-700 flex-1",children:'Selecciona "Transferir" y elige el banco destino'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"3"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["Usa los botones ",e.jsx(ae,{className:"w-3 h-3 inline"})," para copiar el nÃºmero de cuenta o CCI"]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#073372] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"4"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:["Ingresa el monto exacto: ",e.jsx("span",{className:"font-bold text-[#F98613]",children:T(j)})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-[#17BC91] text-white rounded-full text-xs font-bold flex-shrink-0 mt-0.5",children:"5"}),e.jsxs("p",{className:"text-sm text-slate-700 flex-1",children:[e.jsx("span",{className:"font-semibold text-[#17BC91]",children:"Â¡Importante!"})," Guarda o captura el comprobante de confirmaciÃ³n"]})]})]}),e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Y,{className:"w-4 h-4 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("p",{className:"text-xs text-slate-700",children:[e.jsx("span",{className:"font-semibold",children:"No cierres tu app bancaria"})," hasta guardar el comprobante. Lo necesitarÃ¡s en el siguiente paso."]})]})}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>N(1),className:"flex-1 py-2.5 border-2 border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors",children:"Volver"}),e.jsx("button",{onClick:()=>N(3),className:"flex-1 py-2.5 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all",children:"Ya transferÃ­"})]})]}),u===3&&e.jsxs("div",{className:"bg-white border-2 border-[#17BC91]/20 rounded-xl p-5 space-y-4 animate-fadeIn",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-3 border-b border-slate-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-[#073372] to-[#17BC91] rounded-lg",children:e.jsx(G,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900",children:"Sube tu comprobante"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Carga la captura del comprobante"})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-xs text-slate-700 leading-relaxed",children:["Sube la captura de pantalla del comprobante de transferencia. SerÃ¡ revisado por nuestro equipo en ",e.jsx("span",{className:"font-semibold text-[#073372]",children:"24-48 horas"}),"."]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:["Comprobante de pago ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:M,className:"hidden",id:"transfer-voucher-upload"}),e.jsx("label",{htmlFor:"transfer-voucher-upload",className:`block w-full px-4 py-6 border-2 border-dashed rounded-lg text-center cursor-pointer transition-all ${v?"border-[#17BC91] bg-[#17BC91]/5":"border-slate-300 hover:border-[#073372] hover:bg-slate-50"}`,children:_?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:_,alt:"Preview",className:"max-h-40 mx-auto rounded-md shadow-md border-2 border-[#17BC91]"}),e.jsx("div",{className:"absolute -top-1 -right-1 p-0.5 bg-[#17BC91] rounded-full",children:e.jsx(te,{className:"w-4 h-4 text-white"})})]}),e.jsx("p",{className:"text-xs text-slate-700 font-medium",children:v?.name}),e.jsx("p",{className:"text-xs text-[#073372]",children:"âœ“ Listo | Click para cambiar"})]}):v?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-2 bg-[#17BC91]/10 rounded-full inline-block",children:e.jsx(G,{className:"w-6 h-6 text-[#17BC91]"})}),e.jsx("p",{className:"text-xs text-slate-900 font-medium",children:v.name}),e.jsx("p",{className:"text-xs text-[#073372]",children:"âœ“ Listo | Click para cambiar"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-full inline-block",children:e.jsx(G,{className:"w-6 h-6 text-slate-400"})}),e.jsx("p",{className:"text-sm text-slate-700 font-medium",children:"Click para subir el comprobante"}),e.jsx("p",{className:"text-xs text-slate-500",children:"PNG, JPG o PDF â€¢ MÃ¡x. 5MB"})]})})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{onClick:()=>N(2),disabled:q,className:"flex-1 py-2.5 border-2 border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors disabled:opacity-50",children:"Volver"}),e.jsx("button",{onClick:B,disabled:q||!v,className:"flex-1 inline-flex items-center justify-center py-2.5 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:q?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),"Confirmar Pago"]})})]})]})]})})]})})},ps=()=>{const[n,t]=l.useState(null),[k,E]=l.useState(!0),[j,u]=l.useState(null),[N,y]=l.useState(!1),[z,c]=l.useState([]),[P,v]=l.useState(!1),[A,_]=l.useState(""),[w,q]=l.useState(null),[S,x]=l.useState(!1),[f,m]=l.useState(!1),[i,M]=l.useState(""),[B,T]=l.useState(!1),[r,a]=l.useState(!1),[g,I]=l.useState(!1),[V,W]=l.useState(!1),[K,O]=l.useState(!1),[F,U]=l.useState(null);l.useEffect(()=>{L(),Q()},[]);const L=async()=>{try{E(!0);const o=(await $.get("/api/student/enrollment")).data.enrollment,b=o.paymentPlan.gracePeriodDays||0;o.installments=o.installments.map(p=>{const D=new Date,R=new Date(D.getFullYear(),D.getMonth(),D.getDate());console.log("ðŸ• Fecha del sistema:",D.toString()),console.log("ðŸ• Fecha local procesada:",R.toString()),console.log("ðŸ• Fecha ISO:",D.toISOString());const[oe,Ne,ye]=p.dueDate.split("-").map(Number),me=new Date(oe,Ne-1,ye),ve=me.getTime()-R.getTime(),he=Math.round(ve/(1e3*60*60*24)),ie=new Date(me);ie.setDate(ie.getDate()+b);const pe=Math.round((ie.getTime()-R.getTime())/(1e3*60*60*24));return console.log("ðŸ“… Cuota #"+p.installmentNumber+":",{hoyLocal:R.toISOString().split("T")[0],fechaVencimiento:p.dueDate,diffDays:he,gracePeriodDays:b,daysUntilGraceLimit:pe}),{...p,daysUntilDue:he,daysUntilGraceLimit:pe,gracePeriodDays:b}}),t(o)}catch(s){console.error("Error fetching enrollment:",s);const o=s;d.error("Error al cargar informaciÃ³n de pagos",{description:o.response?.data?.message||"No se pudo obtener tu cronograma de pagos"})}finally{E(!1)}},Q=async()=>{try{const s=await $.get("/api/student/can-change-plan");if(v(s.data.can_change),s.data.can_change){const o=await $.get("/api/student/available-plans");c(o.data.plans)}}catch(s){console.error("Error checking plan change eligibility:",s)}},C=async()=>{if(!w){d.error("Debes seleccionar un plan");return}try{x(!0),await $.post("/api/student/change-plan",{new_plan_id:w,reason:A||"Cambio solicitado por el estudiante"}),d.success("Plan de pago cambiado exitosamente",{description:"Tu cronograma de pagos ha sido actualizado"}),y(!1),await L(),await Q()}catch(s){const o=s;d.error("Error al cambiar plan de pago",{description:o.response?.data?.message||"No se pudo cambiar el plan"})}finally{x(!1)}},le=async s=>{if(!i||parseFloat(i)<=0){d.error("Ingresa un monto vÃ¡lido");return}if(parseFloat(i)>(n?.totalPending||0)){d.error("Monto invÃ¡lido",{description:`El monto no puede ser mayor a tu deuda pendiente (${h(n?.totalPending||0)})`});return}try{T(!0);const b=new FormData;b.append("voucher_file",s),b.append("declared_amount",i),b.append("payment_date",new Date().toISOString().split("T")[0]),b.append("payment_method","transfer"),b.append("is_partial_payment","1");for(const D of Array.from(b.keys()))console.log("formData key:",D,b.get(D));const p=await $.post("/api/student/upload-voucher",b,{headers:{"Content-Type":"multipart/form-data"}});d.success("Pago parcial procesado exitosamente",{description:`S/ ${p.data.amount_distributed} distribuido a ${p.data.affected_installments} cuota(s)`}),m(!1),M(""),await L()}catch(b){const p=b;d.error("Error al procesar pago parcial",{description:p.response?.data?.message||"No se pudo procesar el pago"})}finally{T(!1)}},J=async(s,o,b)=>{try{u(o);const p=new FormData;p.append("voucher_file",b),p.append("declared_amount",String(n?.installments.find(D=>D.id===o)?.totalDue||n?.installments.find(D=>D.id===o)?.amount||0)),p.append("payment_date",new Date().toISOString().split("T")[0]),p.append("payment_method","transfer"),await $.post(`/api/student/vouchers/${s}/replace`,p,{headers:{"Content-Type":"multipart/form-data"}}),d.success("Voucher reemplazado exitosamente",{description:"El nuevo comprobante estÃ¡ siendo verificado"}),await L()}catch(p){console.error("Error replacing voucher:",p);const D=p;console.error("Server response:",D.response?.data);const R=D.response?.data,oe=R&&typeof R=="object"&&"message"in R?R.message:String(R??"");d.error("Error al reemplazar voucher",{description:oe||"No se pudo reemplazar el comprobante"})}finally{u(null)}},X=s=>{if(s.status==="verified")return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#17BC91]/10 text-[#17BC91] border border-[#17BC91]/30",children:[e.jsx(be,{className:"w-3 h-3 mr-1"}),"Verificado"]});if(s.status==="paid"){if(s.paymentType==="partial"||s.paymentType==="combined"){const D=s.paidAmount||0;return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-300",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Pago Parcial: ",h(D)," de ",h(s.totalDue)]})}return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#073372]/10 text-[#073372] border border-[#073372]/30",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"En VerificaciÃ³n"]})}const o=s.daysUntilDue||0,b=s.daysUntilGraceLimit||0,p=s.gracePeriodDays||0;return o<0&&b>=0&&p>0?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 border border-orange-300",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"PerÃ­odo de Gracia (",b," dÃ­as restantes)"]}):s.isOverdue||b<0&&s.status==="pending"?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 border border-red-300",children:[e.jsx(Y,{className:"w-3 h-3 mr-1"}),"Vencido con Mora (",Math.abs(b)," dÃ­as)"]}):e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#F98613]/10 text-[#F98613] border border-[#F98613]/30",children:[e.jsx(Z,{className:"w-3 h-3 mr-1"}),"Pendiente (",o>0?`${o} dÃ­as`:"Vence hoy",")"]})},h=s=>new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(s),ne=s=>new Date(s).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"});return k?e.jsx(de,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Cargando informaciÃ³n de pagos..."})]})})}):n?e.jsx(de,{children:e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Control de Pagos"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Gestiona tus cuotas y comprobantes de pago"})]}),e.jsxs("div",{className:"flex gap-3",children:[P&&e.jsxs("button",{onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-all shadow-md hover:shadow-lg",children:[e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"Cambiar Plan"]}),e.jsxs("button",{onClick:()=>m(!0),className:"inline-flex items-center px-4 py-2 bg-[#17BC91] hover:bg-[#17BC91]/90 text-white font-medium rounded-lg transition-all shadow-md hover:shadow-lg",children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Pago Parcial"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#073372] to-[#17BC91] text-white rounded-2xl p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ue,{className:"w-8 h-8 opacity-80"}),e.jsx(Se,{className:"w-5 h-5 opacity-60"})]}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total a Pagar"}),e.jsx("p",{className:"text-2xl font-bold",children:h(n.paymentPlan.totalAmount)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(be,{className:"w-8 h-8 text-[#17BC91]"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Pagado"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:h(n.totalPaid)}),e.jsxs("p",{className:"text-xs text-[#17BC91] mt-1",children:[n.paymentProgress.toFixed(0),"% completado"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(Z,{className:"w-8 h-8 text-[#F98613]"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Pendiente"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:h(n.totalPending)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(fe,{className:"w-8 h-8 text-[#073372]"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Plan de Pago"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:[n.paymentPlan.installmentsCount," cuotas"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:n.paymentPlan.name})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Progreso de Pagos"}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[n.paymentProgress.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 h-3 rounded-full transition-all duration-500",style:{width:`${n.paymentProgress}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Cronograma de Cuotas"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Administra tus pagos mensuales y sube tus comprobantes"})]}),e.jsx("div",{className:"divide-y divide-slate-200",children:n.installments.map(s=>e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:["Cuota #",s.installmentNumber]}),X(s)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Fecha de Vencimiento"}),e.jsxs("p",{className:"font-medium text-slate-900 flex items-center",children:[e.jsx(Be,{className:"w-4 h-4 mr-1 text-blue-600"}),ne(s.dueDate)]}),s.daysUntilDue!==void 0&&s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:`text-xs mt-1 ${s.daysUntilDue<7&&s.daysUntilDue>=0?"text-orange-600 font-semibold":s.daysUntilDue<0?"text-red-600":"text-slate-500"}`,children:s.daysUntilDue>0?`Faltan ${s.daysUntilDue} dÃ­as`:s.daysUntilDue===0?"Â¡Vence hoy!":`Vencido hace ${Math.abs(s.daysUntilDue)} dÃ­as`}),s.daysUntilDue<0&&s.daysUntilGraceLimit!==void 0&&s.daysUntilGraceLimit>=0&&s.gracePeriodDays&&s.gracePeriodDays>0&&e.jsxs("p",{className:"text-xs mt-1 text-orange-600 font-semibold bg-orange-50 px-2 py-1 rounded inline-block",children:["âš ï¸ PerÃ­odo de gracia: ",s.daysUntilGraceLimit," dÃ­as restantes"]}),s.daysUntilGraceLimit!==void 0&&s.daysUntilGraceLimit<0&&e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{className:"text-xs text-red-600 font-bold bg-red-50 px-2 py-1 rounded inline-block",children:["ðŸš¨ Mora aplicada (",Math.abs(s.daysUntilGraceLimit)," dÃ­as)"]}),s.lateFee>0&&e.jsxs("p",{className:"text-xs text-red-700 font-bold bg-red-100 px-2 py-1 rounded inline-block",children:["ðŸ’° Recargo por mora: ",h(s.lateFee)]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Monto"}),e.jsx("p",{className:"font-bold text-slate-900",children:h(s.amount)}),s.lateFee>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1 font-semibold",children:["+ ",h(s.lateFee)," mora"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Total a Pagar"}),e.jsx("p",{className:"font-bold text-blue-600",children:h(s.totalDue)}),s.lateFee>0&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"(Incluye mora)"}),(s.paymentType==="partial"||s.paymentType==="combined")&&s.remainingAmount&&s.remainingAmount>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("p",{className:"text-xs text-blue-600 font-semibold",children:["Pagado: ",h(s.paidAmount)]}),e.jsxs("p",{className:"text-xs text-orange-600 font-semibold",children:["Restante: ",h(s.remainingAmount)]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mt-1",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${s.paidAmount/s.totalDue*100}%`}})})]})]}),s.paidDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Fecha de Pago"}),e.jsx("p",{className:"font-medium text-green-600",children:ne(s.paidDate)})]})]})]})}),s.vouchers.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Comprobantes Subidos:"}),s.vouchers.map(o=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(fe,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:h(o.declaredAmount)}),e.jsxs("p",{className:"text-xs text-slate-500",children:[ne(o.paymentDate)," Â· ",o.paymentMethod]}),o.status==="rejected"&&o.rejectionReason&&e.jsxs("p",{className:"text-xs text-red-600 mt-1 italic",children:["Motivo: ",o.rejectionReason]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o.status==="approved"&&e.jsx("span",{className:"text-xs px-3 py-1 bg-green-100 text-green-800 rounded-full font-medium",children:"âœ“ Aprobado"}),o.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full font-medium animate-pulse",children:"â³ En revisiÃ³n"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:b=>{const p=b.target.files?.[0];p&&J(o.id,s.id,p)},disabled:j===s.id,className:"hidden"}),e.jsxs("div",{className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded-lg transition-colors flex items-center space-x-1",children:[e.jsx(G,{className:"w-3 h-3"}),e.jsx("span",{children:"Reemplazar"})]})]})]}),o.status==="rejected"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs px-3 py-1 bg-red-100 text-red-800 rounded-full font-medium",children:"âœ— Rechazado"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:b=>{const p=b.target.files?.[0];p&&J(o.id,s.id,p)},disabled:j===s.id,className:"hidden"}),e.jsxs("div",{className:"px-3 py-1.5 bg-[#17BC91] hover:bg-[#17BC91]/90 text-white text-xs font-medium rounded-lg transition-colors flex items-center space-x-1",children:[e.jsx(G,{className:"w-3 h-3"}),e.jsx("span",{children:"Subir Nuevo"})]})]})]}),e.jsx("a",{href:o.voucherUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-white rounded-lg transition-colors",title:"Descargar voucher",children:e.jsx(Ce,{className:"w-4 h-4 text-blue-600"})})]})]},o.id))]}),(s.status==="pending"||s.status==="late"||s.isOverdue)&&(!s.vouchers.length||s.vouchers.every(o=>o.status==="rejected"))&&e.jsxs("div",{className:"mt-4",children:[s.vouchers.some(o=>o.status==="rejected")&&e.jsx("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800 font-medium flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Tu voucher anterior fue rechazado. Por favor, realiza un nuevo pago."]})}),s.lateFee>0&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-orange-800 font-bold flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Esta cuota tiene mora. Debes pagar el total: ",h(s.totalDue)]}),e.jsxs("p",{className:"text-xs text-orange-700 mt-1",children:["Monto original: ",h(s.amount)," + Mora: ",h(s.lateFee)]})]}),e.jsx("button",{onClick:()=>{U(s),a(!0)},disabled:j===s.id,className:"w-full flex items-center justify-center px-6 py-4 bg-gradient-to-r from-[#073372] to-[#17BC91] hover:from-[#073372]/90 hover:to-[#17BC91]/90 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:j===s.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Procesando..."})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(xe,{className:"w-5 h-5"}),e.jsxs("span",{children:["Pagar ",h(s.totalDue)]})]})})]})]},s.id))})]}),r&&F&&e.jsx(Ie,{isOpen:r,onClose:()=>{a(!1),U(null)},onSelectMethod:s=>{a(!1),s==="card"?I(!0):s==="yape"?W(!0):s==="transfer"&&O(!0)},installmentAmount:F.totalDue}),g&&F&&e.jsx(Ae,{isOpen:g,onClose:()=>{I(!1),U(null)},onSuccess:()=>{L()},installment:{id:Number(F.id),amount:F.totalDue,installment_number:F.installmentNumber}}),V&&F&&e.jsx(Ue,{isOpen:V,onClose:()=>{W(!1),U(null)},onSuccess:()=>{L()},installmentId:F.id,amount:F.totalDue}),K&&F&&e.jsx($e,{isOpen:K,onClose:()=>{O(!1),U(null)},onSuccess:()=>{L()},installmentId:F.id,amount:F.totalDue}),N&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Cambiar Plan de Pago"}),e.jsx("button",{onClick:()=>y(!1),className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(H,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Plan Actual:"}),e.jsx("p",{className:"text-lg font-bold text-blue-700",children:n.paymentPlan.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-600",children:"Total:"}),e.jsx("p",{className:"font-bold text-blue-900",children:h(n.paymentPlan.totalAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-600",children:"Cuotas:"}),e.jsxs("p",{className:"font-bold text-blue-900",children:[n.paymentPlan.installmentsCount," mensuales"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Selecciona tu nuevo plan:"}),e.jsx("div",{className:"space-y-3",children:z.map(s=>e.jsxs("label",{className:`block p-4 border-2 rounded-lg cursor-pointer transition-all ${w===s.id?"border-[#17BC91] bg-[#17BC91]/5":"border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"radio",name:"new_plan",value:s.id,checked:w===s.id,onChange:()=>q(s.id),className:"hidden"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:[s.installmentsCount," cuotas de ",h(s.monthlyAmount)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-slate-600",children:"Total"}),e.jsx("p",{className:"text-lg font-bold text-[#073372]",children:h(s.totalAmount)})]})]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"RazÃ³n del cambio (opcional):"}),e.jsx("textarea",{value:A,onChange:s=>_(s.target.value),placeholder:"Ej: Cambio por disponibilidad econÃ³mica",rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]}),e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-orange-900",children:[e.jsx("strong",{children:"âš ï¸ Importante:"})," Al cambiar de plan, tus cuotas pendientes serÃ¡n canceladas y se generarÃ¡n nuevas segÃºn el plan seleccionado."]})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>y(!1),className:"px-6 py-2 border border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:C,disabled:!w||S,className:"px-6 py-2 bg-[#17BC91] hover:bg-[#17BC91]/90 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:S?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Cambiando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(je,{className:"w-4 h-4 mr-2"}),"Confirmar Cambio"]})})]})]})]})}),f&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-6 py-4 rounded-t-2xl flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Pago Parcial"}),e.jsx("button",{onClick:()=>{m(!1),M("")},className:"text-white/80 hover:text-white transition-colors",children:e.jsx(H,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-slate-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-600",children:"Total del plan:"}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:h(n.paymentPlan.totalAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-600",children:"Pendiente:"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:h(n.totalPending)})]})]})}),e.jsxs("div",{children:[e.jsx("div",{className:"relative",children:e.jsx(ke,{label:"Monto a pagar",type:"number",value:i,onChange:s=>M(s.target.value),placeholder:"0.00",min:.01,max:n.totalPending,step:.01,icon:e.jsx("span",{className:"text-slate-500 font-medium",children:"S/"}),helperText:`Monto mÃ¡ximo: ${h(n.totalPending)}`,variant:"outlined"})}),i&&parseFloat(i)>n.totalPending&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800 font-medium flex items-center",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"El monto ingresado (",h(parseFloat(i)),") excede tu deuda pendiente (",h(n.totalPending),")"]})})]}),i&&parseFloat(i)>0&&parseFloat(i)<=n.totalPending&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-green-900 mb-2",children:"âœ… DistribuciÃ³n automÃ¡tica:"}),e.jsxs("p",{className:"text-xs text-green-700",children:["El monto de ",h(parseFloat(i))," se aplicarÃ¡ a tus cuotas mÃ¡s antiguas primero, cubriendo mora si existe."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Comprobante de pago:"}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:s=>{const o=s.target.files?.[0];o&&le(o)},disabled:B||!i||parseFloat(i)<=0||parseFloat(i)>n.totalPending,className:"hidden",id:"partial-payment-file"}),e.jsx("label",{htmlFor:"partial-payment-file",className:`block w-full px-4 py-3 border-2 border-dashed rounded-lg text-center cursor-pointer transition-all ${B||!i||parseFloat(i)<=0||parseFloat(i)>n.totalPending?"border-slate-200 bg-slate-50 cursor-not-allowed":"border-[#17BC91] hover:bg-[#17BC91]/5"}`,children:B?e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-[#17BC91]",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-[#17BC91]"}),e.jsx("span",{className:"font-medium",children:"Procesando..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-slate-700",children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Seleccionar comprobante"})]})})]})]})]})})]})}):e.jsx(de,{children:e.jsx("div",{className:"p-8 max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-6 text-center",children:[e.jsx(Y,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No tienes matrÃ­cula activa"}),e.jsx("p",{className:"text-slate-600",children:"Contacta con el Ã¡rea de admisiones para mÃ¡s informaciÃ³n."})]})})})};export{ps as default};
