import{r as d,a as b,j as e}from"./app-Bxyh8OL0.js";import{t as o,A as c}from"./AuthenticatedLayout-DhK1QQJ-.js";import{C as j}from"./circle-alert-DMXqQEB2.js";import{D as C}from"./dollar-sign-VbXr_DRo.js";import{c as U}from"./createLucideIcon-CaQHUElT.js";import{C as f}from"./circle-check-big-BvBsdUs_.js";import{C as m}from"./clock-C-aNvNxc.js";import{F as g}from"./video-DQzu31qn.js";import{C as E}from"./calendar-BhRRokpJ.js";import{D as S}from"./download-CAf8myDe.js";import{U as F}from"./upload-C2Utynpe.js";/* empty css            */import"./graduation-cap-D02The6k.js";import"./settings-DzQ4O-6X.js";import"./users-CNbnt6wK.js";import"./credit-card-flBPDk79.js";import"./chart-pie-CDOKF-lC.js";import"./book-open-jkftpfhm.js";import"./index-CRH1Xsgq.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],V=U("TrendingUp",T),_=()=>{const[r,N]=d.useState(null),[y,x]=d.useState(!0),[p,u]=d.useState(null);d.useEffect(()=>{h()},[]);const h=async()=>{try{x(!0);const t=(await b.get("/api/student/enrollment")).data.enrollment;t.installments=t.installments.map(a=>{const i=new Date,D=new Date(a.dueDate).getTime()-i.getTime(),P=Math.ceil(D/(1e3*60*60*24));return{...a,daysUntilDue:P}}),N(t)}catch(s){console.error("Error fetching enrollment:",s),o.error("Error al cargar información de pagos",{description:s.response?.data?.message||"No se pudo obtener tu cronograma de pagos"})}finally{x(!1)}},w=async(s,t)=>{try{u(s);const a=new FormData;a.append("voucher_file",t),a.append("installment_id",s),a.append("declared_amount",String(r?.installments.find(i=>i.id===s)?.amount||0)),a.append("payment_date",new Date().toISOString().split("T")[0]),a.append("payment_method","transfer"),await b.post("/api/student/upload-voucher",a,{headers:{"Content-Type":"multipart/form-data"}}),o.success("Voucher subido exitosamente",{description:"Tu comprobante está siendo verificado por el cajero"}),await h()}catch(a){console.error("Error uploading voucher:",a),o.error("Error al subir voucher",{description:a.response?.data?.message||"No se pudo subir el comprobante"})}finally{u(null)}},v=s=>s.status==="verified"?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Verificado"]}):s.status==="paid"?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(m,{className:"w-3 h-3 mr-1"}),"En Verificación"]}):s.isOverdue?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(j,{className:"w-3 h-3 mr-1"}),"Vencido (",s.daysLate," días)"]}):e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[e.jsx(m,{className:"w-3 h-3 mr-1"}),"Pendiente (",s.daysUntilDue>0?`${s.daysUntilDue} días`:"Hoy",")"]}),l=s=>new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(s),n=s=>new Date(s).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"});return y?e.jsx(c,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Cargando información de pagos..."})]})})}):r?e.jsx(c,{children:e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Control de Pagos"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Gestiona tus cuotas y comprobantes de pago"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-2xl p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(C,{className:"w-8 h-8 opacity-80"}),e.jsx(V,{className:"w-5 h-5 opacity-60"})]}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total a Pagar"}),e.jsx("p",{className:"text-2xl font-bold",children:l(r.paymentPlan.totalAmount)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(f,{className:"w-8 h-8 text-green-600"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Pagado"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l(r.totalPaid)}),e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:[r.paymentProgress.toFixed(0),"% completado"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(m,{className:"w-8 h-8 text-orange-600"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Pendiente"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:l(r.totalPending)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(g,{className:"w-8 h-8 text-violet-600"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Plan de Pago"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:[r.paymentPlan.installmentsCount," cuotas"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:r.paymentPlan.name})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Progreso de Pagos"}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[r.paymentProgress.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 h-3 rounded-full transition-all duration-500",style:{width:`${r.paymentProgress}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Cronograma de Cuotas"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Administra tus pagos mensuales y sube tus comprobantes"})]}),e.jsx("div",{className:"divide-y divide-slate-200",children:r.installments.map(s=>e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:["Cuota #",s.installmentNumber]}),v(s)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Fecha de Vencimiento"}),e.jsxs("p",{className:"font-medium text-slate-900 flex items-center",children:[e.jsx(E,{className:"w-4 h-4 mr-1 text-blue-600"}),n(s.dueDate)]}),s.daysUntilDue!==void 0&&s.status==="pending"&&e.jsx("p",{className:`text-xs mt-1 ${s.daysUntilDue<7?"text-red-600":"text-slate-500"}`,children:s.daysUntilDue>0?`Faltan ${s.daysUntilDue} días`:s.daysUntilDue===0?"¡Vence hoy!":`Vencido hace ${Math.abs(s.daysUntilDue)} días`})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Monto"}),e.jsx("p",{className:"font-bold text-slate-900",children:l(s.amount)}),s.lateFee>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["+ ",l(s.lateFee)," mora"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Total a Pagar"}),e.jsx("p",{className:"font-bold text-blue-600",children:l(s.totalDue)})]}),s.paidDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Fecha de Pago"}),e.jsx("p",{className:"font-medium text-green-600",children:n(s.paidDate)})]})]})]})}),s.vouchers.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Comprobantes Subidos:"}),s.vouchers.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(g,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:l(t.declaredAmount)}),e.jsxs("p",{className:"text-xs text-slate-500",children:[n(t.paymentDate)," · ",t.paymentMethod]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[t.status==="approved"&&e.jsx("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-800 rounded-full",children:"Aprobado"}),t.status==="pending"&&e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-100 text-yellow-800 rounded-full",children:"En revisión"}),t.status==="rejected"&&e.jsx("span",{className:"text-xs px-2 py-1 bg-red-100 text-red-800 rounded-full",children:"Rechazado"}),e.jsx("a",{href:t.voucherUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-white rounded-lg transition-colors",children:e.jsx(S,{className:"w-4 h-4 text-blue-600"})})]})]},t.id))]}),s.status==="pending"&&e.jsx("div",{className:"mt-4",children:e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:t=>{const a=t.target.files?.[0];a&&w(s.id,a)},disabled:p===s.id,className:"hidden"}),e.jsx("div",{className:"flex items-center justify-center px-4 py-3 border-2 border-dashed border-slate-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition-all",children:p===s.id?e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Subiendo..."})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-slate-600",children:[e.jsx(F,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Subir Comprobante de Pago"})]})})]})})]},s.id))})]})]})}):e.jsx(c,{children:e.jsx("div",{className:"p-8 max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-6 text-center",children:[e.jsx(j,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No tienes matrícula activa"}),e.jsx("p",{className:"text-slate-600",children:"Contacta con el área de admisiones para más información."})]})})})};export{_ as default};
