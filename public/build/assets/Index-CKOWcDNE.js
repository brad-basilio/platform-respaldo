import{c as et,r as d,j as t,b as M,L as tt}from"./app-C20PMGFE.js";import{t as c,A as at}from"./AuthenticatedLayout-CoxGlEUd.js";import{I as ve}from"./input-CQC5_gjR.js";import{S as ke}from"./Select2-Do_VG2o3.js";import{B as i}from"./button-A7tge7-D.js";import{B as Be}from"./badge-D6WBSPNm.js";import{D as ze,a as Ae,b as Me,c as Le,d as $e,e as Te}from"./dialog-CMc02ysw.js";import{A as st,t as lt,M as rt,a as it}from"./index.esm-DagJVd-I.js";/* empty css                       */import{C as nt}from"./clock-D2FmpCIh.js";import{E as ct}from"./eye-iMuvIh_1.js";import{P as ot}from"./play-B1OSn-o0.js";import{C as mt}from"./circle-check-big-DzF_ckL0.js";import{F as Ge}from"./film-BO7U_ZcT.js";import{T as dt,P as ht}from"./trash-2-CjwArqpc.js";import{F as ut}from"./filter-ueeFcdAm.js";import{S as ft}from"./search-DjLbsCxw.js";import{L as Ue}from"./link-2-BIm_W3Dm.js";import{C as xt}from"./calendar-BImOY--Y.js";import{U as pt}from"./users-CY4hlQI7.js";/* empty css            */import"./dropdown-menu-CuAekoYv.js";import"./createLucideIcon-CV5nJv-t.js";import"./index-lq6QG8Q8.js";import"./index-FMhRtu3n.js";import"./index-gzDxTBy5.js";import"./file-text-Biy_N_AA.js";import"./triangle-alert-DBZ47Kgx.js";import"./index-CnyDuYXe.js";import"./clsx-B-dksMZM.js";import"./index-DYZNEwUp.js";rt.registerModules([it]);const da=a=>{const e=et.c(101),{scheduledClasses:n,templates:ye,teachers:Ne,filters:qe}=a,[h,He]=d.useState(""),[Se,Ie]=d.useState(qe.status||"all"),[Ce,L]=d.useState(!1),[we,$]=d.useState(!1),[T,De]=d.useState(null);let U;e[0]===Symbol.for("react.memo_cache_sentinel")?(U={class_template_id:"",teacher_id:"",group_id:"",scheduled_at:"",meet_url:"",max_students:6,notes:""},e[0]=U):U=e[0];const[l,o]=d.useState(U),[m,Pe]=d.useState(""),Oe=gt;let B;e[1]===Symbol.for("react.memo_cache_sentinel")?(B=s=>{Ie(s),Oe(s)},e[1]=B):B=e[1];const Qe=B;let G;e[2]!==l?(G=()=>{M.post("/admin/scheduled-classes",l,{onSuccess:()=>{c.success("Clase programada exitosamente"),L(!1),o({class_template_id:"",teacher_id:"",group_id:"",scheduled_at:"",meet_url:"",max_students:6,notes:""})},onError:_t})},e[2]=l,e[3]=G):G=e[3];const Ee=G,Fe=vt;let q;e[4]!==m||e[5]!==T?(q=()=>{!T||!m||M.post(`/admin/scheduled-classes/${T.id}/recording`,{recording_url:m},{onSuccess:()=>{c.success("Grabación agregada exitosamente"),$(!1),Pe(""),De(null)},onError:yt})},e[4]=m,e[5]=T,e[6]=q):q=e[6];const Re=q,Ve=Ct,We=wt,Ze=Et;let H;e[7]===Symbol.for("react.memo_cache_sentinel")?(H={headerName:"Clase",flex:1,minWidth:280,cellRenderer:Rt},e[7]=H):H=e[7];let I,O,Q;e[8]===Symbol.for("react.memo_cache_sentinel")?(I={headerName:"Fecha y Hora",field:"scheduled_at",width:180,sort:"desc",cellRenderer:s=>t.jsxs("div",{className:"flex items-center gap-2 h-full",children:[t.jsx(nt,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm",children:Ze(s.value)})]})},O={headerName:"Profesor",width:150,cellRenderer:kt},Q={headerName:"Alumnos",width:100,cellRenderer:Dt},e[8]=I,e[9]=O,e[10]=Q):(I=e[8],O=e[9],Q=e[10]);let V,W;e[11]===Symbol.for("react.memo_cache_sentinel")?(W={headerName:"Estado",field:"status",width:120,cellRenderer:s=>t.jsx("div",{className:"flex items-center h-full",children:We(s.value)})},V={headerName:"Grabación",width:100,cellRenderer:Pt},e[11]=V,e[12]=W):(V=e[11],W=e[12]);let Z;e[13]===Symbol.for("react.memo_cache_sentinel")?(Z=[H,I,O,Q,W,V,{headerName:"Acciones",width:200,pinned:"right",cellRenderer:s=>{const r=s.data;return t.jsxs("div",{className:"flex items-center gap-1 h-full",children:[t.jsx(tt,{href:`/admin/scheduled-classes/${r.id}`,children:t.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Ver detalles",children:t.jsx(ct,{className:"h-4 w-4"})})}),r.status==="scheduled"&&t.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 text-green-600",title:"Iniciar clase",onClick:()=>Fe(r,"in_progress"),children:t.jsx(ot,{className:"h-4 w-4"})}),r.status==="in_progress"&&t.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 text-blue-600",title:"Marcar completada",onClick:()=>Fe(r,"completed"),children:t.jsx(mt,{className:"h-4 w-4"})}),r.status==="completed"&&!r.recording_url&&t.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 text-purple-600",title:"Agregar grabación",onClick:()=>{De(r),$(!0)},children:t.jsx(Ge,{className:"h-4 w-4"})}),t.jsx(i,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-600",title:"Eliminar",onClick:()=>Ve(r),children:t.jsx(dt,{className:"h-4 w-4"})})]})}}],e[13]=Z):Z=e[13];const Je=Z;let J;e[14]===Symbol.for("react.memo_cache_sentinel")?(J={sortable:!0,resizable:!0},e[14]=J):J=e[14];const Ke=J;let K;e[15]===Symbol.for("react.memo_cache_sentinel")?(K=t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Clases Programadas"}),t.jsx("p",{className:"text-gray-500 mt-1",children:"Gestiona las sesiones de clase programadas"})]}),e[15]=K):K=e[15];let X;e[16]===Symbol.for("react.memo_cache_sentinel")?(X=t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[K,t.jsxs(i,{className:"bg-[#073372] hover:bg-[#052555]",onClick:()=>L(!0),children:[t.jsx(ht,{className:"w-4 h-4 mr-2"}),"Programar Clase"]})]}),e[16]=X):X=e[16];let Y;e[17]===Symbol.for("react.memo_cache_sentinel")?(Y=t.jsxs("div",{className:"flex items-center gap-2 self-center",children:[t.jsx(ut,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Filtros:"})]}),e[17]=Y):Y=e[17];let ee,te;e[18]===Symbol.for("react.memo_cache_sentinel")?(ee=s=>Qe(s),te=[{value:"all",label:"Todos"},{value:"scheduled",label:"Programadas"},{value:"in_progress",label:"En curso"},{value:"completed",label:"Completadas"},{value:"cancelled",label:"Canceladas"}],e[18]=ee,e[19]=te):(ee=e[18],te=e[19]);let u;e[20]!==Se?(u=t.jsx("div",{className:"w-44",children:t.jsx(ke,{label:"Estado",value:Se,onChange:ee,options:te,isSearchable:!1,isClearable:!1})}),e[20]=Se,e[21]=u):u=e[21];let ae,se;e[22]===Symbol.for("react.memo_cache_sentinel")?(ae=s=>He(s.target.value),se=t.jsx(ft,{className:"w-5 h-5"}),e[22]=ae,e[23]=se):(ae=e[22],se=e[23]);let f;e[24]!==h?(f=t.jsx("div",{className:"flex-1 max-w-md ml-auto",children:t.jsx(ve,{label:"Buscar clases",value:h,onChange:ae,icon:se})}),e[24]=h,e[25]=f):f=e[25];let x;e[26]!==u||e[27]!==f?(x=t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4",children:t.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[Y,u,f]})}),e[26]=u,e[27]=f,e[28]=x):x=e[28];let le;e[29]===Symbol.for("react.memo_cache_sentinel")?(le={height:"calc(100vh - 320px)",width:"100%"},e[29]=le):le=e[29];let p;e[30]!==h||e[31]!==n.data?(p=t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:t.jsx("div",{className:"ag-theme-quartz",style:le,children:t.jsx(st,{rowData:n.data,columnDefs:Je,defaultColDef:Ke,quickFilterText:h,pagination:!0,paginationPageSize:20,rowHeight:60,theme:lt,animateRows:!0,suppressCellFocus:!0})})}),e[30]=h,e[31]=n.data,e[32]=p):p=e[32];let g;e[33]!==n.total?(g=t.jsx("div",{className:"mt-4 flex gap-4 text-sm text-gray-500",children:t.jsxs("span",{children:["Total: ",n.total," clases"]})}),e[33]=n.total,e[34]=g):g=e[34];let re;e[35]===Symbol.for("react.memo_cache_sentinel")?(re=t.jsxs(ze,{children:[t.jsx(Ae,{children:"Programar Nueva Clase"}),t.jsx(Me,{children:"Programa una nueva sesión de clase basada en una plantilla"})]}),e[35]=re):re=e[35];const Xe=l.class_template_id;let ie;e[36]===Symbol.for("react.memo_cache_sentinel")?(ie=s=>o(r=>({...r,class_template_id:s})),e[36]=ie):ie=e[36];let _;e[37]!==ye?(_=ye.map(Ft),e[37]=ye,e[38]=_):_=e[38];let b;e[39]!==l.class_template_id||e[40]!==_?(b=t.jsx(ke,{label:"Plantilla de Clase",value:Xe,onChange:ie,options:_,required:!0,placeholder:"Seleccionar plantilla"}),e[39]=l.class_template_id,e[40]=_,e[41]=b):b=e[41];let ne;e[42]===Symbol.for("react.memo_cache_sentinel")?(ne=t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Fecha y Hora *"}),e[42]=ne):ne=e[42];let ce;e[43]===Symbol.for("react.memo_cache_sentinel")?(ce=s=>o(r=>({...r,scheduled_at:s.target.value})),e[43]=ce):ce=e[43];let j;e[44]!==l.scheduled_at?(j=t.jsxs("div",{className:"space-y-2",children:[ne,t.jsx("input",{type:"datetime-local",value:l.scheduled_at,onChange:ce,className:"w-full h-14 px-3 pt-4 pb-1 border border-gray-300 rounded-md text-gray-900 focus:outline-none focus:border-2 focus:border-[#073372] hover:border-gray-900 transition-all duration-200"})]}),e[44]=l.scheduled_at,e[45]=j):j=e[45];const Ye=l.teacher_id;let oe;e[46]===Symbol.for("react.memo_cache_sentinel")?(oe=s=>o(r=>({...r,teacher_id:s})),e[46]=oe):oe=e[46];let v;e[47]!==Ne?(v=Ne.map(zt),e[47]=Ne,e[48]=v):v=e[48];let y;e[49]!==l.teacher_id||e[50]!==v?(y=t.jsx(ke,{label:"Profesor",value:Ye,onChange:oe,options:v,placeholder:"Seleccionar",isClearable:!0}),e[49]=l.teacher_id,e[50]=v,e[51]=y):y=e[51];let me;e[52]===Symbol.for("react.memo_cache_sentinel")?(me=s=>o(r=>({...r,max_students:Number(s.target.value)})),e[52]=me):me=e[52];let N;e[53]!==l.max_students?(N=t.jsx(ve,{label:"Máx. Estudiantes",type:"number",min:1,max:20,value:l.max_students,onChange:me}),e[53]=l.max_students,e[54]=N):N=e[54];let S;e[55]!==y||e[56]!==N?(S=t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[y,N]}),e[55]=y,e[56]=N,e[57]=S):S=e[57];let de,he;e[58]===Symbol.for("react.memo_cache_sentinel")?(de=s=>o(r=>({...r,meet_url:s.target.value})),he=t.jsx(Ue,{className:"w-5 h-5"}),e[58]=de,e[59]=he):(de=e[58],he=e[59]);let C;e[60]!==l.meet_url?(C=t.jsx(ve,{label:"URL de Meet/Zoom",type:"url",value:l.meet_url,onChange:de,icon:he}),e[60]=l.meet_url,e[61]=C):C=e[61];let ue;e[62]===Symbol.for("react.memo_cache_sentinel")?(ue=t.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Notas"}),e[62]=ue):ue=e[62];let fe;e[63]===Symbol.for("react.memo_cache_sentinel")?(fe=s=>o(r=>({...r,notes:s.target.value})),e[63]=fe):fe=e[63];let w;e[64]!==l.notes?(w=t.jsxs("div",{className:"space-y-2",children:[ue,t.jsx("textarea",{value:l.notes,onChange:fe,placeholder:"Notas adicionales...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md text-gray-900 placeholder:text-gray-400 focus:outline-none focus:border-2 focus:border-[#073372] hover:border-gray-900 transition-all duration-200"})]}),e[64]=l.notes,e[65]=w):w=e[65];let E;e[66]!==b||e[67]!==j||e[68]!==S||e[69]!==C||e[70]!==w?(E=t.jsxs("div",{className:"space-y-4 py-4",children:[b,j,S,C,w]}),e[66]=b,e[67]=j,e[68]=S,e[69]=C,e[70]=w,e[71]=E):E=e[71];let xe;e[72]===Symbol.for("react.memo_cache_sentinel")?(xe=t.jsx(i,{variant:"outline",onClick:()=>L(!1),children:"Cancelar"}),e[72]=xe):xe=e[72];let R;e[73]!==Ee?(R=t.jsxs(Le,{children:[xe,t.jsx(i,{onClick:Ee,className:"bg-[#073372] hover:bg-[#052555]",children:"Programar Clase"})]}),e[73]=Ee,e[74]=R):R=e[74];let k;e[75]!==E||e[76]!==R?(k=t.jsxs($e,{className:"max-w-lg",children:[re,E,R]}),e[75]=E,e[76]=R,e[77]=k):k=e[77];let D;e[78]!==Ce||e[79]!==k?(D=t.jsx(Te,{open:Ce,onOpenChange:L,children:k}),e[78]=Ce,e[79]=k,e[80]=D):D=e[80];let pe;e[81]===Symbol.for("react.memo_cache_sentinel")?(pe=t.jsxs(ze,{children:[t.jsx(Ae,{children:"Agregar Grabación"}),t.jsx(Me,{children:"Agrega la URL de la grabación de Google Meet o Drive"})]}),e[81]=pe):pe=e[81];let ge;e[82]===Symbol.for("react.memo_cache_sentinel")?(ge=s=>Pe(s.target.value),e[82]=ge):ge=e[82];let _e;e[83]===Symbol.for("react.memo_cache_sentinel")?(_e=t.jsx(Ue,{className:"w-5 h-5"}),e[83]=_e):_e=e[83];let P;e[84]!==m?(P=t.jsx("div",{className:"space-y-4 py-4",children:t.jsx(ve,{label:"URL de la Grabación",type:"url",value:m,onChange:ge,required:!0,helperText:"Esta grabación reemplazará el video de introducción para los estudiantes inscritos",icon:_e})}),e[84]=m,e[85]=P):P=e[85];let be;e[86]===Symbol.for("react.memo_cache_sentinel")?(be=t.jsx(i,{variant:"outline",onClick:()=>$(!1),children:"Cancelar"}),e[86]=be):be=e[86];let F;e[87]!==Re?(F=t.jsxs(Le,{children:[be,t.jsx(i,{onClick:Re,className:"bg-[#073372] hover:bg-[#052555]",children:"Agregar Grabación"})]}),e[87]=Re,e[88]=F):F=e[88];let z;e[89]!==P||e[90]!==F?(z=t.jsxs($e,{children:[pe,P,F]}),e[89]=P,e[90]=F,e[91]=z):z=e[91];let A;e[92]!==we||e[93]!==z?(A=t.jsx(Te,{open:we,onOpenChange:$,children:z}),e[92]=we,e[93]=z,e[94]=A):A=e[94];let je;return e[95]!==x||e[96]!==p||e[97]!==g||e[98]!==D||e[99]!==A?(je=t.jsx(at,{children:t.jsxs("div",{className:"p-6",children:[X,x,p,g,D,A]})}),e[95]=x,e[96]=p,e[97]=g,e[98]=D,e[99]=A,e[100]=je):je=e[100],je};function gt(a){const e=new URLSearchParams;a&&a!=="all"&&e.set("status",a),M.get(`/admin/scheduled-classes?${e.toString()}`,{},{preserveState:!0,replace:!0})}function _t(){c.error("Error al programar la clase")}function bt(){c.success("Estado actualizado")}function jt(){c.error("Error al actualizar estado")}function vt(a,e){M.put(`/admin/scheduled-classes/${a.id}/status`,{status:e},{onSuccess:bt,onError:jt})}function yt(){c.error("Error al agregar grabación")}function Nt(){c.success("Clase eliminada")}function St(){c.error("Error al eliminar clase")}function Ct(a){if(a.enrollments_count>0){c.error("No se puede eliminar",{description:"Esta clase tiene estudiantes inscritos"});return}confirm("¿Estás seguro de eliminar esta clase programada?")&&M.delete(`/admin/scheduled-classes/${a.id}`,{onSuccess:Nt,onError:St})}function wt(a){const e={scheduled:{variant:"outline",label:"Programada"},in_progress:{variant:"default",label:"En curso"},completed:{variant:"secondary",label:"Completada"},cancelled:{variant:"destructive",label:"Cancelada"}},n=e[a]||e.scheduled;return t.jsx(Be,{variant:n.variant,children:n.label})}function Et(a){return new Date(a).toLocaleDateString("es-PE",{weekday:"short",day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})}function Rt(a){const e=a.data;return t.jsxs("div",{className:"flex items-center gap-3 py-2 h-full",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",style:{backgroundColor:e.template?.academic_level?.color||"#3B82F6"},children:t.jsx(xt,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.template?.title}),t.jsxs("div",{className:"text-xs text-gray-500",children:[e.template?.academic_level?.name," • S",e.template?.session_number]})]})]})}function kt(a){const e=a.data;return t.jsx("div",{className:"flex items-center h-full",children:t.jsx("span",{className:"text-sm text-gray-600",children:e.teacher?.name||t.jsx("span",{className:"text-gray-400",children:"Sin asignar"})})})}function Dt(a){const e=a.data;return t.jsxs("div",{className:"flex items-center gap-2 h-full",children:[t.jsx(pt,{className:"w-4 h-4 text-gray-400"}),t.jsxs("span",{className:`text-sm ${e.enrollments_count>=e.max_students?"text-red-600 font-medium":""}`,children:[e.enrollments_count,"/",e.max_students]})]})}function Pt(a){const e=a.data;return t.jsx("div",{className:"flex items-center h-full",children:e.recording_url?t.jsxs(Be,{variant:"outline",className:"text-green-600",children:[t.jsx(Ge,{className:"w-3 h-3 mr-1"}),"Sí"]}):t.jsx("span",{className:"text-xs text-gray-400",children:"No"})})}function Ft(a){return{value:String(a.id),label:`${a.academic_level.name} - S${a.session_number}: ${a.title}`}}function zt(a){return{value:String(a.id),label:a.name}}export{da as default};
