import{r as n,a as L,j as e,H as Ve,L as Ue,b as ye}from"./app-Cfyhsxht.js";import{A as qe,F as q,D as Oe,C as Ge,t as _}from"./AuthenticatedLayout-Dj17dz-p.js";import{B as c}from"./button-ZKxXViWz.js";import{T as K}from"./textarea-DEhfs-Oc.js";import{B as E}from"./badge-BLod1Xc0.js";import{P as Qe}from"./progress-BDB6NR7O.js";import{A as Ye}from"./arrow-left-CY7S3OJD.js";import{P as ee}from"./play-DhiopfPJ.js";import{V as We}from"./video-Bmak_coq.js";import{F as we}from"./film-Anyr0KgH.js";import{C as de}from"./clock-DF0U2L8u.js";import{F as b}from"./file-question-fOGa2ThC.js";import{c as Se}from"./createLucideIcon-B282NP-J.js";import{T as Xe}from"./target-DMrCa9ZO.js";import{B as Ze}from"./book-open-DPysh_-N.js";import{C as y}from"./circle-check-big-DgHgvXFW.js";import{A as oe}from"./award-Cb3j59NO.js";import{E as O}from"./eye-Cttw9wtY.js";import{L as me}from"./lock-BiCRHWjQ.js";import{E as Je}from"./external-link-DsEj-BbO.js";import{G as Ke}from"./graduation-cap-BLiw3JTV.js";import{U as se}from"./users-BCrIhPOR.js";import{C as $}from"./calendar-B0hsJhmR.js";import{S as Ce}from"./send-CMDCsJ0o.js";import{U as es}from"./user-plus-CkucKSo6.js";import{P as ss}from"./plus-gjOgJDXF.js";import{X as _e}from"./x-B2p3vTuZ.js";import{L as xe}from"./loader-circle-ZMfIemWY.js";import{C as as}from"./chevron-right-CdKmzpUd.js";import{L as ts,I as rs}from"./link-BKdIWBJ9.js";/* empty css            */import"./dropdown-menu-DPcp8apS.js";import"./index-BqFrHW47.js";import"./index-C6thcnQc.js";import"./index-BHS6CGCm.js";import"./triangle-alert-Dm1jxi9x.js";import"./clsx-B-dksMZM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ls=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],is=Se("ChevronLeft",ls);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],cs=Se("Sparkles",ns),Qs=({template:a,existingRequest:j,enrollment:o,studentInfo:he})=>{const x=o?.scheduled_class||null,ae=!!x,T=x?.status==="completed",[A,I]=n.useState(!1),[z,P]=n.useState(""),[G,ue]=n.useState(!1),[w,ke]=n.useState(null),[S,Q]=n.useState([]),[te,Y]=n.useState(!1),[m,N]=n.useState(null),[H,Be]=n.useState(null),[g,R]=n.useState(""),[Fe,M]=n.useState(!1),[p,Ee]=n.useState([]),[$e,ge]=n.useState(!1),[v,W]=n.useState(0),[C,pe]=n.useState({}),[be,re]=n.useState(!1),[r,X]=n.useState(null),[Pe,V]=n.useState(!1),[Me,je]=n.useState(!1),[l,De]=n.useState(null),le=he?.studentType??"regular",ie=he?.isVerified??!1,k=le==="regular"&&ie,B=le==="daily"&&ie,F=le==="weekly"&&ie;n.useEffect(()=>{(k||B||F)&&L.get("/api/student/class-config").then(s=>ke(s.data)).catch(s=>console.error("Error loading class config:",s))},[k,B,F]);const D=n.useMemo(()=>{if(!w)return null;const s=new Date,{min_advance_hours:t,operation_start_hour:i,operation_end_hour:d}=w;let h=s.getHours()+t;s.getMinutes()>0&&(h+=1);const u=new Date(s);return u.setHours(h,0,0,0),u.getHours()>=d&&(u.setDate(u.getDate()+1),u.setHours(i,0,0,0)),u.getHours()<i&&u.setHours(i,0,0,0),u},[w]),U=s=>{const t=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0"),h=String(s.getHours()).padStart(2,"0"),u=String(s.getMinutes()).padStart(2,"0"),ce=String(s.getSeconds()).padStart(2,"0");return`${t}-${i}-${d}T${h}:${u}:${ce}`};n.useEffect(()=>{A&&k&&D&&(Y(!0),N(null),L.get(`/api/student/available-classes/${a.id}`,{params:{datetime:U(D)}}).then(s=>{Q(s.data.classes||[])}).catch(s=>{console.error("Error loading available classes:",s),Q([])}).finally(()=>Y(!1)))},[A,k,D,a.id]),n.useEffect(()=>{A&&(B||F)&&g&&(Y(!0),N(null),L.get(`/api/student/available-classes/${a.id}`,{params:{datetime:g}}).then(s=>{Q(s.data.classes||[])}).catch(s=>{console.error("Error loading available classes:",s),Q([])}).finally(()=>Y(!1)))},[A,B,F,g,a.id]),n.useEffect(()=>{D&&Be(D)},[D]);const Le=()=>{if(j||x)return;ue(!0);let s=null,t=null;k?m?(s=S.find(h=>h.id===m)?.scheduled_at||null,t=m):H&&(s=U(H)):B||F?g&&(s=g,m&&(t=m)):g&&(s=g);const i={class_template_id:a.id,message:z.trim()||null,requested_datetime:s,target_scheduled_class_id:t};ye.post("/student/class-requests",i,{onSuccess:()=>{t?_.success("¬°Te has inscrito exitosamente en el grupo!"):_.success("¬°Solicitud enviada! Te notificaremos cuando sea procesada."),I(!1),P(""),N(null),R("")},onError:d=>{const h=Object.values(d)[0]||"Error al enviar la solicitud";_.error(h),ue(!1)}})},Te=s=>s.toLocaleString("es-PE",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"}),Z=async()=>{if(o){ge(!0),M(!0),pe({}),W(0),X(null);try{const s=await L.get(`/api/student/class-enrollments/${o.id}/exam-questions`);Ee(s.data.questions)}catch(s){const t=s;_.error(t.response?.data?.error||"Error al cargar el examen"),M(!1)}finally{ge(!1)}}},Ae=(s,t)=>{pe(i=>({...i,[s]:t}))},Ie=async()=>{if(!o||p.length===0)return;re(!0);const s=p.map((t,i)=>({question_id:t.id,answer:C[i]||null}));try{const t=await L.post(`/student/class-enrollments/${o.id}/submit-exam`,{answers:s});X(t.data),re(!1),t.data.passed?_.success("¬°Felicitaciones! Has aprobado la evaluaci√≥n."):_.error("No alcanzaste el puntaje m√≠nimo. Puedes intentar de nuevo.")}catch(t){const i=t;_.error(i.response?.data?.message||"Error al enviar el examen"),re(!1)}},fe=()=>{M(!1),X(null),ye.reload()},ne=async()=>{if(o){je(!0),V(!0);try{const s=await L.get(`/api/student/class-enrollments/${o.id}/exam-results`);De(s.data)}catch(s){const t=s;_.error(t.response?.data?.error||"Error al cargar los resultados"),V(!1)}finally{je(!1)}}},ze=p.length>0?Math.round(Object.keys(C).length/p.length*100):0,f=x?{type:"enrolled",color:"bg-[#17BC91]",textColor:"text-[#17BC91]",bgColor:"bg-[#17BC91]/10",borderColor:"border-[#17BC91]/30",label:"Inscrito",description:`Clase programada para el ${new Date(x.scheduled_at).toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})}`}:j?{type:"requested",...{pending:{color:"bg-[#F98613]",textColor:"text-[#F98613]",bgColor:"bg-[#F98613]/10",borderColor:"border-[#F98613]/30",label:"Solicitud Pendiente",description:"Tu solicitud est√° siendo revisada por el equipo acad√©mico"},approved:{color:"bg-[#17BC91]",textColor:"text-[#17BC91]",bgColor:"bg-[#17BC91]/10",borderColor:"border-[#17BC91]/30",label:"Solicitud Aprobada",description:"Tu solicitud fue aprobada. Pronto te asignar√°n una clase"},scheduled:{color:"bg-[#17BC91]",textColor:"text-[#17BC91]",bgColor:"bg-[#17BC91]/10",borderColor:"border-[#17BC91]/30",label:"Clase Programada",description:j.scheduled_class?`Tu clase est√° programada para el ${new Date(j.scheduled_class.scheduled_at).toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",hour:"2-digit",minute:"2-digit"})}${j.scheduled_class.teacher?` con ${j.scheduled_class.teacher.name}`:""}`:"Ya tienes una clase asignada"},rejected:{color:"bg-red-500",textColor:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",label:"Solicitud Rechazada",description:j.admin_response||"Tu solicitud no fue aprobada"}}[j.status]}:{type:"available",color:"bg-gray-400",textColor:"text-gray-700",bgColor:"bg-gray-50",borderColor:"border-gray-200",label:"Disponible",description:"Puedes solicitar esta clase"},J=ae,He=s=>{if(!s)return null;const t=s.match(/(?:youtube\.com\/(?:watch\?v=|embed\/)|youtu\.be\/)([a-zA-Z0-9_-]{11})/);if(t)return`https://www.youtube.com/embed/${t[1]}`;const i=s.match(/vimeo\.com\/(\d+)/);return i?`https://player.vimeo.com/video/${i[1]}`:s},Ne=T&&x?.recording_url?x.recording_url:a.intro_video_url,ve=Ne?He(Ne):null,Re=T&&!!x?.recording_url;return e.jsxs(qe,{children:[e.jsx(Ve,{title:a.title}),e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs(Ue,{href:"/student/my-classes",className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(Ye,{className:"w-5 h-5"}),e.jsx("span",{children:"Volver a mis clases"})]})})}),e.jsx("div",{className:"bg-white",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-8",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"relative aspect-video bg-gray-900 rounded-2xl overflow-hidden shadow-lg",children:[ve?e.jsx("iframe",{src:ve,className:"absolute inset-0 w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0}):a.intro_video_thumbnail?e.jsxs("div",{className:"relative w-full h-full",children:[e.jsx("img",{src:a.intro_video_thumbnail,alt:a.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/90 flex items-center justify-center",children:e.jsx(ee,{className:"w-10 h-10 text-gray-800 ml-1"})})})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-500",children:[e.jsx(We,{className:"w-16 h-16 mb-3 opacity-50"}),e.jsx("span",{className:"text-sm",children:"Video de introducci√≥n no disponible"})]}),Re&&e.jsx("div",{className:"absolute top-4 left-4",children:e.jsxs(E,{className:"bg-red-600 text-white border-0",children:[e.jsx(we,{className:"w-3 h-3 mr-1"}),"Grabaci√≥n de la clase"]})})]})}),e.jsxs("div",{className:"lg:col-span-2 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(E,{style:{backgroundColor:a.academic_level?.color||"#3B82F6"},className:"text-white border-0",children:a.academic_level?.name}),e.jsxs(E,{variant:"outline",children:["Sesi√≥n ",a.session_number]}),a.modality&&e.jsx(E,{variant:"outline",className:"capitalize",children:a.modality==="theoretical"?"Te√≥rico":"Pr√°ctico"})]}),e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-3",children:a.title}),a.description&&e.jsx("p",{className:"text-gray-600 mb-4 leading-relaxed",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 text-sm mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-[#073372]/5 px-3 py-1.5 rounded-full",children:[e.jsx(de,{className:"w-4 h-4 text-[#073372]"}),e.jsxs("span",{className:"text-[#073372] font-medium",children:[a.duration_minutes," min"]})]}),a.has_exam&&e.jsxs("div",{className:"flex items-center gap-2 bg-[#F98613]/10 px-3 py-1.5 rounded-full",children:[e.jsx(b,{className:"w-4 h-4 text-[#F98613]"}),e.jsxs("span",{className:"text-[#F98613] font-medium",children:[a.exam_questions_count," preguntas"]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-[#17BC91]/10 px-3 py-1.5 rounded-full",children:[e.jsx(q,{className:"w-4 h-4 text-[#17BC91]"}),e.jsxs("span",{className:"text-[#17BC91] font-medium",children:[a.resources.length," recursos"]})]})]}),e.jsxs("div",{className:`rounded-xl p-4 ${f.bgColor} border ${f.borderColor} mb-4`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full ${f.color}`}),e.jsx("span",{className:`font-semibold ${f.textColor}`,children:f.label})]}),e.jsx("p",{className:`text-sm ${f.textColor} opacity-80`,children:f.description})]}),e.jsxs("div",{className:"mt-auto",children:[f.type==="available"&&e.jsxs(c,{className:"w-full bg-[#073372] hover:bg-[#052555] text-white h-12 text-base",onClick:()=>I(!0),children:[e.jsx(cs,{className:"w-5 h-5 mr-2"}),"Solicitar esta Clase"]}),f.type==="enrolled"&&x?.meet_url&&!T&&e.jsx("a",{href:x.meet_url,target:"_blank",rel:"noopener noreferrer",className:"block w-full",children:e.jsxs(c,{className:"w-full bg-green-600 hover:bg-green-700 h-12 text-base",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Entrar a la clase"]})}),f.type==="requested"&&j?.status==="scheduled"&&j?.scheduled_class?.meet_url&&e.jsx("a",{href:j.scheduled_class.meet_url,target:"_blank",rel:"noopener noreferrer",className:"block w-full",children:e.jsxs(c,{className:"w-full bg-green-600 hover:bg-green-700 h-12 text-base",children:[e.jsx(ee,{className:"w-5 h-5 mr-2"}),"Entrar a la clase"]})}),f.type==="requested"&&j?.status==="rejected"&&e.jsx(c,{variant:"outline",className:"w-full h-12 text-base",onClick:()=>I(!0),children:"Volver a solicitar"})]})]})]})})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.objectives&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#073372]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#073372] rounded-lg flex items-center justify-center",children:e.jsx(Xe,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Objetivos de Aprendizaje"})]})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"rich-content text-gray-900 max-w-none whitespace-pre-line",children:a.objectives})})]}),a.content&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#17BC91]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#17BC91] rounded-lg flex items-center justify-center",children:e.jsx(Ze,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contenido de la Clase"})]})}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"rich-content max-w-none",dangerouslySetInnerHTML:{__html:a.content}})})]}),a.has_exam&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#F98613]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#F98613] rounded-lg flex items-center justify-center",children:e.jsx(b,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Examen de Evaluaci√≥n"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Eval√∫a tu comprensi√≥n del tema"})]})]}),J&&o?.exam_completed&&e.jsxs(E,{className:"bg-emerald-500 text-white",children:[e.jsx(y,{className:"w-3.5 h-3.5 mr-1"}),"Completado"]})]})}),e.jsx("div",{className:"p-6",children:J?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-[#073372]/5 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#073372] rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(b,{className:"w-6 h-6 text-white"})}),e.jsx("p",{className:"text-2xl font-bold text-[#073372]",children:a.exam_questions_count}),e.jsx("p",{className:"text-xs text-gray-500",children:"Preguntas"})]}),e.jsxs("div",{className:"bg-[#17BC91]/5 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#17BC91] rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(oe,{className:"w-6 h-6 text-white"})}),e.jsxs("p",{className:"text-2xl font-bold text-[#17BC91]",children:[a.exam_passing_score,"%"]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Para aprobar"})]}),e.jsxs("div",{className:"bg-[#F98613]/5 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-[#F98613] rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(de,{className:"w-6 h-6 text-white"})}),e.jsxs("p",{className:"text-2xl font-bold text-[#F98613]",children:["~",Math.ceil(a.exam_questions_count*1.5)]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Minutos aprox."})]})]}),o?.exam_completed?e.jsx("div",{className:"bg-emerald-50 border border-emerald-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-500 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-emerald-800",children:"¬°Examen aprobado!"}),e.jsxs("p",{className:"text-sm text-emerald-600",children:["Tu puntuaci√≥n: ",o.latest_exam_percentage??o.exam_score,"%",o.exam_attempts_count&&o.exam_attempts_count>1&&e.jsxs("span",{className:"text-emerald-500 ml-2",children:["(",o.exam_attempts_count," intentos)"]})]})]})]}),e.jsxs(c,{variant:"outline",className:"border-emerald-300 text-emerald-700 hover:bg-emerald-100",onClick:ne,children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Ver examen"]})]})}):o?.exam_attempts_count&&o.exam_attempts_count>0?(()=>{const s=a.exam_max_attempts??3,t=o.exam_attempts_count,i=s-t,d=i<=0;return e.jsx("div",{className:`${d?"bg-red-50 border-red-200":"bg-amber-50 border-amber-200"} border rounded-xl p-4`,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-10 h-10 ${d?"bg-red-500":"bg-amber-500"} rounded-full flex items-center justify-center flex-shrink-0`,children:e.jsx(b,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:`font-semibold ${d?"text-red-800":"text-amber-800"}`,children:d?"Sin intentos restantes":"Examen no aprobado a√∫n"}),e.jsxs("p",{className:`text-sm ${d?"text-red-600":"text-amber-600"}`,children:["√öltimo intento: ",o.latest_exam_percentage,"%",e.jsxs("span",{className:`ml-1 ${d?"text-red-500":"text-amber-500"}`,children:["(m√≠nimo: ",a.exam_passing_score,"%)"]})]}),e.jsxs("p",{className:`text-xs mt-1 ${d?"text-red-500":"text-amber-500"}`,children:[t," de ",s," intento",s!==1?"s":""," usado",t!==1?"s":"",!d&&e.jsxs("span",{className:"font-medium ml-1",children:["‚Ä¢ ",i," restante",i!==1?"s":""]})]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[e.jsxs(c,{variant:"outline",className:`${d?"border-red-300 text-red-700 hover:bg-red-100":"border-amber-300 text-amber-700 hover:bg-amber-100"}`,onClick:ne,children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Ver mi examen"]}),!d&&e.jsxs(c,{className:"bg-[#F98613] hover:bg-[#d96f0a] text-white",onClick:Z,children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Intentar de nuevo"]})]})]})})})():e.jsx("div",{className:"bg-gradient-to-r from-[#F98613]/10 to-[#F98613]/5 border border-[#F98613]/20 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"¬øListo para el examen?"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Pon a prueba lo que has aprendido"})]}),e.jsxs(c,{className:"bg-[#F98613] hover:bg-[#d96f0a] text-white",onClick:Z,children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Iniciar Examen"]})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(me,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-1",children:"Examen bloqueado"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Inscr√≠bete en la clase para acceder al examen"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-100 bg-gradient-to-r from-[#17BC91]/5 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-[#17BC91] rounded-lg flex items-center justify-center",children:e.jsx(q,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recursos de la Clase"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.resources.length," materiales disponibles"]})]})]}),!J&&e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(me,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Bloqueado"})]})]})}),J?e.jsx("div",{className:"p-6",children:a.resources.length>0?e.jsx("div",{className:"space-y-3",children:a.resources.map(s=>{const t=()=>{switch(s.file_type){case"video":return e.jsx(we,{className:"w-5 h-5"});case"pdf":return e.jsx(q,{className:"w-5 h-5"});case"image":return e.jsx(rs,{className:"w-5 h-5"});case"link":return e.jsx(ts,{className:"w-5 h-5"});default:return e.jsx(q,{className:"w-5 h-5"})}},i=()=>{switch(s.file_type){case"video":return"bg-red-500";case"pdf":return"bg-red-600";case"image":return"bg-blue-500";case"link":return"bg-[#17BC91]";default:return"bg-gray-500"}};return e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-xl border border-gray-200 hover:border-[#17BC91]/50 hover:shadow-md transition-all duration-200 group cursor-pointer",children:[e.jsx("div",{className:`w-12 h-12 ${i()} rounded-xl flex items-center justify-center flex-shrink-0 text-white`,children:t()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 group-hover:text-[#073372] transition-colors",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-500 line-clamp-1",children:s.description}),e.jsx("p",{className:"text-xs text-gray-400 capitalize mt-1",children:s.file_type})]}),e.jsx(c,{size:"sm",variant:"ghost",className:"opacity-0 group-hover:opacity-100 transition-opacity text-[#17BC91] hover:text-[#14a77f] hover:bg-[#17BC91]/10",children:s.file_type==="link"?e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-4 h-4 mr-1"}),"Abrir"]}):e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"w-4 h-4 mr-1"}),"Descargar"]})})]},s.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(q,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500",children:"No hay recursos disponibles para esta clase"})]})}):e.jsxs("div",{className:"px-6 py-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(me,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 font-medium mb-1",children:"Contenido bloqueado"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Solicita esta clase para acceder a los recursos"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5 text-[#073372]"}),"Informaci√≥n de la Clase"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Nivel"}),e.jsx(E,{style:{backgroundColor:a.academic_level?.color||"#3B82F6"},className:"text-white border-0",children:a.academic_level?.name})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Sesi√≥n"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.session_number})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Modalidad"}),e.jsx("span",{className:"font-medium text-gray-900 capitalize",children:a.modality==="theoretical"?"Te√≥rico":a.modality==="practical"?"Pr√°ctico":"-"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Duraci√≥n"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[a.duration_minutes," min"]})]}),a.has_exam&&e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Examen"}),e.jsxs(E,{className:"bg-[#F98613] text-white border-0",children:[a.exam_questions_count," preguntas"]})]}),e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsx("span",{className:"text-gray-500 text-sm",children:"Recursos"}),e.jsx("span",{className:"font-medium text-gray-900",children:a.resources.length})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-[#073372]/5 via-white to-[#17BC91]/5 rounded-xl border border-[#073372]/10 p-6",children:[e.jsx("h3",{className:"font-semibold text-[#073372] mb-3 flex items-center gap-2",children:"üí° Consejos para la clase"}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"Revisa los objetivos antes de la clase"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"Prepara vocabulario relacionado al tema"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"No tengas miedo de cometer errores"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx(y,{className:"w-4 h-4 mt-0.5 text-[#17BC91] flex-shrink-0"}),e.jsx("span",{children:"Participa activamente en las discusiones"})]})]})]}),ae&&x?.teacher&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-[#073372]"}),"Tu Instructor"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-[#073372] to-[#17BC91] flex items-center justify-center text-white font-bold",children:x.teacher.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:x.teacher.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Instructor"})]})]})]}),ae&&x&&e.jsxs("div",{className:"bg-gradient-to-br from-[#17BC91]/10 to-[#17BC91]/5 rounded-xl border border-[#17BC91]/20 p-6",children:[e.jsxs("h3",{className:"font-semibold text-[#17BC91] mb-3 flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5"}),T?"Clase Completada":"Clase Programada"]}),e.jsx("p",{className:"text-gray-800 font-medium",children:new Date(x.scheduled_at).toLocaleDateString("es-PE",{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}),x.meet_url&&!T&&e.jsx("a",{href:x.meet_url,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-block",children:e.jsxs(c,{size:"sm",className:"bg-[#17BC91] hover:bg-[#14a77f] text-white",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Entrar a clase"]})})]})]})]})})]}),e.jsx("style",{children:`
        .rich-content h1 { 
          font-size: 1.75rem; 
          font-weight: 700; 
          margin: 1.5rem 0 0.75rem; 
          line-height: 1.2;
          color: #111827;
        }
        .rich-content h2 { 
          font-size: 1.375rem; 
          font-weight: 600; 
          margin: 1.25rem 0 0.5rem; 
          line-height: 1.3;
          color: #1f2937;
        }
        .rich-content h3 { 
          font-size: 1.125rem; 
          font-weight: 600; 
          margin: 1rem 0 0.5rem;
          color: #374151;
        }
        .rich-content p {
          margin: 0.5rem 0;
          line-height: 1.6;
          color: #374151;
        }
        .rich-content ul, .rich-content ol { 
          padding-left: 1.5rem; 
          margin: 0.75rem 0; 
        }
        .rich-content li { 
          margin: 0.25rem 0;
          line-height: 1.6;
        }
        .rich-content ul { list-style-type: disc; }
        .rich-content ol { list-style-type: decimal; }
        .rich-content blockquote { 
          border-left: 4px solid #e5e7eb; 
          padding-left: 1rem; 
          margin: 1rem 0;
          color: #6b7280;
          font-style: italic;
        }
        .rich-content pre {
          background: #1f2937;
          color: #e5e7eb;
          padding: 1rem;
          border-radius: 0.5rem;
          font-family: 'Fira Code', 'Monaco', monospace;
          overflow-x: auto;
          margin: 1rem 0;
        }
        .rich-content code {
          background: #f3f4f6;
          padding: 0.125rem 0.25rem;
          border-radius: 0.25rem;
          font-family: 'Fira Code', 'Monaco', monospace;
          font-size: 0.875em;
        }
        .rich-content pre code {
          background: none;
          padding: 0;
          color: inherit;
        }
        .rich-content img {
          max-width: 100%;
          height: auto;
          border-radius: 0.5rem;
          margin: 1rem 0;
        }
        .rich-content a {
          color: #073372;
          text-decoration: underline;
          cursor: pointer;
        }
        .rich-content a:hover {
          color: #17BC91;
        }
        .rich-content hr {
          border: none;
          border-top: 2px solid #e5e7eb;
          margin: 1.5rem 0;
        }
        .rich-content strong {
          font-weight: 600;
        }
        .rich-content em {
          font-style: italic;
        }
        .rich-content u {
          text-decoration: underline;
        }
        /* Text alignment */
        .rich-content [style*="text-align: center"] {
          text-align: center;
        }
        .rich-content [style*="text-align: right"] {
          text-align: right;
        }
        .rich-content [style*="text-align: left"] {
          text-align: left;
        }
      `}),A&&e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>!G&&I(!1),children:e.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl w-full max-w-lg",onClick:s=>s.stopPropagation(),children:[e.jsx("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] px-6 py-5 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(Ce,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Solicitar Clase"}),e.jsx("p",{className:"text-blue-100 text-sm",children:a.title})]})]})}),e.jsx("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:k?e.jsxs(e.Fragment,{children:[H&&e.jsxs("div",{className:"bg-[#073372]/5 border border-[#073372]/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#073372] mb-2",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Tu pr√≥ximo horario disponible"})]}),e.jsx("p",{className:"text-[#073372] font-medium capitalize",children:Te(H)}),e.jsxs("p",{className:"text-sm text-[#073372]/70 mt-1",children:["Las clases deben solicitarse con al menos ",w?.min_advance_hours||1," hora(s) de anticipaci√≥n"]})]}),te?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"w-8 h-8 border-3 border-[#073372]/30 border-t-[#073372] rounded-full animate-spin"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Buscando clases disponibles..."})]}):S.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-700 font-medium flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-[#17BC91]"}),"Grupos disponibles para este horario:"]}),S.map(s=>e.jsxs("div",{onClick:()=>N(s.id===m?null:s.id),className:`p-4 rounded-xl border-2 cursor-pointer transition-all ${m===s.id?"border-[#17BC91] bg-[#17BC91]/5":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${m===s.id?"bg-[#17BC91] text-white":"bg-gray-100 text-gray-600"}`,children:e.jsx(es,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.teacher?.name||"Instructor por asignar"}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.scheduled_at).toLocaleTimeString("es-PE",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${s.available_spots<=2?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[s.enrolled_count,"/",s.max_students," aprendices"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.available_spots," cupo",s.available_spots!==1?"s":""," disponible",s.available_spots!==1?"s":""]})]})]}),m===s.id&&e.jsx("div",{className:"mt-3 pt-3 border-t border-[#17BC91]/20",children:e.jsxs("p",{className:"text-sm text-[#17BC91] flex items-center gap-1",children:[e.jsx(y,{className:"w-4 h-4"}),"Solicitar unirse a este grupo"]})})]},s.id)),e.jsx("div",{className:"pt-2 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>N(null),className:`w-full p-4 rounded-xl border-2 transition-all flex items-center gap-3 ${m===null?"border-[#073372] bg-[#073372]/5":"border-dashed border-gray-300 hover:border-gray-400"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${m===null?"bg-[#073372] text-white":"bg-gray-100 text-gray-600"}`,children:e.jsx(ss,{className:"w-5 h-5"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Solicitar nueva clase"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Se crear√° un nuevo grupo para este horario"})]})]})})]}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx($,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-700 font-medium",children:"No hay grupos disponibles"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Se solicitar√° crear una nueva clase para este horario"})]}),e.jsx(K,{label:"Mensaje (opcional)",value:z,onChange:s=>P(s.target.value),placeholder:"¬øTienes alg√∫n comentario adicional?",rows:2})]}):B?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-[#17BC91]/5 border border-[#17BC91]/20 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#17BC91] mb-2",children:[e.jsx(de,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Plan Diario"})]}),e.jsx("p",{className:"text-sm text-[#17BC91]/80",children:"Puedes elegir cualquier hora disponible para hoy. La clase debe ser al menos 30 minutos en el futuro."})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-gray-700 mb-3",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Selecciona la hora de tu clase (hoy)"})]}),e.jsxs("select",{value:g,onChange:s=>R(s.target.value),className:"w-full h-14 px-4 bg-white border-2 border-gray-200 rounded-lg text-gray-900 text-base focus:outline-none focus:border-[#17BC91] focus:ring-2 focus:ring-[#17BC91]/20 transition-all",children:[e.jsx("option",{value:"",children:"Selecciona una hora..."}),(()=>{const s=new Date,t=w?.operation_start_hour||8,i=w?.operation_end_hour||22,d=[];for(let h=t;h<i;h++){const u=new Date(s);if(u.setHours(h,0,0,0),u.getTime()>s.getTime()+1800*1e3){const ce=U(u);d.push(e.jsxs("option",{value:ce,children:[h.toString().padStart(2,"0"),":00"]},h))}}return d})()]})]}),g&&e.jsx(e.Fragment,{children:te?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-[#17BC91]/30 border-t-[#17BC91] rounded-full animate-spin"}),e.jsx("span",{className:"ml-2 text-gray-600 text-sm",children:"Buscando grupos..."})]}):S.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-700 font-medium text-sm flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-[#17BC91]"}),"Grupos disponibles:"]}),S.map(s=>e.jsx("div",{onClick:()=>N(s.id===m?null:s.id),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${m===s.id?"border-[#17BC91] bg-[#17BC91]/5":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.teacher?.name||"Por asignar"}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.available_spots," cupos"]})]})},s.id)),e.jsx("button",{onClick:()=>N(null),className:`w-full p-3 rounded-lg border-2 border-dashed transition-all ${m===null?"border-[#073372] bg-[#073372]/5":"border-gray-300"}`,children:e.jsx("span",{className:"text-sm text-gray-700",children:"+ Solicitar nueva clase"})})]}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No hay grupos. Se crear√° una nueva clase."})}),e.jsx(K,{label:"Mensaje (opcional)",value:z,onChange:s=>P(s.target.value),placeholder:"¬øTienes alg√∫n comentario adicional?",rows:2})]}):F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-purple-700 mb-2",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Plan Semanal"})]}),e.jsx("p",{className:"text-sm text-purple-600",children:"Puedes elegir cualquier hora y d√≠a dentro de los pr√≥ximos 7 d√≠as."})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-gray-700 mb-3",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"Selecciona fecha y hora"})]}),e.jsx("input",{type:"datetime-local",value:g,onChange:s=>R(s.target.value),min:(()=>{const s=new Date;return s.setMinutes(s.getMinutes()+30),U(s).slice(0,16)})(),max:(()=>{const s=new Date;return s.setDate(s.getDate()+7),U(s).slice(0,16)})(),className:"w-full h-14 px-4 bg-white border-2 border-gray-200 rounded-lg text-gray-900 text-base focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 transition-all",style:{colorScheme:"light"}}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Horarios disponibles: ",w?.operation_start_hour||8,":00 - ",w?.operation_end_hour||22,":00"]})]}),g&&e.jsx(e.Fragment,{children:te?e.jsxs("div",{className:"flex items-center justify-center py-4",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-purple-300 border-t-purple-600 rounded-full animate-spin"}),e.jsx("span",{className:"ml-2 text-gray-600 text-sm",children:"Buscando grupos..."})]}):S.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-gray-700 font-medium text-sm flex items-center gap-2",children:[e.jsx(se,{className:"w-4 h-4 text-purple-600"}),"Grupos disponibles para este horario:"]}),S.map(s=>e.jsx("div",{onClick:()=>N(s.id===m?null:s.id),className:`p-3 rounded-lg border-2 cursor-pointer transition-all ${m===s.id?"border-purple-500 bg-purple-50":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-900",children:s.teacher?.name||"Por asignar"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.scheduled_at).toLocaleString("es-PE",{weekday:"short",day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[s.available_spots," cupos"]})]})},s.id)),e.jsx("button",{onClick:()=>N(null),className:`w-full p-3 rounded-lg border-2 border-dashed transition-all ${m===null?"border-purple-500 bg-purple-50":"border-gray-300"}`,children:e.jsx("span",{className:"text-sm text-gray-700",children:"+ Solicitar nueva clase"})})]}):e.jsx("p",{className:"text-sm text-gray-500 text-center py-2",children:"No hay grupos para este horario. Se crear√° una nueva clase."})}),e.jsx(K,{label:"Mensaje (opcional)",value:z,onChange:s=>P(s.target.value),placeholder:"¬øTienes alg√∫n comentario adicional?",rows:2})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-600",children:"¬øDeseas solicitar esta clase? Nuestro equipo acad√©mico revisar√° tu solicitud y te programar√° una sesi√≥n."}),e.jsxs("div",{className:"bg-[#F98613]/5 border border-[#F98613]/30 rounded-xl p-4",children:[e.jsxs("label",{className:"flex items-center gap-2 text-[#F98613] mb-3",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:"¬øCu√°ndo te gustar√≠a tomar la clase?"})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"datetime-local",value:g,onChange:s=>R(s.target.value),className:"w-full h-14 px-4 bg-white border-2 border-[#F98613]/40 rounded-lg text-gray-900 text-base cursor-pointer focus:outline-none focus:border-[#F98613] focus:ring-2 focus:ring-[#F98613]/20 hover:border-[#F98613]/60 transition-all duration-200",style:{colorScheme:"light"}})}),e.jsx("p",{className:"text-xs text-[#F98613]/80 mt-2",children:"Haz clic en el campo para seleccionar fecha y hora. El equipo acad√©mico lo revisar√° y confirmar√°."})]}),e.jsx(K,{label:"Mensaje adicional (opcional)",value:z,onChange:s=>P(s.target.value),placeholder:"¬øAlg√∫n comentario o preferencia adicional?",rows:2})]})}),e.jsxs("div",{className:"bg-gray-50 px-6 py-4 rounded-b-2xl flex justify-end gap-3 border-t",children:[e.jsx(c,{variant:"outline",onClick:()=>{I(!1),N(null),P(""),R("")},disabled:G,children:"Cancelar"}),e.jsx(c,{onClick:Le,disabled:G||k&&!H||(B||F)&&!g,className:"bg-[#073372] hover:bg-[#052555]",children:G?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"w-4 h-4 mr-2"}),m?"Solicitar Unirme":"Enviar Solicitud"]})})]})]})}),Fe&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between ${r?r.passed?"bg-gradient-to-r from-[#17BC91] to-[#14a57f]":"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-[#F98613] to-[#d96f0a]"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:r?r.passed?e.jsx(oe,{className:"w-5 h-5 text-white"}):e.jsx(b,{className:"w-5 h-5 text-white"}):e.jsx(b,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:r?r.passed?"¬°Aprobado!":"No aprobado":"Evaluaci√≥n"}),e.jsx("p",{className:"text-white/80 text-sm",children:a.title})]})]}),e.jsx("button",{onClick:r?fe:()=>M(!1),className:"w-8 h-8 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center transition",children:e.jsx(_e,{className:"w-5 h-5 text-white"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:$e?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(xe,{className:"w-12 h-12 text-[#F98613] animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando preguntas del examen..."})]}):r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:`w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 ${r.passed?"bg-[#17BC91]/10":"bg-red-50"}`,children:r.passed?e.jsx(oe,{className:"w-12 h-12 text-[#17BC91]"}):e.jsx(b,{className:"w-12 h-12 text-red-500"})}),e.jsx("h3",{className:`text-2xl font-bold mb-2 ${r.passed?"text-[#17BC91]":"text-red-600"}`,children:r.passed?"¬°Felicitaciones!":"Sigue intentando"}),e.jsx("p",{className:"text-gray-600 mb-6",children:r.passed?"Has aprobado la evaluaci√≥n exitosamente.":"No alcanzaste el puntaje m√≠nimo para aprobar."}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 mb-6 max-w-sm mx-auto",children:[e.jsxs("div",{className:"text-5xl font-bold mb-2",style:{color:r.passed?"#17BC91":"#ef4444"},children:[r.percentage,"%"]}),e.jsxs("p",{className:"text-gray-500 text-sm mb-4",children:[r.score," de ",r.total_points," puntos"]}),e.jsxs("div",{className:"flex items-center justify-center gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[r.passing_score,"%"]}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Puntaje m√≠nimo"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-200"}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[r.attempts," / ",a.exam_max_attempts??3]}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Intentos usados"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[!r.passed&&r.attempts<(a.exam_max_attempts??3)&&e.jsxs(c,{onClick:Z,className:"bg-[#F98613] hover:bg-[#d96f0a]",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Intentar de nuevo"]}),!r.passed&&e.jsxs(c,{variant:"outline",onClick:()=>{M(!1),X(null),ne()},children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Ver mi examen"]}),e.jsxs(c,{variant:r.passed?"default":"outline",onClick:fe,className:r.passed?"bg-[#17BC91] hover:bg-[#14a57f]":"",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),r.passed?"Continuar":"Cerrar"]})]})]}):p.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No hay preguntas disponibles para este examen."}),e.jsx(c,{variant:"outline",onClick:()=>M(!1),className:"mt-4",children:"Cerrar"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Pregunta ",v+1," de ",p.length]}),e.jsxs("span",{className:"text-sm text-gray-500",children:[Object.keys(C).length," de ",p.length," respondidas"]})]}),e.jsx(Qe,{value:ze,className:"h-2"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 mb-6",children:[e.jsx("p",{className:"text-lg font-medium text-gray-900 mb-6",children:p[v].question}),e.jsx("div",{className:"space-y-2",children:p[v].options.map((s,t)=>e.jsxs("div",{onClick:()=>Ae(v,s.text),className:`flex items-center space-x-3 p-4 rounded-lg cursor-pointer transition-all ${C[v]===s.text?"bg-[#F98613]/10 border-2 border-[#F98613]":"bg-white border-2 border-gray-200 hover:border-[#F98613]/50 hover:bg-[#F98613]/5"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 ${C[v]===s.text?"border-[#F98613] bg-[#F98613]":"border-gray-300"}`,children:C[v]===s.text&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-white"})}),e.jsx("span",{className:"flex-1 text-gray-700",children:s.text})]},t))})]}),e.jsx("div",{className:"flex flex-wrap gap-2 justify-center mb-6",children:p.map((s,t)=>e.jsx("button",{onClick:()=>W(t),className:`w-10 h-10 rounded-lg text-sm font-medium transition ${t===v?"bg-[#F98613] text-white shadow-lg":C[t]?"bg-[#17BC91] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:t+1},t))}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsxs(c,{variant:"outline",onClick:()=>W(s=>Math.max(0,s-1)),disabled:v===0,children:[e.jsx(is,{className:"w-4 h-4 mr-1"}),"Anterior"]}),v===p.length-1?e.jsx(c,{onClick:Ie,disabled:Object.keys(C).length<p.length||be,className:"bg-[#17BC91] hover:bg-[#14a57f]",children:be?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4 mr-2 animate-spin"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Enviar Examen"]})}):e.jsxs(c,{onClick:()=>W(s=>Math.min(p.length-1,s+1)),className:"bg-[#073372] hover:bg-[#052555]",children:["Siguiente",e.jsx(as,{className:"w-4 h-4 ml-1"})]})]})]})})]})}),Pe&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:`px-6 py-4 flex items-center justify-between ${l?.attempt.passed?"bg-gradient-to-r from-[#17BC91] to-[#14a57f]":l?.attempts_exhausted?"bg-gradient-to-r from-red-500 to-red-600":"bg-gradient-to-r from-amber-500 to-amber-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx(O,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Revisi√≥n del Examen"}),e.jsx("p",{className:"text-white/80 text-sm",children:a.title})]})]}),e.jsx("button",{onClick:()=>V(!1),className:"w-8 h-8 rounded-lg bg-white/20 hover:bg-white/30 flex items-center justify-center transition",children:e.jsx(_e,{className:"w-5 h-5 text-white"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:Me?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(xe,{className:"w-12 h-12 text-[#F98613] animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando resultados del examen..."})]}):l?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`rounded-xl p-4 ${l.attempt.passed?"bg-emerald-50 border border-emerald-200":l.attempts_exhausted?"bg-red-50 border border-red-200":"bg-amber-50 border border-amber-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`text-4xl font-bold ${l.attempt.passed?"text-emerald-600":l.attempts_exhausted?"text-red-600":"text-amber-600"}`,children:[l.attempt.percentage,"%"]}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${l.attempt.passed?"text-emerald-800":l.attempts_exhausted?"text-red-800":"text-amber-800"}`,children:l.attempt.passed?"¬°Aprobado!":l.attempts_exhausted?"No aprobado":"En progreso"}),e.jsxs("p",{className:`text-sm ${l.attempt.passed?"text-emerald-600":l.attempts_exhausted?"text-red-600":"text-amber-600"}`,children:[l.attempt.score," de ",l.attempt.total_points," puntos"]})]})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("p",{className:"text-gray-600",children:["Intentos: ",l.attempts_used,"/",l.max_attempts]}),e.jsxs("p",{className:"text-gray-500",children:["M√≠nimo para aprobar: ",l.passing_score,"%"]})]})]})}),!l.show_correct_answers&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(O,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Modo de revisi√≥n limitado"}),e.jsx("p",{className:"text-sm text-blue-600",children:"Puedes ver si tus respuestas fueron correctas o incorrectas. Las respuestas correctas se mostrar√°n cuando agotes tus intentos o apruebes el examen."})]})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Detalle de respuestas"}),l.questions.map((s,t)=>e.jsx("div",{className:`rounded-xl border-2 p-4 ${s.is_correct?"border-emerald-200 bg-emerald-50/50":"border-red-200 bg-red-50/50"}`,children:e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 ${s.is_correct?"bg-emerald-500":"bg-red-500"}`,children:s.is_correct?e.jsx(y,{className:"w-5 h-5 text-white"}):e.jsx(Ge,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-gray-900 mb-2",children:[t+1,". ",s.question]}),e.jsxs("div",{className:`rounded-lg p-3 mb-2 ${s.is_correct?"bg-emerald-100 border border-emerald-300":"bg-red-100 border border-red-300"}`,children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Tu respuesta:"}),e.jsx("p",{className:`${s.is_correct?"text-emerald-800":"text-red-800"}`,children:s.student_answer||e.jsx("span",{className:"italic text-gray-400",children:"Sin respuesta"})})]}),l.show_correct_answers&&s.correct_answer&&!s.is_correct&&e.jsxs("div",{className:"rounded-lg p-3 bg-emerald-100 border border-emerald-300",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Respuesta correcta:"}),e.jsx("p",{className:"text-emerald-800",children:s.correct_answer})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[s.points_earned," / ",s.points_possible," punto",s.points_possible!==1?"s":""]})]})]})},t))]}),e.jsxs("div",{className:"flex flex-wrap gap-3 justify-center pt-4 border-t",children:[!l.attempt.passed&&!l.attempts_exhausted&&e.jsxs(c,{onClick:()=>{V(!1),Z()},className:"bg-[#F98613] hover:bg-[#d96f0a]",children:[e.jsx(b,{className:"w-4 h-4 mr-2"}),"Intentar de nuevo"]}),e.jsx(c,{variant:"outline",onClick:()=>V(!1),children:"Cerrar"})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(b,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No se pudieron cargar los resultados."})]})})]})})]})};export{Qs as default};
