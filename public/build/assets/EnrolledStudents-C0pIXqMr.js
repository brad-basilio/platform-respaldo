import{r as x,U as G,j as e,a as B,c as be}from"./app-BHPs7N3P.js";import{R as je}from"./index-pum1ZMD1.js";import{A as ve,C as K,F as j,e as ye,S as b}from"./AuthenticatedLayout-DvSiEFKj.js";import{A as Ne,t as we,M as Ce,a as Be}from"./index.esm-wsX6a4bz.js";import{I as o,S as Ee}from"./input-DxJE_uoa.js";/* empty css                       */import{U as Se}from"./user-check-doDSs_Zx.js";import{U as De}from"./user-x-Cf1otf3h.js";import{C as M}from"./circle-check-big--ehG1MeI.js";import{C as U}from"./circle-alert-CsafnAHX.js";import{C as me}from"./clock-CruE9NGa.js";import{E as Z}from"./eye-DQDWE_Je.js";import{T as se}from"./trash-2-DM5DWV_j.js";import{S as $e}from"./search-LyPGU82f.js";import{U as Y}from"./users-V7eYjr7K.js";import{M as le}from"./mail-oufkNTXY.js";import{P as ce}from"./phone-DYdBjLPT.js";import{C as w}from"./calendar-dHjrC_IN.js";import{C as J}from"./credit-card-Bxv9Z3h0.js";import{G as re}from"./graduation-cap-BvOB5oDa.js";import{B as ke}from"./book-open-Banj4pi2.js";import{M as Te}from"./map-pin-CBhT6ytF.js";import{C as ze}from"./chevron-down-Bs1jSxJT.js";/* empty css            */import"./button-06jbzzbJ.js";import"./clsx-B-dksMZM.js";import"./dropdown-menu-Cqk0GMeM.js";import"./createLucideIcon-BEwjrUWg.js";import"./index-cA7h04hZ.js";import"./index-DGZ9o9tf.js";import"./badge-7IgZiIUm.js";import"./x-DoGSKmO9.js";import"./triangle-alert-BgKoL3ck.js";Ce.registerModules([Be]);const Pe=l=>{const s=be.c(31),{studentType:_,isVerified:u,onSelect:E}=l,[h,T]=x.useState(!1);let V;s[0]===Symbol.for("react.memo_cache_sentinel")?(V={top:0,left:0},s[0]=V):V=s[0];const[S,L]=x.useState(V),r=x.useRef(null),m=x.useRef(null);let D;s[1]===Symbol.for("react.memo_cache_sentinel")?(D={regular:{label:"Regular",description:"Solicita con 1 hora de anticipaci√≥n",bgClass:"bg-gray-100",textClass:"text-gray-700",borderClass:"border-gray-300",hoverClass:"hover:bg-gray-50",iconBg:"bg-gray-200"},daily:{label:"Diario",description:"Elige cualquier hora del d√≠a actual",bgClass:"bg-emerald-50",textClass:"text-emerald-700",borderClass:"border-emerald-200",hoverClass:"hover:bg-emerald-50",iconBg:"bg-emerald-100"},weekly:{label:"Semanal",description:"Elige cualquier hora en los pr√≥ximos 7 d√≠as",bgClass:"bg-purple-50",textClass:"text-purple-700",borderClass:"border-purple-200",hoverClass:"hover:bg-purple-50",iconBg:"bg-purple-100"}},s[1]=D):D=s[1];const q=D;let A,H;s[2]!==h?(A=()=>{if(h&&r.current){const d=r.current.getBoundingClientRect();L({top:d.bottom+window.scrollY+4,left:d.left+window.scrollX})}},H=[h],s[2]=h,s[3]=A,s[4]=H):(A=s[3],H=s[4]),x.useEffect(A,H);let $,y;s[5]===Symbol.for("react.memo_cache_sentinel")?($=()=>{const d=N=>{m.current&&!m.current.contains(N.target)&&r.current&&!r.current.contains(N.target)&&T(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},y=[],s[5]=$,s[6]=y):($=s[5],y=s[6]),x.useEffect($,y);let k,c;s[7]!==h?(k=()=>{const d=()=>{h&&T(!1)};return window.addEventListener("scroll",d,!0),()=>window.removeEventListener("scroll",d,!0)},c=[h],s[7]=h,s[8]=k,s[9]=c):(k=s[8],c=s[9]),x.useEffect(k,c);const C=q[_];if(!u){let d;return s[10]!==C.label?(d=e.jsx("div",{className:"px-3 py-1.5 rounded-lg text-xs font-medium bg-gray-100 text-gray-400 border border-gray-200 cursor-not-allowed",children:C.label}),s[10]=C.label,s[11]=d):d=s[11],d}let W;s[12]!==S||s[13]!==h||s[14]!==E||s[15]!==_?(W=h?je.createPortal(e.jsx("div",{ref:m,className:"fixed w-64 bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden",style:{top:S.top,left:S.left,zIndex:99999},children:e.jsxs("div",{className:"p-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wider text-gray-400 font-semibold px-2 py-1",children:"Tipo de aprendiz"}),Object.keys(q).map(d=>{const N=q[d],Q=d===_;return e.jsx("button",{onClick:()=>{d!==_&&E(d),T(!1)},className:`w-full text-left px-3 py-2.5 rounded-lg transition-all ${Q?`${N.bgClass} ${N.borderClass} border`:`${N.hoverClass} border border-transparent`}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-lg ${N.iconBg} flex items-center justify-center flex-shrink-0 mt-0.5`,children:Q&&e.jsx(M,{className:`w-4 h-4 ${N.textClass}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-sm font-semibold ${Q?N.textClass:"text-gray-900"}`,children:N.label}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5 leading-tight",children:N.description})]})]})},d)})]})}),document.body):null,s[12]=S,s[13]=h,s[14]=E,s[15]=_,s[16]=W):W=s[16];const F=W;let p;s[17]!==h?(p=()=>T(!h),s[17]=h,s[18]=p):p=s[18];const R=`flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold border transition-all ${C.bgClass} ${C.textClass} ${C.borderClass} hover:shadow-md`;let v;s[19]!==C.label?(v=e.jsx("span",{children:C.label}),s[19]=C.label,s[20]=v):v=s[20];const X=`w-3.5 h-3.5 transition-transform ${h?"rotate-180":""}`;let z;s[21]!==X?(z=e.jsx(ze,{className:X}),s[21]=X,s[22]=z):z=s[22];let P;s[23]!==p||s[24]!==R||s[25]!==v||s[26]!==z?(P=e.jsxs("button",{ref:r,onClick:p,className:R,children:[v,z]}),s[23]=p,s[24]=R,s[25]=v,s[26]=z,s[27]=P):P=s[27];let f;return s[28]!==F||s[29]!==P?(f=e.jsxs(e.Fragment,{children:[P,F]}),s[28]=F,s[29]=P,s[30]=f):f=s[30],f},_e=({student:l,onClose:s,groups:_})=>{const[u,E]=G.useState([]),[h,T]=G.useState(!0),[V,S]=G.useState(!1),L=r=>{if(!r)return"Sin asignar";const m=_.find(D=>D.id===r);return m?m.name:"Grupo desconocido"};return G.useEffect(()=>{(async()=>{try{T(!0);const m=await B.get(`/admin/students/${l.id}/enrollment-documents`);E(m.data.documents||[]),S(m.data.has_pending_documents||!1)}catch(m){console.error("Error al cargar documentos:",m),E([]),S(!1)}finally{T(!1)}})()},[l.id]),G.useEffect(()=>{const r=window.scrollY;return document.body.style.position="fixed",document.body.style.top=`-${r}px`,document.body.style.width="100%",document.body.style.overflow="hidden",()=>{document.body.style.position="",document.body.style.top="",document.body.style.width="",document.body.style.overflow="",window.scrollTo(0,r)}},[]),e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/50 backdrop-blur-sm animate-fade-in flex items-center justify-center p-4",onClick:s,style:{height:"100vh",width:"100vw"},children:e.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl w-full max-w-5xl max-h-[90vh] flex flex-col animate-scale-in",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] px-8 py-6 flex items-center justify-between rounded-t-3xl",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Informaci√≥n del Aprendiz"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Todos los datos del aprendiz matriculado (Solo lectura)"})]}),e.jsx("button",{onClick:s,className:"text-white hover:bg-white/20 rounded-full p-2 transition-colors",children:e.jsx(K,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("form",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(Y,{className:"h-5 w-5 mr-2 text-blue-600"}),"Datos Personales"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(o,{label:"Nombres",type:"text",value:l.firstName||"",disabled:!0,variant:"filled"}),e.jsx(o,{label:"Apellido Paterno",type:"text",value:l.paternalLastName||"",disabled:!0,variant:"filled"}),e.jsx(o,{label:"Apellido Materno",type:"text",value:l.maternalLastName||"",disabled:!0,variant:"filled"}),e.jsx(o,{label:"Email",type:"email",value:l.email||"",disabled:!0,variant:"filled",icon:e.jsx(le,{className:"w-4 h-4"})}),e.jsx(o,{label:"Tel√©fono",type:"text",value:l.phoneNumber||"",disabled:!0,variant:"filled",icon:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(o,{label:"G√©nero",type:"text",value:l.gender==="male"?"Masculino":l.gender==="female"?"Femenino":"Otro",disabled:!0,variant:"filled"}),e.jsx(o,{label:"Fecha de Nacimiento",type:"date",value:l.birthDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Tipo de Documento",type:"text",value:l.documentType?.toUpperCase()||"",disabled:!0,variant:"filled",icon:e.jsx(j,{className:"w-4 h-4"})}),e.jsx(o,{label:"N√∫mero de Documento",type:"text",value:l.documentNumber||"",disabled:!0,variant:"filled",icon:e.jsx(J,{className:"w-4 h-4"})}),e.jsx("div",{className:"md:col-span-3",children:e.jsx(o,{label:"Nivel Educativo",type:"text",value:l.educationLevel||"",disabled:!0,variant:"filled",icon:e.jsx(re,{className:"w-4 h-4"})})})]})]}),e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(ke,{className:"h-5 w-5 mr-2 text-purple-600"}),"Datos Acad√©micos"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(o,{label:"C√≥digo de Matr√≠cula",type:"text",value:l.enrollmentCode||"",disabled:!0,variant:"filled",icon:e.jsx(j,{className:"w-4 h-4"})}),e.jsx(o,{label:"Fecha de Pago",type:"date",value:l.paymentDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Fecha de Matr√≠cula",type:"date",value:l.enrollmentDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Nivel Acad√©mico",type:"text",value:l.level==="basic"?"B√°sico":l.level==="intermediate"?"Intermedio":l.level==="advanced"?"Avanzado":"No asignado",disabled:!0,variant:"filled",icon:e.jsx(re,{className:"w-4 h-4"})}),e.jsx(o,{label:"Plan Contratado",type:"text",value:l.contractedPlan||"Sin plan",disabled:!0,variant:"filled",icon:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(o,{label:"Grupo Asignado",type:"text",value:L(l.assignedGroupId),disabled:!0,variant:"filled",icon:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(o,{label:"Tipo de Clase",type:"text",value:l.classType==="theoretical"?"Te√≥rico":"Pr√°ctico",disabled:!0,variant:"filled"}),e.jsx(o,{label:"Pago Verificado",type:"text",value:l.paymentVerified?"‚úÖ S√≠":"‚ùå No",disabled:!0,variant:"filled"}),e.jsx(o,{label:"Estado",type:"text",value:l.status==="active"?"‚úÖ Activo":"‚ùå Inactivo",disabled:!0,variant:"filled"})]})]}),e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(re,{className:"h-5 w-5 mr-2 text-orange-600"}),"Examen de Categorizaci√≥n"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(o,{label:"¬øRealiz√≥ examen?",type:"text",value:l.hasPlacementTest?"S√≠":"No",disabled:!0,variant:"filled"}),l.hasPlacementTest&&e.jsxs(e.Fragment,{children:[e.jsx(o,{label:"Fecha del Examen",type:"date",value:l.testDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Puntaje",type:"text",value:l.testScore||"",disabled:!0,variant:"filled",icon:e.jsx(j,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(Y,{className:"h-5 w-5 mr-2 text-green-600"}),"Datos del Apoderado / Titular"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(o,{label:"Nombre Completo",type:"text",value:l.guardianName||"No registrado",disabled:!0,variant:"filled"}),e.jsx(o,{label:"N√∫mero de Documento",type:"text",value:l.guardianDocumentNumber||"No registrado",disabled:!0,variant:"filled",icon:e.jsx(J,{className:"w-4 h-4"})}),e.jsx(o,{label:"Email",type:"email",value:l.guardianEmail||"No registrado",disabled:!0,variant:"filled",icon:e.jsx(le,{className:"w-4 h-4"})}),e.jsx(o,{label:"Tel√©fono",type:"text",value:l.guardianPhone||"No registrado",disabled:!0,variant:"filled",icon:e.jsx(ce,{className:"w-4 h-4"})}),e.jsx(o,{label:"Fecha de Nacimiento",type:"date",value:l.guardianBirthDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Direcci√≥n",type:"text",value:l.guardianAddress||"No registrado",disabled:!0,variant:"filled",icon:e.jsx(Te,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(w,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Fechas Importantes"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(o,{label:"Fecha de Registro",type:"date",value:l.registrationDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Fecha de Pago",type:"date",value:l.paymentDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(o,{label:"Fecha de Matr√≠cula",type:"date",value:l.enrollmentDate||"",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})})]})]}),l.enrollmentVerified&&e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(M,{className:"h-5 w-5 mr-2 text-emerald-600"}),"Informaci√≥n de Verificaci√≥n"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(o,{label:"Verificado por",type:"text",value:l.verifiedEnrollmentBy?.name||"No disponible",disabled:!0,variant:"filled",icon:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx(o,{label:"Fecha de Verificaci√≥n",type:"text",value:l.enrollmentVerifiedAt?new Date(l.enrollmentVerifiedAt).toLocaleString("es-ES"):"No disponible",disabled:!0,variant:"filled",icon:e.jsx(w,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(j,{className:"h-5 w-5 mr-2 text-purple-600"}),"Estado del Contrato"]}),l.contract?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`p-4 rounded-xl border-2 ${l.contract.accepted?"bg-green-50 border-green-300":"bg-orange-50 border-orange-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[l.contract.accepted?e.jsx(M,{className:"h-6 w-6 text-green-600"}):e.jsx(U,{className:"h-6 w-6 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold text-sm ${l.contract.accepted?"text-green-900":"text-orange-900"}`,children:l.contract.accepted?"‚úÖ Contrato Firmado":"‚ö†Ô∏è Contrato Pendiente de Firma"}),l.contract.accepted&&l.contract.accepted_at&&e.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["Firmado el ",new Date(l.contract.accepted_at).toLocaleString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]}),!l.contract.accepted&&e.jsx("p",{className:"text-xs text-orange-700 mt-1",children:"El aprendiz debe firmar el contrato para completar su matr√≠cula"})]})]}),l.contract.pdf_url&&e.jsxs("a",{href:l.contract.pdf_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-xs font-medium rounded-lg transition-colors",children:[e.jsx(j,{className:"h-4 w-4"}),"Ver PDF"]})]})}),!l.contract.accepted&&e.jsx("div",{className:"bg-blue-50 border-l-4 border-blue-500 p-3 rounded",children:e.jsxs("p",{className:"text-sm text-blue-900",children:[e.jsx("strong",{children:"üí° Recordatorio:"})," El aprendiz recibi√≥ un correo con el enlace para firmar el contrato. Tambi√©n puede acceder desde su dashboard cuando inicie sesi√≥n."]})})]}):e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:[e.jsx(U,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No se ha generado contrato para este aprendiz"})]})]}),e.jsxs("div",{className:"border border-gray-200 p-6 rounded-xl bg-white shadow-sm",children:[e.jsxs("h3",{className:"text-base font-semibold text-gray-900 mb-4 flex items-center border-b border-gray-200 pb-3",children:[e.jsx(j,{className:"h-5 w-5 mr-2 text-indigo-600"}),"Documentos de Matr√≠cula",u.length>0&&e.jsxs("span",{className:"ml-auto text-xs bg-indigo-100 text-indigo-700 px-2.5 py-1 rounded-full font-medium",children:[u.length," documento(s)"]})]}),V&&e.jsx("div",{className:"mb-4 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-5 w-5 text-yellow-600 mr-2"}),e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Atenci√≥n:"})," Hay documentos enviados al aprendiz pendientes de confirmaci√≥n. No se puede enviar m√°s documentos hasta que confirme los actuales."]})]})}),h?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Cargando documentos..."})]}):u.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(j,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No hay documentos de matr√≠cula"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"El aprendiz debe subir su contrato y voucher de pago, o puedes enviarle documentos adicionales"})]}):e.jsxs("div",{className:"space-y-3",children:[u.some(r=>r.is_student_upload)&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[e.jsx(Y,{className:"h-4 w-4 mr-2 text-blue-600"}),"Documentos del Aprendiz"]}),e.jsx("div",{className:"space-y-3",children:u.filter(r=>r.is_student_upload).map((r,m)=>e.jsx("div",{className:"border border-blue-200 bg-blue-50 rounded-lg p-4 hover:bg-blue-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.document_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Subido por el aprendiz ‚Ä¢ ",r.document_type==="contract"?"Contrato":r.document_type==="payment"?"Voucher de Pago":"Documento"]})]})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2 ml-14",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 ml-14 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),"Subido: ",new Date(r.uploaded_at).toLocaleDateString("es-ES")]}),e.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 rounded-full bg-green-100 text-green-700",children:[e.jsx(M,{className:"h-3 w-3"}),"Confirmado"]})]})]}),e.jsxs("a",{href:r.document_type==="contract"?`/admin/students/${l.id}/contract`:`/storage/${r.file_path}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors",children:[e.jsx(Z,{className:"h-4 w-4"}),"Ver"]})]})},`student-${m}`))})]}),u.some(r=>r.is_payment_receipt)&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[e.jsx(J,{className:"h-4 w-4 mr-2 text-green-600"}),"Comprobantes de Pago"]}),e.jsx("div",{className:"space-y-3",children:u.filter(r=>r.is_payment_receipt).map((r,m)=>e.jsx("div",{className:"border border-green-200 bg-green-50 rounded-lg p-4 hover:bg-green-100 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(J,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.document_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Comprobante generado autom√°ticamente ‚Ä¢ Cuota #",r.installment_number]})]})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2 ml-14",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 ml-14 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),"Generado: ",new Date(r.uploaded_at).toLocaleDateString("es-ES")]}),e.jsxs("span",{className:"flex items-center gap-1 px-2 py-1 rounded-full bg-green-100 text-green-700 font-medium",children:["S/ ",r.amount?.toFixed(2)]})]})]}),e.jsxs("a",{href:`/storage/${r.file_path}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-sm rounded-lg transition-colors",children:[e.jsx(Z,{className:"h-4 w-4"}),"Ver PDF"]})]})},`receipt-${m}`))})]}),u.some(r=>!r.is_student_upload&&!r.is_payment_receipt)&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center",children:[e.jsx(j,{className:"h-4 w-4 mr-2 text-purple-600"}),"Documentos Enviados al Aprendiz"]}),e.jsx("div",{className:"space-y-3",children:u.filter(r=>!r.is_student_upload&&!r.is_payment_receipt).map((r,m)=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:e.jsx(j,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:r.document_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Tipo: ",r.document_type==="contract"?"Contrato":r.document_type==="regulation"?"Reglamento":r.document_type==="terms"?"T√©rminos y Condiciones":"Otro",r.uploaded_by_name&&` ‚Ä¢ Enviado por: ${r.uploaded_by_name}`]})]})]}),r.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2 ml-14",children:r.description}),e.jsxs("div",{className:"flex items-center gap-4 ml-14 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),"Enviado: ",new Date(r.uploaded_at).toLocaleDateString("es-ES")]}),r.requires_signature&&e.jsx("span",{className:`flex items-center gap-1 px-2 py-1 rounded-full ${r.student_confirmed?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:r.student_confirmed?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-3 w-3"}),"Confirmado por aprendiz"]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"h-3 w-3"}),"Pendiente de confirmaci√≥n"]})}),r.confirmed_at&&e.jsxs("span",{className:"flex items-center gap-1",children:["Confirmado: ",new Date(r.confirmed_at).toLocaleDateString("es-ES")]})]})]}),e.jsxs("a",{href:`/storage/${r.file_path}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm rounded-lg transition-colors",children:[e.jsx(Z,{className:"h-4 w-4"}),"Ver"]})]})},`verifier-${m}`))})]})]})]})]})}),e.jsx("div",{className:"bg-gray-50 px-8 py-4 border-t border-gray-200 flex justify-end rounded-b-3xl",children:e.jsx("button",{onClick:s,className:"bg-gray-600 hover:bg-gray-700 text-white px-6 py-2.5 rounded-xl font-medium transition-colors",children:"Cerrar"})})]})})},ft=({students:l=[],groups:s=[],userRole:_=""})=>{const[u,E]=x.useState(l??[]),[h,T]=x.useState(null),[V,S]=x.useState(!1),[L,r]=x.useState(""),[m,D]=x.useState("verified"),[q,A]=x.useState(new Set),[H,$]=x.useState(!1),[y,k]=x.useState(null),[c,C]=x.useState(!1),[W,F]=x.useState(!1),[p,R]=x.useState(null),[v,X]=x.useState(!1),[z,P]=x.useState([]),[f,d]=x.useState([]);G.useEffect(()=>{const t=async()=>{const a=new Set;for(const n of u)try{(await B.get(`/admin/students/${n.id}/enrollment-documents`)).data.has_pending_documents&&a.add(n.id)}catch(i){console.error(`Error checking documents for student ${n.id}:`,i)}A(a)};u.length>0&&t()},[u]),G.useEffect(()=>{(async()=>{try{const a=await B.get("/admin/document-types/active");P(a.data)}catch(a){console.error("Error loading document types:",a),P([{id:1,name:"Contrato",code:"contract"},{id:2,name:"Reglamento",code:"regulation"},{id:3,name:"T√©rminos y Condiciones",code:"terms"},{id:4,name:"Otro",code:"other"}])}})()},[]);const N=()=>{const t=document.createElement("input");t.type="file",t.accept=".pdf,.doc,.docx,.png,.jpg,.jpeg",t.multiple=!0,t.onchange=async a=>{const i=a.target.files;if(i){const g=Array.from(i).map(I=>({file:I,document_type:"contract",document_name:I.name.replace(/\.[^/.]+$/,""),description:"",requires_signature:!0}));d([...f,...g])}},t.click()},Q=t=>{d(f.filter((a,n)=>n!==t))},ne=async t=>{if(t.contract&&!t.contract.accepted){await b.fire({title:"‚ö†Ô∏è Contrato No Firmado",html:`
          <div class="text-left space-y-4">
            <div class="bg-orange-50 border-l-4 border-orange-500 p-4 rounded">
              <p class="text-sm text-orange-900 font-semibold mb-2">
                El aprendiz a√∫n no ha firmado su contrato de matr√≠cula
              </p>
              <p class="text-xs text-orange-700">
                No se puede verificar la matr√≠cula hasta que el aprendiz firme el contrato.
              </p>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
              <h4 class="text-sm font-semibold text-blue-900 mb-3">üìã Datos de Contacto</h4>
              <div class="space-y-2 text-sm">
                <div class="flex items-center gap-2">
                
                  <span class="text-gray-700"><strong>Email:</strong> ${t.email}</span>
                </div>
                <div class="flex items-center gap-2">
                 
                  <span class="text-gray-700"><strong>Tel√©fono:</strong> ${t.phoneNumber||"No registrado"}</span>
                </div>
              </div>
            </div>

            <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
              <p class="text-xs text-gray-600">
                üí° <strong>Sugerencia:</strong> Puedes reenviar el correo con el enlace para firmar el contrato usando el bot√≥n de abajo.
              </p>
            </div>
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#10b981",cancelButtonColor:"#6b7280",confirmButtonText:"Reenviar Correo de Matr√≠cula",cancelButtonText:"Cancelar",reverseButtons:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium",cancelButton:"px-6 py-2.5 rounded-xl font-medium",popup:"max-w-2xl"}}).then(async a=>{if(a.isConfirmed)try{(await B.post(`/admin/students/${t.id}/resend-contract-email`)).data.success&&await b.fire({title:"‚úÖ Correo Reenviado",html:`
                  <p class="text-gray-700">El correo con el enlace para firmar el contrato ha sido reenviado a:</p>
                  <p class="text-blue-600 font-semibold mt-2">${t.email}</p>
                  <p class="text-sm text-gray-500 mt-3">El aprendiz recibir√° el enlace en su bandeja de entrada.</p>
                `,icon:"success",confirmButtonColor:"#10b981",confirmButtonText:"Entendido",timer:4e3,timerProgressBar:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}catch(n){console.error("Error al reenviar correo:",n),await b.fire({title:"Error",text:"No se pudo reenviar el correo. Por favor, intenta nuevamente.",icon:"error",confirmButtonColor:"#ef4444",confirmButtonText:"Cerrar",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}});return}if(q.has(t.id)){await b.fire({title:"Documentos Pendientes",html:`
          <p class="text-gray-700">Este aprendiz tiene documentos pendientes de confirmaci√≥n.</p>
          <p class="text-sm text-yellow-600 mt-2">‚è≥ Debe confirmar los documentos actuales antes de poder enviar m√°s.</p>
        `,icon:"warning",confirmButtonColor:"#f59e0b",confirmButtonText:"Entendido",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}});return}k(t),d([]),$(!0)},xe=async()=>{if(y&&!c)try{C(!0);const t=new FormData;f.forEach((n,i)=>{t.append(`documents[${i}][file]`,n.file),t.append(`documents[${i}][document_type]`,n.document_type),t.append(`documents[${i}][document_name]`,n.document_name),t.append(`documents[${i}][description]`,n.description),t.append(`documents[${i}][requires_signature]`,n.requires_signature?"1":"0")});const a=await B.post(`/admin/students/${y.id}/verify-enrollment`,t,{headers:{"Content-Type":"multipart/form-data"}});if(a.data.success){const n=a.data.auto_verified||!1;n?(E(i=>i.map(g=>g.id===y.id?{...g,enrollmentVerified:!0,enrollmentVerifiedAt:new Date().toISOString(),verifiedEnrollmentBy:a.data.student.verifiedEnrollmentBy}:g)),A(i=>{const g=new Set(i);return g.delete(y.id),g})):A(i=>new Set(i).add(y.id)),$(!1),k(null),d([]),await b.fire({title:n?"¬°Matr√≠cula Verificada!":"¬°Documentos Enviados!",html:`
            <p>${n?"La matr√≠cula ha sido verificada exitosamente (sin documentos que requieran firma)":"Los documentos han sido enviados al aprendiz exitosamente"}</p>
            ${a.data.documents_uploaded>0?`<p class="text-sm text-gray-600 mt-2">Se enviaron ${a.data.documents_uploaded} documento(s)</p>`:""}
            ${n?'<p class="text-sm text-green-600 mt-3">El aprendiz ya puede acceder a todas las funcionalidades</p>':'<p class="text-sm text-orange-600 mt-3">La matr√≠cula se verificar√° cuando el aprendiz confirme todos los documentos</p>'}
          `,icon:"success",confirmButtonColor:"#10b981",confirmButtonText:"Entendido",timer:n?4e3:3e3,timerProgressBar:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}}catch(t){console.error("Error al verificar matr√≠cula:",t);const a=B.isAxiosError(t)&&t.response?.data?.message||"Error al verificar la matr√≠cula";await b.fire({title:"Error",text:a,icon:"error",confirmButtonColor:"#ef4444",confirmButtonText:"Cerrar",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}finally{C(!1)}},ie=async t=>{if((await b.fire({title:"¬øRemover Verificaci√≥n?",html:`
        <div class="text-left">
          <p class="text-gray-700 mb-3">¬øEst√°s seguro de que quieres remover la verificaci√≥n de esta matr√≠cula?</p>
          <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
            <p class="text-sm text-yellow-800">
              <strong>Advertencia:</strong> Al remover la verificaci√≥n:
            </p>
            <ul class="text-sm text-yellow-700 mt-2 space-y-1 list-disc list-inside">
              <li>NO contar√° para la comisi√≥n del asesor</li>
              <li>Se marcar√° como pendiente de verificaci√≥n</li>
              <li>Se eliminar√° el registro de verificaci√≥n</li>
            </ul>
          </div>
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#6b7280",confirmButtonText:'<i class="fas fa-times-circle"></i> S√≠, Remover',cancelButtonText:'<i class="fas fa-ban"></i> Cancelar',reverseButtons:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium",cancelButton:"px-6 py-2.5 rounded-xl font-medium"}})).isConfirmed)try{const n=await B.post(`/admin/students/${t}/unverify-enrollment`);if(n.data.success){E(g=>g.map(I=>I.id===t?{...I,enrollmentVerified:!1,enrollmentVerifiedAt:void 0,verifiedEnrollmentBy:void 0}:I));const i=n.data.documents_deleted||0;await b.fire({title:"Verificaci√≥n Removida",html:`
            <p>La verificaci√≥n ha sido removida exitosamente</p>
            ${i>0?`<p class="text-sm text-gray-600 mt-2">‚úÖ Se eliminaron ${i} documento(s) anterior(es)</p>`:""}
          `,icon:"success",confirmButtonColor:"#10b981",confirmButtonText:"Entendido",timer:3e3,timerProgressBar:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}}catch(n){console.error("Error al remover verificaci√≥n:",n);const i=B.isAxiosError(n)&&n.response?.data?.message||"Error al remover la verificaci√≥n";await b.fire({title:"Error",text:i,icon:"error",confirmButtonColor:"#ef4444",confirmButtonText:"Cerrar",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}},oe=async(t,a)=>{if((t.studentType??"regular")===a)return;const i={regular:"Regular",daily:"Diario",weekly:"Semanal"},g={regular:"debe solicitar clases con anticipaci√≥n m√≠nima (1 hora) y solo puede inscribirse en el pr√≥ximo slot disponible.",daily:"puede elegir cualquier hora del d√≠a actual para su clase.",weekly:"puede elegir cualquier hora de cualquier d√≠a dentro de los pr√≥ximos 7 d√≠as."},ee={regular:{bg:"bg-gray-50",border:"border-gray-300",text:"text-gray-700"},daily:{bg:"bg-[#17BC91]/10",border:"border-[#17BC91]",text:"text-[#17BC91]"},weekly:{bg:"bg-purple-50",border:"border-purple-300",text:"text-purple-700"}}[a];if((await b.fire({title:`¬øCambiar a ${i[a]}?`,html:`
        <div class="text-left">
          <p class="text-gray-700 mb-3">
            El aprendiz <strong>${i[a]}</strong> ${g[a]}
          </p>
          <div class="${ee.bg} ${ee.border} border-l-4 p-4 rounded">
            <p class="text-sm ${ee.text}">
              <strong>${t.name}</strong> ser√° marcado como <strong>${i[a]}</strong>
            </p>
          </div>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonColor:a==="regular"?"#6b7280":a==="daily"?"#17BC91":"#8b5cf6",cancelButtonColor:"#9ca3af",confirmButtonText:`S√≠, marcar como ${i[a]}`,cancelButtonText:"Cancelar",reverseButtons:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium",cancelButton:"px-6 py-2.5 rounded-xl font-medium"}})).isConfirmed)try{const O=await B.patch(`/admin/students/${t.id}/student-type`,{student_type:a});O.data.success&&(E(te=>te.map(ae=>ae.id===t.id?{...ae,studentType:O.data.student.studentType}:ae)),await b.fire({title:"¬°Actualizado!",text:O.data.message,icon:"success",confirmButtonColor:"#10b981",confirmButtonText:"Entendido",timer:2e3,timerProgressBar:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}}))}catch(O){console.error("Error al cambiar tipo de aprendiz:",O);const te=B.isAxiosError(O)&&O.response?.data?.message||"Error al cambiar el tipo de aprendiz";await b.fire({title:"Error",text:te,icon:"error",confirmButtonColor:"#ef4444",confirmButtonText:"Cerrar",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}},ue=t=>{R(t),F(!0)},pe=async()=>{if(!(!p||v)){X(!0);try{await B.delete(`/admin/students/${p.id}`),E(t=>t.filter(a=>a.id!==p.id)),F(!1),R(null),await b.fire({title:"¬°Estudiante Eliminado!",html:`
          <p class="text-gray-700">El aprendiz <strong>${p.name}</strong> ha sido eliminado exitosamente.</p>
          <p class="text-sm text-gray-500 mt-2">Todos los datos asociados han sido removidos del sistema.</p>
        `,icon:"success",confirmButtonColor:"#10b981",confirmButtonText:"Entendido",timer:3e3,timerProgressBar:!0,customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}catch(t){console.error("Error al eliminar aprendiz:",t);const a=B.isAxiosError(t)&&t.response?.data?.message||"Error al eliminar el aprendiz";await b.fire({title:"Error",text:a,icon:"error",confirmButtonColor:"#ef4444",confirmButtonText:"Cerrar",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})}finally{X(!1)}}},fe=x.useCallback(t=>{if(!t)return"Sin asignar";const a=s.find(n=>n.id===t);return a?a.name:"Grupo desconocido"},[s]),he=x.useMemo(()=>{let t=u;return m==="pending"?t=u.filter(a=>!a.enrollmentVerified):m==="verified"&&(t=u.filter(a=>a.enrollmentVerified)),t},[u,m]),de=t=>{T(t),S(!0)},ge=x.useMemo(()=>[{headerName:"Alumno",field:"name",width:280,minWidth:280,maxWidth:350,flex:0,filter:"agTextColumnFilter",cellRenderer:t=>{const a=t.data,n=a.avatar;return e.jsx("div",{className:"flex items-center justify-between py-2 w-full h-full group",children:e.jsxs("div",{className:"flex items-center",children:[n?e.jsx("img",{src:`/storage/${a.avatar}`,alt:a.name,className:"w-10 h-10 rounded-full object-cover flex-shrink-0 border-2 border-white shadow-md"}):e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-[#073372] to-[#17BC91] rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-sm font-semibold",children:a.name.split(" ").map(i=>i[0]).join("")})}),e.jsxs("div",{className:"ml-3 overflow-hidden",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 whitespace-nowrap overflow-hidden text-ellipsis",title:a.name,children:a.name}),e.jsx("div",{className:"text-xs text-gray-500 whitespace-nowrap overflow-hidden text-ellipsis",title:a.email,children:a.email}),e.jsx("div",{className:"text-xs text-gray-400 whitespace-nowrap overflow-hidden text-ellipsis",children:a.phoneNumber})]})]})})}},{headerName:"C√≥digo",field:"enrollmentCode",width:150,filter:"agTextColumnFilter",cellRenderer:t=>{const a=t.data;return e.jsxs("div",{className:"w-full h-full flex flex-col justify-center",children:[e.jsx("div",{className:"text-sm font-mono text-gray-900",children:t.value}),e.jsx("div",{className:"text-xs text-gray-500",children:a.enrollmentDate})]})}},{headerName:"Estado",field:"status",width:110,filter:"agTextColumnFilter",cellRenderer:t=>{const a=t.value;return e.jsx("div",{className:"flex items-center justify-center w-full h-full",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${a==="active"?"bg-[#17BC91]/10 text-[#17BC91] border border-[#17BC91]/30":"bg-red-100 text-red-800"}`,children:[a==="active"?e.jsx(Se,{className:"w-3 h-3 mr-1"}):e.jsx(De,{className:"w-3 h-3 mr-1"}),a==="active"?"Activo":"Inactivo"]})})}},{headerName:"Nivel",field:"academicLevel",width:130,filter:"agTextColumnFilter",cellRenderer:t=>{const n=t.data.academicLevel;if(!n)return e.jsx("div",{className:"flex items-center justify-center w-full h-full",children:e.jsx("span",{className:"text-xs text-gray-400",children:"N/A"})});const i=n.code?.toLowerCase()||"",g=i==="basico"||i==="basic"?"bg-[#17BC91]/10 text-[#17BC91] border border-[#17BC91]/30":i==="intermedio"||i==="intermediate"?"bg-[#F98613]/10 text-[#F98613] border border-[#F98613]/30":"bg-[#073372]/10 text-[#073372] border border-[#073372]/30";return e.jsx("div",{className:"flex items-center justify-center w-full h-full",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${g}`,children:n.name})})}},{headerName:"Verificaci√≥n",field:"enrollmentVerified",width:180,filter:"agTextColumnFilter",cellRenderer:t=>{const a=t.data,n=a.enrollmentVerified,i=q.has(a.id);return e.jsxs("div",{className:"flex items-center gap-2 h-full",children:[n?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#17BC91]/10 text-[#17BC91] border border-[#17BC91]/30",children:[e.jsx(M,{className:"w-3 h-3 mr-1"}),"Verificado"]}):i?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700 border border-orange-300",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"En proceso"]}):e.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-[#F98613]/10 text-[#F98613] border border-[#F98613]/30",children:[e.jsx(me,{className:"w-3 h-3 mr-1"}),"Pendiente"]}),e.jsx("button",{onClick:()=>n?ie(a.id):ne(a),disabled:!n&&i,className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 ${n?"bg-[#17BC91] focus:ring-[#17BC91]":i?"bg-gray-200 cursor-not-allowed opacity-50":"bg-gray-300 focus:ring-gray-400"}`,title:n?"Clic para desverificar":i?"Hay documentos pendientes de confirmaci√≥n":"Clic para verificar",children:e.jsx("span",{className:`inline-block h-3.5 w-3.5 transform rounded-full bg-white transition-transform ${n?"translate-x-5":"translate-x-0.5"}`})})]})}},{headerName:"Tipo",field:"studentType",width:150,filter:"agTextColumnFilter",cellRenderer:t=>{const a=t.data,n=a.studentType??"regular",i=a.enrollmentVerified;return e.jsx("div",{className:"flex items-center h-full",children:e.jsx(Pe,{studentType:n,isVerified:i??!1,onSelect:g=>oe(a,g)})})}},{headerName:"Plan",field:"contractedPlan",width:200,filter:"agTextColumnFilter",cellRenderer:t=>{t.data;const a=t.value||"Sin plan";return e.jsx("div",{className:"w-full h-full flex flex-col items-start justify-center",children:e.jsx("div",{className:"text-sm text-gray-900",children:a})})}},{headerName:"Acciones",width:140,cellRenderer:t=>{const a=t.data;return e.jsxs("div",{className:"flex items-center justify-center h-full gap-2",children:[e.jsx("button",{onClick:()=>de(a),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Ver detalles",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>ue(a),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Eliminar aprendiz",children:e.jsx(se,{className:"h-4 w-4"})})]})}}],[fe,q,ne,ie,oe,de]);return e.jsxs(ve,{children:[e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Alumnos Matriculados"}),e.jsx("p",{className:"text-gray-600",children:"Gestiona los aprendices que ya han completado su matr√≠cula"})]})}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{type:"text",label:"Buscar por nombre, email, c√≥digo, tel√©fono, nivel, plan...",value:L,onChange:t=>r(t.target.value),icon:e.jsx($e,{className:"w-4 h-4"}),className:"pr-10"}),L&&e.jsx("button",{onClick:()=>r(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors z-20",children:e.jsx(K,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-1 inline-flex",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>D("verified"),className:`px-6 py-3 rounded-lg font-medium transition-all ${m==="verified"?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(M,{className:"h-4 w-4"}),e.jsx("span",{children:"Verificados"}),e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs",children:u.filter(t=>t.enrollmentVerified).length})]})}),e.jsx("button",{onClick:()=>D("pending"),className:`px-6 py-3 rounded-lg font-medium transition-all ${m==="pending"?"bg-gradient-to-r from-yellow-500 to-orange-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(U,{className:"h-4 w-4"}),e.jsx("span",{children:"No Verificados"}),e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs",children:u.filter(t=>!t.enrollmentVerified).length})]})}),e.jsx("button",{onClick:()=>D("all"),className:`px-6 py-3 rounded-lg font-medium transition-all ${m==="all"?"bg-gradient-to-r from-blue-500 to-purple-500 text-white shadow-md":"text-gray-600 hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx(Y,{className:"h-4 w-4"}),e.jsx("span",{children:"Todos"}),e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded-full text-xs",children:u.length})]})})]})}),e.jsx("div",{className:"ag-theme-quartz",style:{height:"600px",width:"100%"},children:e.jsx(Ne,{theme:we,rowData:he,columnDefs:ge,quickFilterText:L,defaultColDef:{sortable:!0,filter:!0,resizable:!0,flex:1,minWidth:100},pagination:!0,paginationPageSize:10,paginationPageSizeSelector:[5,10,20,50],rowSelection:{mode:"singleRow"},animateRows:!0,domLayout:"normal",rowHeight:70,headerHeight:48,suppressCellFocus:!0,rowClass:"hover:bg-gray-50"})})]}),V&&h&&e.jsx(_e,{student:h,onClose:()=>S(!1),groups:s}),H&&y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",onClick:()=>{c||($(!1),k(null),d([]))},children:e.jsxs("div",{className:"bg-white rounded-3xl max-w-5xl w-full max-h-[90vh] overflow-hidden shadow-2xl animate-scale-in",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] via-[#0d4a8f] to-[#17BC91] px-8 py-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 to-transparent"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx(j,{className:"h-6 w-6"}),"Enviar Documentos para Verificaci√≥n"]}),e.jsxs("p",{className:"text-white/90 text-sm mt-1 flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),y.name," ‚Ä¢ ",y.enrollmentCode]})]}),e.jsx("button",{onClick:()=>{c||($(!1),k(null),d([]))},disabled:c,className:`rounded-full p-2 transition-colors ${c?"text-white/50 cursor-not-allowed":"text-white hover:bg-white/20"}`,children:e.jsx(K,{className:"h-6 w-6"})})]})})]}),e.jsxs("div",{className:"p-8 overflow-y-auto max-h-[calc(90vh-200px)]",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-l-4 border-blue-500 rounded-xl p-5 mb-6 shadow-sm",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(U,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900 mb-2",children:"‚ÑπÔ∏è Informaci√≥n Importante"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1.5",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsxs("span",{children:["Al verificar se enviar√° autom√°ticamente: ",e.jsx("strong",{children:"Comprobante de Pago"})," y ",e.jsx("strong",{children:"Cronograma de Pagos"})]})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Puedes agregar documentos adicionales (contratos, reglamentos, etc.) de forma opcional"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 mt-0.5",children:"‚Ä¢"}),e.jsx("span",{children:"Los documentos adicionales requieren confirmaci√≥n/firma del aprendiz dependiendo de lo que se haya configurado"})]}),f.length>0&&e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 mt-0.5",children:"‚úì"}),e.jsxs("span",{className:"font-medium text-green-700",children:["Se enviar√°n ",f.length," documento(s) adicional(es) que requieren confirmaci√≥n"]})]})]})]})]})}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-indigo-600"}),"Documentos para el Aprendiz"]}),e.jsxs("button",{onClick:N,disabled:c,className:`group relative inline-flex items-center gap-2 px-5 py-2.5 rounded-xl font-medium transition-all duration-200 shadow-md ${c?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-[#17BC91] to-[#14a87d] hover:from-[#14a87d] hover:to-[#17BC91] text-white hover:shadow-lg transform hover:-translate-y-0.5"}`,children:[e.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:rotate-90",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Agregar Documentos"]})]}),f.length===0?e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-2xl p-12 text-center bg-gradient-to-br from-gray-50 to-gray-100 hover:from-gray-100 hover:to-gray-50 transition-all",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-white rounded-full shadow-md",children:e.jsx(j,{className:"h-12 w-12 text-gray-400"})})}),e.jsx("p",{className:"text-base font-medium text-gray-700 mb-2",children:"No hay documentos adicionales"}),e.jsx("p",{className:"text-sm text-gray-500 max-w-md mx-auto",children:"Los documentos adicionales son opcionales. Puedes agregar contratos, reglamentos, etc."}),e.jsx("p",{className:"text-xs text-gray-400 mt-3",children:"‚ÑπÔ∏è Se enviar√°n autom√°ticamente: Comprobante de Pago y Cronograma de Pagos"})]}):e.jsx("div",{className:"space-y-4",children:f.map((t,a)=>e.jsx("div",{className:"border-2 border-gray-200 rounded-2xl p-6 bg-gradient-to-br from-white to-gray-50 hover:shadow-lg transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 pb-4 border-b border-gray-200",children:[e.jsx("div",{className:"p-2.5 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-md",children:e.jsx(j,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:t.file.name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Tama√±o: ",(t.file.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(o,{label:"Nombre del Documento",type:"text",value:t.document_name,onChange:n=>{const i=[...f];i[a].document_name=n.target.value,d(i)},variant:"outlined",required:!0,disabled:c}),e.jsx(Ee,{label:"Tipo de Documento",value:t.document_type,onChange:n=>{const i=[...f];i[a].document_type=n.target.value,d(i)},variant:"outlined",required:!0,disabled:c,children:z.length>0?z.map(n=>e.jsx("option",{value:n.code,children:n.name},n.id)):e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"contract",children:"Contrato"}),e.jsx("option",{value:"regulation",children:"Reglamento"}),e.jsx("option",{value:"terms",children:"T√©rminos y Condiciones"}),e.jsx("option",{value:"other",children:"Otro"})]})})]}),e.jsx(o,{label:"Descripci√≥n o Instrucciones (Opcional)",type:"text",value:t.description,onChange:n=>{const i=[...f];i[a].description=n.target.value,d(i)},variant:"filled",helperText:"Agrega notas o instrucciones para el aprendiz",disabled:c}),e.jsxs("label",{className:`flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200 transition-colors ${c?"cursor-not-allowed opacity-60":"cursor-pointer hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",checked:t.requires_signature,onChange:n=>{const i=[...f];i[a].requires_signature=n.target.checked,d(i)},disabled:c,className:"w-5 h-5 text-[#17BC91] border-gray-300 rounded focus:ring-[#17BC91] focus:ring-2 disabled:cursor-not-allowed"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[e.jsx(M,{className:"h-4 w-4 text-[#17BC91]"}),"Requiere firma/confirmaci√≥n del aprendiz"]})]})]}),e.jsx("button",{onClick:()=>Q(a),disabled:c,className:`flex-shrink-0 group p-3 rounded-xl transition-all duration-200 ${c?"text-gray-400 cursor-not-allowed":"text-red-600 hover:bg-red-50 hover:shadow-md"}`,title:c?"Enviando documentos...":"Eliminar documento",children:e.jsx(K,{className:`w-6 h-6 ${!c&&"group-hover:scale-110"} transition-transform`})})]})},a))})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-8 py-5 border-t border-gray-200 flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-600",children:f.length>0?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-indigo-600"}),e.jsx("strong",{className:"text-gray-900",children:f.length})," documento(s) listo(s) para enviar"]}):e.jsx("span",{className:"text-gray-500",children:"Agrega al menos un documento"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{$(!1),k(null),d([])},disabled:c,className:`px-6 py-2.5 rounded-xl font-medium transition-all duration-200 border-2 ${c?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"text-gray-700 bg-white hover:bg-gray-100 border-gray-300 hover:shadow-md"}`,children:"Cancelar"}),e.jsx("button",{onClick:xe,disabled:c,className:`group relative inline-flex items-center gap-2 px-6 py-2.5 rounded-xl font-medium transition-all duration-200 ${c?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-[#073372] via-[#0d4a8f] to-[#17BC91] hover:from-[#0d4a8f] hover:via-[#073372] hover:to-[#14a87d] text-white shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Verificando matr√≠cula..."]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"h-5 w-5"}),f.length>0?"Verificar y Enviar Documentos":"Verificar Matr√≠cula",f.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-white/20 rounded-full text-xs font-bold",children:f.length})]})})]})]})]})}),W&&p&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",onClick:()=>{v||(F(!1),R(null))},children:e.jsxs("div",{className:"bg-white rounded-3xl max-w-lg w-full overflow-hidden shadow-2xl animate-scale-in",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-red-600 px-8 py-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/5 to-transparent"}),e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(se,{className:"h-7 w-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Eliminar Aprendiz"}),e.jsx("p",{className:"text-white/90 text-sm mt-1",children:"Esta acci√≥n no se puede deshacer"})]})]})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("div",{className:"bg-gray-50 rounded-2xl p-5 mb-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-4",children:[p.avatar?e.jsx("img",{src:`/storage/${p.avatar}`,alt:p.name,className:"w-16 h-16 rounded-full object-cover border-4 border-white shadow-lg"}):e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-[#073372] to-[#17BC91] rounded-full flex items-center justify-center shadow-lg",children:e.jsx("span",{className:"text-white text-xl font-bold",children:p.name.split(" ").map(t=>t[0]).join("")})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:p.name}),e.jsx("p",{className:"text-sm text-gray-600",children:p.email}),p.enrollmentCode&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:["C√≥digo: ",p.enrollmentCode]})]})]})}),e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 rounded-xl p-5 mb-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(U,{className:"h-6 w-6 text-red-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-red-900 mb-2",children:"‚ö†Ô∏è Advertencia: Eliminaci√≥n Permanente"}),e.jsxs("ul",{className:"text-sm text-red-800 space-y-1.5 list-disc list-inside",children:[e.jsx("li",{children:"Se eliminar√° la cuenta del usuario"}),e.jsx("li",{children:"Se eliminar√°n todos los documentos de matr√≠cula"}),e.jsx("li",{children:"Se eliminar√°n las solicitudes de clases"}),e.jsx("li",{children:"Se eliminar√°n los registros de clases y asistencia"}),e.jsx("li",{children:"Se eliminar√° el contrato si existe"}),e.jsx("li",{children:e.jsx("strong",{children:"Esta acci√≥n NO se puede deshacer"})})]})]})]})}),e.jsx("p",{className:"text-center text-gray-700 mb-2",children:"¬øEst√°s seguro de que deseas eliminar a este aprendiz?"}),e.jsx("p",{className:"text-center text-sm text-gray-500",children:"Escribe el nombre del aprendiz para confirmar:"}),e.jsx("div",{className:"mt-4",children:e.jsx("input",{type:"text",id:"deleteConfirmationInput",placeholder:p.name,className:"w-full px-4 py-3 border-2 text-gray-900 border-gray-300 rounded-xl focus:border-red-500 focus:ring-2 focus:ring-red-200 transition-all text-center font-medium",autoComplete:"off"})})]}),e.jsxs("div",{className:"bg-gray-50 px-8 py-5 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{F(!1),R(null)},disabled:v,className:`px-6 py-2.5 rounded-xl font-medium transition-all duration-200 border-2 ${v?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"text-gray-700 bg-white hover:bg-gray-100 border-gray-300 hover:shadow-md"}`,children:"Cancelar"}),e.jsx("button",{onClick:()=>{const t=document.getElementById("deleteConfirmationInput");t&&t.value.trim().toLowerCase()===p.name.toLowerCase()?pe():b.fire({title:"Nombre incorrecto",text:"Por favor, escribe el nombre exacto del aprendiz para confirmar la eliminaci√≥n.",icon:"warning",confirmButtonColor:"#f59e0b",confirmButtonText:"Entendido",customClass:{confirmButton:"px-6 py-2.5 rounded-xl font-medium"}})},disabled:v,className:`group relative inline-flex items-center gap-2 px-6 py-2.5 rounded-xl font-medium transition-all duration-200 ${v?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 text-white shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"}`,children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),"Eliminando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-5 w-5"}),"Eliminar Aprendiz"]})})]})]})})]})};export{ft as default};
