import{r as o,d as v,U as N,j as e,a as b}from"./app-BYV62cDu.js";import{T as y,w,H as C,x as k,l as P,X as j,Y as D,t as x}from"./DocumentConfirmationModal-BYN4fF8Y.js";/* empty css            */import"./button-BJn5UaVm.js";import"./clsx-B-dksMZM.js";import"./dropdown-menu-BAEe9cJy.js";import"./createLucideIcon-6SHTFon0.js";import"./index-B8HOWM92.js";import"./index-Bju26oEr.js";import"./index-l3Zsz6n-.js";import"./badge-DsPICywl.js";import"./x-DsmFtbob.js";import"./triangle-alert-CMUJ9rsX.js";import"./circle-check-big-CfJpx-x5.js";import"./clock-B4cKxM-S.js";function L({children:r}){const[n,s]=o.useState("dashboard"),[h,i]=o.useState(!1),[p,c]=o.useState(!1),{props:d}=v(),l=d.auth?.user?.role==="student",m=l?d.student:null,g=m?.contract&&!m.contract.accepted,f=async()=>{try{((await b.get("/api/student/pending-documents")).data.count||0)>0&&(c(!0),i(!0))}catch(t){console.error("Error checking pending documents:",t)}},a=()=>{c(!1),i(!1)};return o.useEffect(()=>{l&&f()},[l]),N.useEffect(()=>{const t=window.location.pathname;t.includes("/admin/enrolled-students")?s("enrolled-students"):t.includes("/admin/students")?s("students"):t.includes("/admin/teachers")?s("teachers"):t.includes("/admin/groups")?s("groups"):t.includes("/admin/academic-levels")?s("academic-levels"):t.includes("/admin/payment-plans")?s("payment-plans"):t==="/dashboard"&&s("dashboard")},[]),e.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-slate-100 flex overflow-hidden",children:[e.jsx(y,{position:"top-right",richColors:!0,closeButton:!0,toastOptions:{style:{fontSize:"14px"}}}),e.jsx(w,{activeView:n,onViewChange:s,hasUnsignedContract:g}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(C,{}),e.jsxs("main",{className:"flex-1 relative overflow-y-auto main-scroll bg-white",children:[e.jsx("div",{className:"absolute w-full h-full opacity-20 z-0 pointer-events-none",children:e.jsx("img",{src:"/wave.svg",alt:"",className:"absolute top-0 right-0 w-auto h-40 object-contain transform "})}),e.jsx("div",{className:"relative z-10 animate-fade-in",children:r})]})]}),l&&h&&e.jsx(k,{open:h,onClose:()=>i(!1),onDocumentsConfirmed:a})]})}const G=({contract:r,student:n})=>{const[s,h]=o.useState(!1),[i,p]=o.useState(!1),[c,d]=o.useState(null),[l,m]=o.useState(null),g=a=>{const t=a.target.files?.[0];if(t){if(!t.type.startsWith("image/")){x.error("Archivo inv√°lido",{description:"Por favor, sube solo archivos de imagen (JPG, PNG, etc.)",duration:4e3});return}if(t.size>2*1024*1024){x.error("Archivo muy grande",{description:"La imagen no debe superar los 2MB",duration:4e3});return}d(t);const u=new FileReader;u.onloadend=()=>{m(u.result)},u.readAsDataURL(t)}},f=async()=>{if(!s){x.error("Debes aceptar los t√©rminos",{description:"Por favor, marca el checkbox para confirmar que aceptas el contrato",duration:4e3});return}p(!0);try{const a=new FormData;c&&a.append("signature",c),await b.post(`/contract/accept/${r.token}`,a,{headers:{"Content-Type":"multipart/form-data"}}),x.success("¬°Contrato aceptado exitosamente!",{description:"Tu matr√≠cula ha sido confirmada. Recibir√°s un correo con el contrato.",duration:5e3}),setTimeout(()=>{window.location.href="/dashboard"},1500)}catch(a){console.error("Error al firmar contrato:",a);const t=a.response?.data?.message||"No se pudo procesar tu solicitud";x.error("Error al aceptar contrato",{description:t,duration:5e3})}finally{p(!1)}};return e.jsx(L,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8 px-4",children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg mb-6 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] px-8 py-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Contrato de Matr√≠cula"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Plataforma de Ingl√©s"})]})]})}),e.jsx("div",{className:"px-8 py-6 bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Aprendiz"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:n.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Correo Electr√≥nico"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:n.email})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nivel Acad√©mico"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:n.academic_level})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Plan de Pago"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:n.payment_plan})]})]})})]}),r.accepted&&e.jsxs("div",{className:"bg-green-50 border-2 border-green-200 rounded-xl p-6 mb-6 flex items-start gap-4",children:[e.jsx(j,{className:"w-8 h-8 text-green-600 flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-green-900 mb-1",children:"Contrato Aceptado"}),e.jsxs("p",{className:"text-green-700",children:["Ya has aceptado este contrato el"," ",r.accepted_at&&new Date(r.accepted_at).toLocaleString("es-PE",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-lg p-8 mb-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-gradient-to-r from-[#073372] to-[#17BC91] rounded-full mb-4",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contrato de Matr√≠cula (PDF)"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"El contrato fue enviado a tu correo electr√≥nico adjunto como PDF"}),r.pdf_url&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs("a",{href:r.pdf_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-[#073372] to-[#17BC91] hover:shadow-lg text-white rounded-lg font-semibold transition-all duration-200",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Ver PDF en el Navegador"]}),e.jsxs("a",{href:r.pdf_url,download:"Contrato_Matricula.pdf",className:"inline-flex items-center justify-center gap-2 px-6 py-3 border-2 border-[#073372] text-[#073372] hover:bg-[#073372]/5 rounded-lg font-semibold transition-all duration-200",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descargar PDF"]})]}),e.jsx("div",{className:"mt-6 bg-blue-50 border-l-4 border-[#073372] rounded-lg p-4 text-left",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"üìß Revisa tu correo:"})," El contrato tambi√©n fue enviado como adjunto a ",e.jsx("strong",{children:n.email})]})})]})}),!r.accepted&&e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8",children:[e.jsxs("div",{className:"bg-blue-50 border-l-4 border-[#073372] rounded-lg p-4 mb-6 flex items-start gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-[#073372] flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Importante:"})," Aseg√∫rate de haber le√≠do completamente el contrato PDF antes de aceptar. Al aceptar, confirmas que est√°s de acuerdo con todos los t√©rminos y condiciones."]})})]}),e.jsxs("div",{className:"flex items-start gap-3 mb-6",children:[e.jsx("input",{type:"checkbox",id:"accept-contract",checked:s,onChange:a=>h(a.target.checked),className:"mt-1 w-5 h-5 text-[#17BC91] border-gray-300 rounded focus:ring-[#17BC91] cursor-pointer"}),e.jsxs("label",{htmlFor:"accept-contract",className:"cursor-pointer select-none",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:"Confirmo que he le√≠do el contrato PDF adjunto y acepto todos los t√©rminos y condiciones"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:'Al marcar esta casilla y hacer clic en "Firmar Contrato", confirmas que has revisado el documento PDF completo y aceptas todos sus t√©rminos de manera consciente y voluntaria.'})]})]}),e.jsx("div",{className:"border-2 border-dashed border-[#073372]/30 rounded-xl p-6 mb-6 bg-gradient-to-br from-blue-50/50 to-green-50/50",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-[#073372] to-[#17BC91] rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Firma Digital (Opcional)"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Si deseas, puedes subir una imagen de tu firma. ",e.jsx("strong",{children:"No es obligatorio"}),"; al marcar la casilla de aceptaci√≥n arriba, tu consentimiento es igualmente v√°lido."]}),e.jsx("div",{className:"space-y-3",children:l?e.jsxs("div",{className:"bg-white border-2 border-[#17BC91] rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("span",{className:"text-sm font-semibold text-green-700 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Firma cargada correctamente"]}),e.jsx("button",{onClick:()=>{d(null),m(null)},className:"text-sm text-red-600 hover:text-red-700 font-medium",children:"Cambiar"})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded p-4 flex justify-center",children:e.jsx("img",{src:l,alt:"Vista previa de firma",className:"max-h-32 object-contain"})})]}):e.jsx("label",{className:"block cursor-pointer",children:e.jsxs("div",{className:"border-2 border-[#073372] border-dashed rounded-lg p-4 text-center hover:bg-[#073372]/5 transition-colors",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden"}),e.jsx("svg",{className:"w-10 h-10 mx-auto mb-2 text-[#073372]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("p",{className:"text-sm font-semibold text-[#073372]",children:"Haz clic para subir tu firma"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"JPG, PNG (m√°x. 2MB)"})]})})}),e.jsx("div",{className:"mt-3 bg-yellow-50 border-l-4 border-yellow-400 p-3 rounded",children:e.jsxs("p",{className:"text-xs text-yellow-800",children:[e.jsx("strong",{children:"üí° Importante:"})," La firma debe estar en ",e.jsx("strong",{children:"fondo blanco"})," y ser legible. Esta firma aparecer√° en tu contrato oficial."]})})]})]})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:f,disabled:!s||i,className:`w-full sm:w-auto flex items-center justify-center gap-2 px-8 py-4 rounded-xl font-bold text-lg transition-all duration-200 ${s&&!i?"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white hover:shadow-xl hover:scale-[1.02]":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:i?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Procesando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-6 h-6"}),"Firmar y Aceptar Contrato"]})})}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-6",children:"Tu IP ser√° registrada junto con la fecha y hora de aceptaci√≥n para fines de verificaci√≥n."})]})]})})})};export{G as default};
