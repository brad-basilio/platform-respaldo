import{r as i,a as x,j as e}from"./app-5evAXsbO.js";import{t as m,j as D,D as oe}from"./DocumentConfirmationModal-CuhEi6r-.js";import{A as S}from"./AuthenticatedLayout-0Vskb9Gw.js";import{I as ne}from"./input-ZQl_2gTR.js";import{C as p}from"./circle-alert-CmugtSuC.js";import{c as G}from"./createLucideIcon-BVOeXp00.js";import{D as R}from"./dollar-sign-D9tIszTh.js";import{T as de}from"./trending-up-mn3KzjdA.js";import{C as V}from"./circle-check-big-Be57Sw-G.js";import{C as f}from"./clock-C7-in3OB.js";import{F as $}from"./file-text-CyIZQdiu.js";import{C as ie}from"./calendar-COeOJsgm.js";import{X as z}from"./dropdown-menu-DOrWWT7k.js";/* empty css            */import"./button-C5QSEga4.js";import"./clsx-B-dksMZM.js";import"./badge-zjXUrP1Q.js";import"./index-HCsiP8YO.js";import"./triangle-alert-BfIeoiHO.js";import"./index-D0CtO2s2.js";import"./index-DvrEJ-OR.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],me=G("ArrowRight",ce);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],pe=G("RefreshCcw",xe),Be=()=>{const[l,O]=i.useState(null),[I,F]=i.useState(!0),[j,b]=i.useState(null),[q,g]=i.useState(!1),[X,Y]=i.useState([]),[H,J]=i.useState(!1),[k,K]=i.useState(""),[u,Q]=i.useState(null),[T,U]=i.useState(!1),[W,N]=i.useState(!1),[d,y]=i.useState(""),[v,M]=i.useState(!1);i.useEffect(()=>{h(),A()},[]);const h=async()=>{try{F(!0);const a=(await x.get("/api/student/enrollment")).data.enrollment,t=a.paymentPlan.gracePeriodDays||0;a.installments=a.installments.map(r=>{const n=new Date,c=new Date(n.getFullYear(),n.getMonth(),n.getDate());console.log("üïê Fecha del sistema:",n.toString()),console.log("üïê Fecha local procesada:",c.toString()),console.log("üïê Fecha ISO:",n.toISOString());const[P,te,re]=r.dueDate.split("-").map(Number),E=new Date(P,te-1,re),le=E.getTime()-c.getTime(),B=Math.round(le/(1e3*60*60*24)),C=new Date(E);C.setDate(C.getDate()+t);const L=Math.round((C.getTime()-c.getTime())/(1e3*60*60*24));return console.log("üìÖ Cuota #"+r.installmentNumber+":",{hoyLocal:c.toISOString().split("T")[0],fechaVencimiento:r.dueDate,diffDays:B,gracePeriodDays:t,daysUntilGraceLimit:L}),{...r,daysUntilDue:B,daysUntilGraceLimit:L,gracePeriodDays:t}}),O(a)}catch(s){console.error("Error fetching enrollment:",s);const a=s;m.error("Error al cargar informaci√≥n de pagos",{description:a.response?.data?.message||"No se pudo obtener tu cronograma de pagos"})}finally{F(!1)}},A=async()=>{try{const s=await x.get("/api/student/can-change-plan");if(J(s.data.can_change),s.data.can_change){const a=await x.get("/api/student/available-plans");Y(a.data.plans)}}catch(s){console.error("Error checking plan change eligibility:",s)}},Z=async()=>{if(!u){m.error("Debes seleccionar un plan");return}try{U(!0),await x.post("/api/student/change-plan",{new_plan_id:u,reason:k||"Cambio solicitado por el estudiante"}),m.success("Plan de pago cambiado exitosamente",{description:"Tu cronograma de pagos ha sido actualizado"}),g(!1),await h(),await A()}catch(s){const a=s;m.error("Error al cambiar plan de pago",{description:a.response?.data?.message||"No se pudo cambiar el plan"})}finally{U(!1)}},_=async s=>{if(!d||parseFloat(d)<=0){m.error("Ingresa un monto v√°lido");return}if(parseFloat(d)>(l?.totalPending||0)){m.error("Monto inv√°lido",{description:`El monto no puede ser mayor a tu deuda pendiente (${o(l?.totalPending||0)})`});return}try{M(!0);const t=new FormData;t.append("voucher_file",s),t.append("declared_amount",d),t.append("payment_date",new Date().toISOString().split("T")[0]),t.append("payment_method","transfer"),t.append("is_partial_payment","1");for(const n of Array.from(t.keys()))console.log("formData key:",n,t.get(n));const r=await x.post("/api/student/upload-voucher",t,{headers:{"Content-Type":"multipart/form-data"}});m.success("Pago parcial procesado exitosamente",{description:`S/ ${r.data.amount_distributed} distribuido a ${r.data.affected_installments} cuota(s)`}),N(!1),y(""),await h()}catch(t){const r=t;m.error("Error al procesar pago parcial",{description:r.response?.data?.message||"No se pudo procesar el pago"})}finally{M(!1)}},ee=async(s,a)=>{try{b(s);const t=new FormData;t.append("voucher_file",a),t.append("installment_id",s),t.append("declared_amount",String(l?.installments.find(r=>r.id===s)?.totalDue||l?.installments.find(r=>r.id===s)?.amount||0)),t.append("payment_date",new Date().toISOString().split("T")[0]),t.append("payment_method","transfer"),await x.post("/api/student/upload-voucher",t,{headers:{"Content-Type":"multipart/form-data"}}),m.success("Voucher subido exitosamente",{description:"Tu comprobante est√° siendo verificado por el cajero"}),await h()}catch(t){console.error("Error uploading voucher:",t);const r=t;console.error("Server response:",r.response?.data);const n=r.response?.data,c=n&&typeof n=="object"&&"message"in n?n.message:String(n??"");m.error("Error al subir voucher",{description:c||"No se pudo subir el comprobante"})}finally{b(null)}},se=async(s,a,t)=>{try{b(a);const r=new FormData;r.append("voucher_file",t),r.append("declared_amount",String(l?.installments.find(n=>n.id===a)?.totalDue||l?.installments.find(n=>n.id===a)?.amount||0)),r.append("payment_date",new Date().toISOString().split("T")[0]),r.append("payment_method","transfer"),await x.post(`/api/student/vouchers/${s}/replace`,r,{headers:{"Content-Type":"multipart/form-data"}}),m.success("Voucher reemplazado exitosamente",{description:"El nuevo comprobante est√° siendo verificado"}),await h()}catch(r){console.error("Error replacing voucher:",r);const n=r;console.error("Server response:",n.response?.data);const c=n.response?.data,P=c&&typeof c=="object"&&"message"in c?c.message:String(c??"");m.error("Error al reemplazar voucher",{description:P||"No se pudo reemplazar el comprobante"})}finally{b(null)}},ae=s=>{if(s.status==="verified")return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#17BC91]/10 text-[#17BC91] border border-[#17BC91]/30",children:[e.jsx(V,{className:"w-3 h-3 mr-1"}),"Verificado"]});if(s.status==="paid"){if(s.paymentType==="partial"||s.paymentType==="combined"){const n=s.paidAmount||0;return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 border border-blue-300",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Pago Parcial: ",o(n)," de ",o(s.totalDue)]})}return e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#073372]/10 text-[#073372] border border-[#073372]/30",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"En Verificaci√≥n"]})}const a=s.daysUntilDue||0,t=s.daysUntilGraceLimit||0,r=s.gracePeriodDays||0;return a<0&&t>=0&&r>0?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800 border border-orange-300",children:[e.jsx(p,{className:"w-3 h-3 mr-1"}),"Per√≠odo de Gracia (",t," d√≠as restantes)"]}):s.isOverdue||t<0&&s.status==="pending"?e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800 border border-red-300",children:[e.jsx(p,{className:"w-3 h-3 mr-1"}),"Vencido con Mora (",Math.abs(t)," d√≠as)"]}):e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-[#F98613]/10 text-[#F98613] border border-[#F98613]/30",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Pendiente (",a>0?`${a} d√≠as`:"Vence hoy",")"]})},o=s=>new Intl.NumberFormat("es-PE",{style:"currency",currency:"PEN"}).format(s),w=s=>new Date(s).toLocaleDateString("es-PE",{year:"numeric",month:"long",day:"numeric"});return I?e.jsx(S,{children:e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Cargando informaci√≥n de pagos..."})]})})}):l?e.jsx(S,{children:e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"Control de Pagos"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Gestiona tus cuotas y comprobantes de pago"})]}),e.jsxs("div",{className:"flex gap-3",children:[H&&e.jsxs("button",{onClick:()=>g(!0),className:"inline-flex items-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-all shadow-md hover:shadow-lg",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Cambiar Plan"]}),e.jsxs("button",{onClick:()=>N(!0),className:"inline-flex items-center px-4 py-2 bg-[#17BC91] hover:bg-[#17BC91]/90 text-white font-medium rounded-lg transition-all shadow-md hover:shadow-lg",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Pago Parcial"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-[#073372] to-[#17BC91] text-white rounded-2xl p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(R,{className:"w-8 h-8 opacity-80"}),e.jsx(de,{className:"w-5 h-5 opacity-60"})]}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total a Pagar"}),e.jsx("p",{className:"text-2xl font-bold",children:o(l.paymentPlan.totalAmount)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(V,{className:"w-8 h-8 text-[#17BC91]"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Pagado"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:o(l.totalPaid)}),e.jsxs("p",{className:"text-xs text-[#17BC91] mt-1",children:[l.paymentProgress.toFixed(0),"% completado"]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(f,{className:"w-8 h-8 text-[#F98613]"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Pendiente"}),e.jsx("p",{className:"text-2xl font-bold text-slate-900",children:o(l.totalPending)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx($,{className:"w-8 h-8 text-[#073372]"})}),e.jsx("p",{className:"text-sm text-slate-600 mb-1",children:"Plan de Pago"}),e.jsxs("p",{className:"text-xl font-bold text-slate-900",children:[l.paymentPlan.installmentsCount," cuotas"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:l.paymentPlan.name})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-900",children:"Progreso de Pagos"}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[l.paymentProgress.toFixed(0),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 h-3 rounded-full transition-all duration-500",style:{width:`${l.paymentProgress}%`}})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200",children:[e.jsxs("div",{className:"p-6 border-b border-slate-200",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"Cronograma de Cuotas"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Administra tus pagos mensuales y sube tus comprobantes"})]}),e.jsx("div",{className:"divide-y divide-slate-200",children:l.installments.map(s=>e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:["Cuota #",s.installmentNumber]}),ae(s)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Fecha de Vencimiento"}),e.jsxs("p",{className:"font-medium text-slate-900 flex items-center",children:[e.jsx(ie,{className:"w-4 h-4 mr-1 text-blue-600"}),w(s.dueDate)]}),s.daysUntilDue!==void 0&&s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:`text-xs mt-1 ${s.daysUntilDue<7&&s.daysUntilDue>=0?"text-orange-600 font-semibold":s.daysUntilDue<0?"text-red-600":"text-slate-500"}`,children:s.daysUntilDue>0?`Faltan ${s.daysUntilDue} d√≠as`:s.daysUntilDue===0?"¬°Vence hoy!":`Vencido hace ${Math.abs(s.daysUntilDue)} d√≠as`}),s.daysUntilDue<0&&s.daysUntilGraceLimit!==void 0&&s.daysUntilGraceLimit>=0&&s.gracePeriodDays&&s.gracePeriodDays>0&&e.jsxs("p",{className:"text-xs mt-1 text-orange-600 font-semibold bg-orange-50 px-2 py-1 rounded inline-block",children:["‚ö†Ô∏è Per√≠odo de gracia: ",s.daysUntilGraceLimit," d√≠as restantes"]}),s.daysUntilGraceLimit!==void 0&&s.daysUntilGraceLimit<0&&e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{className:"text-xs text-red-600 font-bold bg-red-50 px-2 py-1 rounded inline-block",children:["üö® Mora aplicada (",Math.abs(s.daysUntilGraceLimit)," d√≠as)"]}),s.lateFee>0&&e.jsxs("p",{className:"text-xs text-red-700 font-bold bg-red-100 px-2 py-1 rounded inline-block",children:["üí∞ Recargo por mora: ",o(s.lateFee)]})]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Monto"}),e.jsx("p",{className:"font-bold text-slate-900",children:o(s.amount)}),s.lateFee>0&&e.jsxs("p",{className:"text-xs text-red-600 mt-1 font-semibold",children:["+ ",o(s.lateFee)," mora"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Total a Pagar"}),e.jsx("p",{className:"font-bold text-blue-600",children:o(s.totalDue)}),s.lateFee>0&&e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"(Incluye mora)"}),(s.paymentType==="partial"||s.paymentType==="combined")&&s.remainingAmount&&s.remainingAmount>0&&e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsxs("p",{className:"text-xs text-blue-600 font-semibold",children:["Pagado: ",o(s.paidAmount)]}),e.jsxs("p",{className:"text-xs text-orange-600 font-semibold",children:["Restante: ",o(s.remainingAmount)]}),e.jsx("div",{className:"w-full bg-slate-200 rounded-full h-1.5 mt-1",children:e.jsx("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:{width:`${s.paidAmount/s.totalDue*100}%`}})})]})]}),s.paidDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 mb-1",children:"Fecha de Pago"}),e.jsx("p",{className:"font-medium text-green-600",children:w(s.paidDate)})]})]})]})}),s.vouchers.length>0&&e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:"Comprobantes Subidos:"}),s.vouchers.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg border border-slate-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx($,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-900",children:o(a.declaredAmount)}),e.jsxs("p",{className:"text-xs text-slate-500",children:[w(a.paymentDate)," ¬∑ ",a.paymentMethod]}),a.status==="rejected"&&a.rejectionReason&&e.jsxs("p",{className:"text-xs text-red-600 mt-1 italic",children:["Motivo: ",a.rejectionReason]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[a.status==="approved"&&e.jsx("span",{className:"text-xs px-3 py-1 bg-green-100 text-green-800 rounded-full font-medium",children:"‚úì Aprobado"}),a.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full font-medium animate-pulse",children:"‚è≥ En revisi√≥n"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:t=>{const r=t.target.files?.[0];r&&se(a.id,s.id,r)},disabled:j===s.id,className:"hidden"}),e.jsxs("div",{className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-medium rounded-lg transition-colors flex items-center space-x-1",children:[e.jsx(D,{className:"w-3 h-3"}),e.jsx("span",{children:"Reemplazar"})]})]})]}),a.status==="rejected"&&e.jsx("span",{className:"text-xs px-3 py-1 bg-red-100 text-red-800 rounded-full font-medium",children:"‚úó Rechazado"}),e.jsx("a",{href:a.voucherUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 hover:bg-white rounded-lg transition-colors",title:"Descargar voucher",children:e.jsx(oe,{className:"w-4 h-4 text-blue-600"})})]})]},a.id))]}),(s.status==="pending"||s.status==="late"||s.isOverdue)&&(!s.vouchers.length||s.vouchers.every(a=>a.status==="rejected"))&&e.jsxs("div",{className:"mt-4",children:[s.vouchers.some(a=>a.status==="rejected")&&e.jsx("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800 font-medium flex items-center",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Tu voucher anterior fue rechazado. Por favor, sube un nuevo comprobante v√°lido."]})}),s.lateFee>0&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-orange-800 font-bold flex items-center",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Esta cuota tiene mora. Debes pagar el total: ",o(s.totalDue)]}),e.jsxs("p",{className:"text-xs text-orange-700 mt-1",children:["Monto original: ",o(s.amount)," + Mora: ",o(s.lateFee)]})]}),e.jsxs("label",{className:"block",children:[e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:a=>{const t=a.target.files?.[0];t&&ee(s.id,t)},disabled:j===s.id,className:"hidden"}),e.jsx("div",{className:"flex items-center justify-center px-4 py-3 border-2 border-dashed border-slate-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 cursor-pointer transition-all",children:j===s.id?e.jsxs("div",{className:"flex items-center space-x-2 text-blue-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Subiendo..."})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-slate-600",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:s.vouchers.some(a=>a.status==="rejected")?"Subir Nuevo Comprobante":"Subir Comprobante de Pago"})]})})]})]})]},s.id))})]}),q&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Cambiar Plan de Pago"}),e.jsx("button",{onClick:()=>g(!1),className:"text-slate-400 hover:text-slate-600 transition-colors",children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900 mb-2",children:"Plan Actual:"}),e.jsx("p",{className:"text-lg font-bold text-blue-700",children:l.paymentPlan.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-600",children:"Total:"}),e.jsx("p",{className:"font-bold text-blue-900",children:o(l.paymentPlan.totalAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-600",children:"Cuotas:"}),e.jsxs("p",{className:"font-bold text-blue-900",children:[l.paymentPlan.installmentsCount," mensuales"]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-3",children:"Selecciona tu nuevo plan:"}),e.jsx("div",{className:"space-y-3",children:X.map(s=>e.jsxs("label",{className:`block p-4 border-2 rounded-lg cursor-pointer transition-all ${u===s.id?"border-[#17BC91] bg-[#17BC91]/5":"border-slate-200 hover:border-slate-300"}`,children:[e.jsx("input",{type:"radio",name:"new_plan",value:s.id,checked:u===s.id,onChange:()=>Q(s.id),className:"hidden"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-900",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 mt-1",children:[s.installmentsCount," cuotas de ",o(s.monthlyAmount)]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-slate-600",children:"Total"}),e.jsx("p",{className:"text-lg font-bold text-[#073372]",children:o(s.totalAmount)})]})]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Raz√≥n del cambio (opcional):"}),e.jsx("textarea",{value:k,onChange:s=>K(s.target.value),placeholder:"Ej: Cambio por disponibilidad econ√≥mica",rows:3,className:"w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]}),e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-orange-900",children:[e.jsx("strong",{children:"‚ö†Ô∏è Importante:"})," Al cambiar de plan, tus cuotas pendientes ser√°n canceladas y se generar√°n nuevas seg√∫n el plan seleccionado."]})}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>g(!1),className:"px-6 py-2 border border-slate-300 text-slate-700 font-medium rounded-lg hover:bg-slate-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:Z,disabled:!u||T,className:"px-6 py-2 bg-[#17BC91] hover:bg-[#17BC91]/90 text-white font-medium rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:T?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Cambiando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Confirmar Cambio"]})})]})]})]})}),W&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-6 py-4 rounded-t-2xl flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Pago Parcial"}),e.jsx("button",{onClick:()=>{N(!1),y("")},className:"text-white/80 hover:text-white transition-colors",children:e.jsx(z,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-slate-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-600",children:"Total del plan:"}),e.jsx("p",{className:"text-lg font-bold text-slate-900",children:o(l.paymentPlan.totalAmount)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-600",children:"Pendiente:"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:o(l.totalPending)})]})]})}),e.jsxs("div",{children:[e.jsx("div",{className:"relative",children:e.jsx(ne,{label:"Monto a pagar",type:"number",value:d,onChange:s=>y(s.target.value),placeholder:"0.00",min:.01,max:l.totalPending,step:.01,icon:e.jsx("span",{className:"text-slate-500 font-medium",children:"S/"}),helperText:`Monto m√°ximo: ${o(l.totalPending)}`,variant:"outlined"})}),d&&parseFloat(d)>l.totalPending&&e.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800 font-medium flex items-center",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"El monto ingresado (",o(parseFloat(d)),") excede tu deuda pendiente (",o(l.totalPending),")"]})})]}),d&&parseFloat(d)>0&&parseFloat(d)<=l.totalPending&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm font-medium text-green-900 mb-2",children:"‚úÖ Distribuci√≥n autom√°tica:"}),e.jsxs("p",{className:"text-xs text-green-700",children:["El monto de ",o(parseFloat(d))," se aplicar√° a tus cuotas m√°s antiguas primero, cubriendo mora si existe."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Comprobante de pago:"}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:s=>{const a=s.target.files?.[0];a&&_(a)},disabled:v||!d||parseFloat(d)<=0||parseFloat(d)>l.totalPending,className:"hidden",id:"partial-payment-file"}),e.jsx("label",{htmlFor:"partial-payment-file",className:`block w-full px-4 py-3 border-2 border-dashed rounded-lg text-center cursor-pointer transition-all ${v||!d||parseFloat(d)<=0||parseFloat(d)>l.totalPending?"border-slate-200 bg-slate-50 cursor-not-allowed":"border-[#17BC91] hover:bg-[#17BC91]/5"}`,children:v?e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-[#17BC91]",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-[#17BC91]"}),e.jsx("span",{className:"font-medium",children:"Procesando..."})]}):e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-slate-700",children:[e.jsx(D,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Seleccionar comprobante"})]})})]})]})]})})]})}):e.jsx(S,{children:e.jsx("div",{className:"p-8 max-w-7xl mx-auto",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-2xl p-6 text-center",children:[e.jsx(p,{className:"w-12 h-12 text-yellow-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No tienes matr√≠cula activa"}),e.jsx("p",{className:"text-slate-600",children:"Contacta con el √°rea de admisiones para m√°s informaci√≥n."})]})})})};export{Be as default};
