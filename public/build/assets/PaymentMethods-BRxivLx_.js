import{r as a,a as n,j as e,H as E}from"./app-CRXIbkRX.js";import{t as r,A as M}from"./AuthenticatedLayout-CS_JLXnO.js";import{P as T,T as V}from"./trash-2-BteDD7k4.js";import{C as F}from"./credit-card-BYtheTVh.js";import{C as i}from"./check-CFGeWEP_.js";import{L as b}from"./lock-DB6PcHCN.js";import{X as H}from"./dropdown-menu-CNwWpTew.js";import{C as R}from"./circle-alert-DJGHaKnK.js";/* empty css            */import"./button-BbxfAtFR.js";import"./clsx-B-dksMZM.js";import"./badge-DTsbhX50.js";import"./index-DdPhrC9v.js";import"./createLucideIcon-Bx3aWViy.js";import"./file-text-yushF4BN.js";import"./triangle-alert-C-L5Ln0U.js";import"./circle-check-big-Ce7OE-zm.js";import"./clock-BKYJ0m7C.js";import"./index-CcEAFytD.js";import"./index-BDKl7pZd.js";const xe=()=>{const[m,B]=a.useState([]),[S,g]=a.useState(!0),[D,l]=a.useState(!1),[d,j]=a.useState(!1),[c,f]=a.useState(""),[x,N]=a.useState(""),[u,v]=a.useState(""),[p,w]=a.useState(""),[y,C]=a.useState(""),[k,A]=a.useState(!1),[P,_]=a.useState(!1);a.useEffect(()=>{o()},[]);const o=async()=>{try{g(!0);const s=await n.get("/api/student/payment-methods");B(s.data.payment_methods||[])}catch(s){console.error("Error fetching payment methods:",s),r.error("Error al cargar los mÃ©todos de pago")}finally{g(!1)}},L=async s=>{try{await n.put(`/api/student/payment-methods/${s}`,{is_default:!0}),r.success("Tarjeta marcada como predeterminada"),o()}catch{r.error("Error al actualizar la tarjeta")}},$=async(s,t)=>{try{await n.put(`/api/student/payment-methods/${s}`,{auto_payment_enabled:!t}),r.success(t?"Pagos automÃ¡ticos deshabilitados":"Pagos automÃ¡ticos habilitados"),o()}catch{r.error("Error al actualizar configuraciÃ³n")}},Y=async s=>{if(confirm("Â¿EstÃ¡s seguro de eliminar esta tarjeta?"))try{await n.delete(`/api/student/payment-methods/${s}`),r.success("Tarjeta eliminada exitosamente"),o()}catch{r.error("Error al eliminar la tarjeta")}},q=async()=>{if(!c||!x||!u||!p||!y){r.error("Por favor, completa todos los campos");return}j(!0);try{const s=`tok_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,t=await n.post("/api/student/payment-methods",{culqi_card_id:s,culqi_customer_id:`cus_${Date.now()}`,card_brand:z(c),card_last4:c.slice(-4),card_exp_month:u.padStart(2,"0"),card_exp_year:p,cardholder_name:x,is_default:k,auto_payment_enabled:P});r.success("Tarjeta guardada exitosamente"),l(!1),h(),o()}catch(s){r.error(s.response?.data?.message||"Error al guardar la tarjeta")}finally{j(!1)}},z=s=>{const t=s.replace(/\s/g,"");return/^4/.test(t)?"visa":/^5[1-5]/.test(t)?"mastercard":/^3[47]/.test(t)?"amex":"unknown"},h=()=>{f(""),N(""),v(""),w(""),C(""),A(!1),_(!1)},G=s=>({visa:"ðŸ’³",mastercard:"ðŸ’³",amex:"ðŸ’³"})[s.toLowerCase()]||"ðŸ’³";return S?e.jsxs(M,{children:[e.jsx(E,{title:"MÃ©todos de Pago"}),e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Cargando mÃ©todos de pago..."})]})})]}):e.jsxs(M,{children:[e.jsx(E,{title:"MÃ©todos de Pago"}),e.jsxs("div",{className:"p-8 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-900 tracking-tight",children:"MÃ©todos de Pago"}),e.jsx("p",{className:"text-slate-600 mt-1",children:"Gestiona tus tarjetas y configuraciÃ³n de pagos"})]}),e.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-xl hover:shadow-lg transition-all",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),"Agregar Tarjeta"]})]}),m.length===0?e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg border border-slate-200 p-12 text-center",children:[e.jsx(F,{className:"w-16 h-16 text-slate-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No tienes tarjetas guardadas"}),e.jsx("p",{className:"text-slate-600 mb-6",children:"Agrega una tarjeta para realizar pagos mÃ¡s rÃ¡pidos"}),e.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white font-semibold rounded-xl hover:shadow-lg transition-all",children:[e.jsx(T,{className:"w-5 h-5 mr-2"}),"Agregar Primera Tarjeta"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(s=>e.jsxs("div",{className:`bg-gradient-to-br rounded-2xl p-6 shadow-lg text-white relative overflow-hidden ${s.cardBrand==="visa"?"from-blue-600 to-blue-800":s.cardBrand==="mastercard"?"from-orange-500 to-red-600":"from-slate-700 to-slate-900"}`,children:[e.jsxs("div",{className:"absolute inset-0 opacity-10",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full -mr-32 -mt-32"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white rounded-full -ml-24 -mb-24"})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-6",children:[e.jsx("div",{className:"text-4xl",children:G(s.cardBrand)}),e.jsx("div",{className:"text-right",children:s.isDefault&&e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/20 backdrop-blur-sm",children:[e.jsx(i,{className:"w-3 h-3 mr-1"}),"Predeterminada"]})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-white/70 mb-1",children:"NÃºmero de Tarjeta"}),e.jsxs("p",{className:"text-xl font-mono tracking-wider",children:["â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ â€¢â€¢â€¢â€¢ ",s.cardLast4]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-white/70 mb-1",children:"Titular"}),e.jsx("p",{className:"text-sm font-medium truncate",children:s.cardholderName})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-white/70 mb-1",children:"Vence"}),e.jsxs("p",{className:"text-sm font-medium",children:[s.cardExpMonth,"/",s.cardExpYear]})]})]}),s.autoPaymentEnabled&&e.jsx("div",{className:"mb-4",children:e.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-green-500/20 backdrop-blur-sm text-white",children:[e.jsx(i,{className:"w-3 h-3 mr-1"}),"Pagos AutomÃ¡ticos Activos"]})}),e.jsxs("div",{className:"flex items-center space-x-2 pt-4 border-t border-white/20",children:[!s.isDefault&&e.jsx("button",{onClick:()=>L(s.id),className:"flex-1 px-3 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg text-xs font-medium transition-colors",children:"Marcar como Principal"}),e.jsx("button",{onClick:()=>$(s.id,s.autoPaymentEnabled),className:"flex-1 px-3 py-2 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-lg text-xs font-medium transition-colors",title:s.autoPaymentEnabled?"Desactivar autopago":"Activar autopago",children:s.autoPaymentEnabled?"Desactivar Autopago":"Activar Autopago"}),e.jsx("button",{onClick:()=>Y(s.id),className:"p-2 bg-red-500/20 hover:bg-red-500/30 backdrop-blur-sm rounded-lg transition-colors",title:"Eliminar tarjeta",children:e.jsx(V,{className:"w-4 h-4"})})]})]})]},s.id))}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(b,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-blue-900 mb-2",children:"Seguridad de tus Datos"}),e.jsx("p",{className:"text-sm text-blue-800 mb-2",children:"Tus datos de tarjeta estÃ¡n protegidos con encriptaciÃ³n de nivel bancario. Nunca almacenamos el nÃºmero completo de tu tarjeta ni el CVV."}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsxs("li",{className:"flex items-center",children:[e.jsx(i,{className:"w-4 h-4 mr-2 text-green-600"}),"Los pagos son procesados de forma segura por Culqi"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(i,{className:"w-4 h-4 mr-2 text-green-600"}),"Puedes habilitar/deshabilitar pagos automÃ¡ticos en cualquier momento"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(i,{className:"w-4 h-4 mr-2 text-green-600"}),"Elimina tus tarjetas guardadas cuando lo desees"]})]})]})]})}),D&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-[#073372] to-[#17BC91] text-white px-8 py-6 rounded-t-3xl flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Agregar Nueva Tarjeta"}),e.jsx("p",{className:"text-white/90 text-sm mt-1",children:"Guarda tu tarjeta para pagos futuros"})]}),e.jsx("button",{onClick:()=>{l(!1),h()},className:"text-white/80 hover:text-white transition-colors p-2 hover:bg-white/10 rounded-lg",children:e.jsx(H,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-slate-600 bg-slate-50 py-3 px-4 rounded-lg",children:[e.jsx(b,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{children:"ConexiÃ³n segura - Tus datos estÃ¡n protegidos"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"NÃºmero de Tarjeta"}),e.jsx("input",{type:"text",value:c,onChange:s=>f(s.target.value.replace(/\s/g,"")),placeholder:"4111 1111 1111 1111",maxLength:16,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Nombre del Titular (como aparece en la tarjeta)"}),e.jsx("input",{type:"text",value:x,onChange:s=>N(s.target.value.toUpperCase()),placeholder:"JUAN PEREZ GARCIA",className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Mes"}),e.jsx("input",{type:"text",value:u,onChange:s=>v(s.target.value),placeholder:"MM",maxLength:2,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"AÃ±o"}),e.jsx("input",{type:"text",value:p,onChange:s=>w(s.target.value),placeholder:"YYYY",maxLength:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"CVV"}),e.jsx("input",{type:"text",value:y,onChange:s=>C(s.target.value),placeholder:"123",maxLength:4,className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-[#17BC91] focus:border-transparent"})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[m.length>0&&e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:k,onChange:s=>A(s.target.checked),className:"mt-1 w-5 h-5 text-[#17BC91] border-slate-300 rounded focus:ring-[#17BC91]"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-900",children:"Marcar como predeterminada"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Esta serÃ¡ tu tarjeta principal para pagos"})]})]}),e.jsxs("label",{className:"flex items-start space-x-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:P,onChange:s=>_(s.target.checked),className:"mt-1 w-5 h-5 text-blue-600 border-slate-300 rounded focus:ring-blue-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-slate-900",children:"Habilitar Pagos AutomÃ¡ticos"}),e.jsx("p",{className:"text-xs text-slate-600",children:"Tus cuotas se cobrarÃ¡n automÃ¡ticamente en la fecha de vencimiento"})]})]})]})]}),e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-xl",children:e.jsxs("p",{className:"text-sm text-amber-900 flex items-start space-x-2",children:[e.jsx(R,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),e.jsx("span",{children:"Al guardar tu tarjeta, aceptas que ANCED procese tus datos de forma segura para facilitar futuros pagos. Puedes eliminar esta tarjeta en cualquier momento."})]})})]}),e.jsxs("div",{className:"sticky bottom-0 bg-slate-50 px-8 py-6 rounded-b-3xl border-t border-slate-200 flex justify-end space-x-4",children:[e.jsx("button",{onClick:()=>{l(!1),h()},disabled:d,className:"px-6 py-3 border-2 border-slate-300 text-slate-700 font-semibold rounded-xl hover:bg-slate-100 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:q,disabled:d,className:`px-8 py-3 rounded-xl font-semibold transition-all flex items-center space-x-2 ${d?"bg-slate-400 cursor-not-allowed":"bg-gradient-to-r from-[#073372] to-[#17BC91] hover:shadow-lg hover:scale-105"} text-white`,children:d?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Guardando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{children:"Guardar Tarjeta"})]})})]})]})})]})]})};export{xe as default};
