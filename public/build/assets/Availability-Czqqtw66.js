import{r as n,j as e,H as Q,a as _}from"./app-CtWtaj7p.js";import{A as Z,t as o}from"./AuthenticatedLayout-SRBeiTFQ.js";import{I as ee}from"./input-C2gEPnGc.js";import{e as se,d as ae,D as te,a as re}from"./dialog-BXj9BnsP.js";import{B as c}from"./button-DRYv1lcU.js";import{C as D,c as T,d as A,a as B}from"./card-D1rNyoTy.js";import{S as ie}from"./switch-CFcW9Ny2.js";import{C as le}from"./calendar-weWaR35u.js";import{S as ne}from"./save-CPq5rw4F.js";import{L as oe}from"./link-2-Eaigruvb.js";import{C as ce}from"./circle-alert-CfMzKkkr.js";import{C as M}from"./circle-check-big-C4v64KOU.js";import{C as de}from"./clock-CTBaN94k.js";import{P as E}from"./plus-DSgA9FaP.js";import{X as me}from"./x-DO28QfK-.js";import{T as xe}from"./trash-2-DxeHrhs-.js";/* empty css            */import"./dropdown-menu-BzgWwHrw.js";import"./createLucideIcon-IGXxbhrr.js";import"./index-DH28hQTN.js";import"./index-0zIPZUJh.js";import"./index-Dm-T3bbY.js";import"./badge-BaAYWB2b.js";import"./triangle-alert-DyhuHxC7.js";import"./index-v1ew0dh6.js";import"./clsx-B-dksMZM.js";import"./index-BIamxBuN.js";const N=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"],$e=({teacher:f})=>{const[v,H]=n.useState(f.meet_url||""),[d,I]=n.useState(f.not_available_today),[i,h]=n.useState((f.time_slots||[]).map(s=>({...s,start_time:s.start_time.substring(0,5),end_time:s.end_time.substring(0,5)}))),[b,w]=n.useState(!1),[L,C]=n.useState(!1),[O,p]=n.useState(!1),[l,x]=n.useState([]),[m,u]=n.useState([{start:"09:00",end:"12:00"}]),R=s=>{h([...i,{day_of_week:s,start_time:"09:00",end_time:"12:00"}])},V=s=>{h(i.filter((a,t)=>t!==s))},k=(s,a,t)=>{const r=[...i];r[s]={...r[s],[a]:t},h(r)},$=()=>{u([...m,{start:"14:00",end:"17:00"}])},z=s=>{m.length>1&&u(m.filter((a,t)=>t!==s))},S=(s,a,t)=>{const r=[...m];r[s]={...r[s],[a]:t},u(r)},F=()=>{if(l.length===0){o.error("Selecciona al menos un día");return}const s=[];l.forEach(a=>{m.forEach(t=>{s.push({day_of_week:a,start_time:t.start,end_time:t.end})})}),h([...i,...s]),p(!1),x([]),u([{start:"09:00",end:"12:00"}]),o.success(`Se agregaron ${s.length} horarios`)},P=s=>{l.includes(s)?x(l.filter(a=>a!==s)):x([...l,s])},G=async()=>{if(i.filter(a=>{const[t,r]=a.start_time.split(":").map(Number),[j,g]=a.end_time.split(":").map(Number);return j*60+g-(t*60+r)<=0}).length>0){o.error("Hay horarios inválidos (Fin debe ser mayor a Inicio)");return}w(!0);try{await _.put("/teacher/availability",{meet_url:v||null,time_slots:i.map(a=>({day_of_week:a.day_of_week,start_time:a.start_time.substring(0,5),end_time:a.end_time.substring(0,5)}))}),o.success("Configuración guardada exitosamente")}catch{o.error("Error al guardar la configuración")}finally{w(!1)}},J=async()=>{C(!0);try{const s=await _.post("/teacher/toggle-availability");I(s.data.not_available_today),s.data.not_available_today?o.warning("Marcado como NO DISPONIBLE por hoy"):o.success("Marcado como DISPONIBLE hoy")}catch{o.error("Error al cambiar disponibilidad")}finally{C(!1)}},U=s=>({Lunes:"#073372",Martes:"#0ea5e9",Miércoles:"#17BC91",Jueves:"#8b5cf6",Viernes:"#ec4899",Sábado:"#f59e0b",Domingo:"#ef4444"})[s]||"#64748b";return e.jsxs(Z,{children:[e.jsx(Q,{title:"Mi Disponibilidad"}),e.jsxs("div",{className:"bg-gray-50 min-h-screen pb-12",children:[e.jsx("div",{className:"bg-white border-b sticky top-0 z-30 shadow-sm",children:e.jsx("div",{className:"w-full px-6 py-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Mi Disponibilidad"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Administra tus horarios de clase y preferencias"})]}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[e.jsxs(c,{variant:"outline",onClick:()=>p(!0),className:"flex-1 sm:flex-none",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Agregar Varios"]}),e.jsxs(c,{onClick:G,disabled:b,className:"bg-[#073372] hover:bg-[#062b61] text-white flex-1 sm:flex-none",children:[b?"Guardando...":"Guardar Cambios",!b&&e.jsx(ne,{className:"w-4 h-4 ml-2"})]})]})]})})}),e.jsxs("div",{className:"w-full px-6 py-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(D,{className:"md:col-span-2 shadow-sm border-gray-200",children:[e.jsx(T,{className:"pb-3",children:e.jsxs(A,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:e.jsx(oe,{className:"w-4 h-4 text-blue-700"})}),"Link de Google Meet"]})}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{placeholder:"https://meet.google.com/...",value:v,onChange:s=>H(s.target.value),className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Este enlace se enviará automáticamente a tus alumnos cuando se programe una clase."})]})})]}),e.jsxs(D,{className:`shadow-sm border transition-colors ${d?"border-red-200 bg-red-50/50":"border-emerald-200 bg-emerald-50/50"}`,children:[e.jsx(T,{className:"pb-3",children:e.jsxs(A,{className:"text-base font-semibold flex items-center gap-2",children:[e.jsx("div",{className:`p-1.5 rounded-lg ${d?"bg-red-100":"bg-emerald-100"}`,children:d?e.jsx(ce,{className:"w-4 h-4 text-red-700"}):e.jsx(M,{className:"w-4 h-4 text-emerald-700"})}),"Estado de Hoy"]})}),e.jsx(B,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm font-medium ${d?"text-red-700":"text-emerald-700"}`,children:d?"NO Disponible":"Disponible"}),e.jsx(ie,{checked:!d,onCheckedChange:J,disabled:L,className:"data-[state=checked]:bg-[#17BC91]"})]}),e.jsx("p",{className:"text-xs text-gray-500 leading-tight",children:d?"Has indicado que no puedes atender hoy. No recibirás nuevas asignaciones por el resto del día.":"Estás disponible para recibir clases hoy según tus horarios configurados."})]})})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(de,{className:"w-5 h-5 text-gray-400"}),"Horarios Semanales"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:N.map(s=>{const a=i.filter(r=>r.day_of_week===s),t=U(s);return e.jsxs("div",{className:"flex flex-col bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden h-full",children:[e.jsxs("div",{className:"px-4 py-3 border-b flex items-center justify-between bg-gray-50/50",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center font-bold text-white shadow-sm text-xs",style:{backgroundColor:t},children:s.substring(0,3).toUpperCase()}),e.jsx("span",{className:"font-semibold text-gray-900",children:s})]}),e.jsx(c,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 text-gray-400 hover:text-[#073372] hover:bg-white",onClick:()=>R(s),title:"Agregar Horario",children:e.jsx(E,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 space-y-3 flex-1",children:a.length===0?e.jsx("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 py-6 text-sm",children:e.jsx("span",{children:"No hay horarios"})}):a.map((r,j)=>{const g=i.indexOf(r),[q,K]=r.start_time.split(":").map(Number),[W,X]=r.end_time.split(":").map(Number),Y=W*60+X>q*60+K;return e.jsxs("div",{className:"flex items-center gap-2 group animate-in slide-in-from-left-2 duration-200",children:[e.jsxs("div",{className:`flex-1 flex items-center gap-2 p-1.5 rounded-lg border ${Y?"border-gray-200 bg-white":"border-red-300 bg-red-50"}`,children:[e.jsx("input",{type:"time",className:"flex-1 min-w-0 bg-transparent border-none text-sm font-medium text-gray-900 focus:ring-0 p-0 text-center",value:r.start_time,onChange:y=>k(g,"start_time",y.target.value)}),e.jsx("span",{className:"text-gray-400 text-xs",children:"➜"}),e.jsx("input",{type:"time",className:"flex-1 min-w-0 bg-transparent border-none text-sm font-medium text-gray-900 focus:ring-0 p-0 text-center",value:r.end_time,onChange:y=>k(g,"end_time",y.target.value)})]}),e.jsx("button",{onClick:()=>V(g),className:"text-gray-300 hover:text-red-500 transition-colors p-1",children:e.jsx(me,{className:"w-4 h-4"})})]},j)})}),a.length>0&&e.jsxs("div",{className:"bg-gray-50 px-4 py-2 border-t text-xs text-gray-500 text-center",children:[a.length," horarios configurados"]})]},s)})})]})]}),e.jsx(se,{open:O,onOpenChange:p,children:e.jsxs(ae,{className:"max-w-3xl",children:[e.jsx(te,{children:e.jsx(re,{children:"Configuración Rápida de Horarios"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"bg-[#073372] text-white w-5 h-5 rounded-full flex items-center justify-center text-xs",children:"1"}),"Selecciona los días"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(c,{variant:"outline",size:"sm",onClick:()=>x(["Lunes","Martes","Miércoles","Jueves","Viernes"]),className:"w-full text-xs",children:"Lun - Vie"}),e.jsx(c,{variant:"outline",size:"sm",onClick:()=>x(N),className:"w-full text-xs",children:"Todos"})]}),e.jsx("div",{className:"space-y-2",children:N.map(s=>e.jsxs("div",{onClick:()=>P(s),className:`
                                        flex items-center justify-between p-2 rounded-lg cursor-pointer border transition-all text-sm
                                        ${l.includes(s)?"border-[#073372] bg-blue-50 text-[#073372]":"border-gray-100 hover:bg-gray-50 text-gray-600"}
                                    `,children:[e.jsx("span",{children:s}),l.includes(s)&&e.jsx(M,{className:"w-4 h-4"})]},s))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"bg-[#F98613] text-white w-5 h-5 rounded-full flex items-center justify-center text-xs",children:"2"}),"Define los horarios"]}),e.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto pr-2",children:m.map((s,a)=>e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-gray-50 rounded-lg border border-gray-100",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2 flex-1",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[10px] uppercase text-gray-500 font-bold",children:"Inicio"}),e.jsx("input",{type:"time",className:"w-full text-sm bg-white border border-gray-200 rounded px-2 py-1",value:s.start,onChange:t=>S(a,"start",t.target.value)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-[10px] uppercase text-gray-500 font-bold",children:"Fin"}),e.jsx("input",{type:"time",className:"w-full text-sm bg-white border border-gray-200 rounded px-2 py-1",value:s.end,onChange:t=>S(a,"end",t.target.value)})]})]}),m.length>1&&e.jsx("button",{onClick:()=>z(a),className:"text-gray-400 hover:text-red-500 mt-4",children:e.jsx(xe,{className:"w-4 h-4"})})]},a))}),e.jsxs(c,{variant:"outline",size:"sm",onClick:$,className:"w-full border-dashed",children:[e.jsx(E,{className:"w-3 h-3 mr-2"})," Agregar otro rango"]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(c,{variant:"ghost",onClick:()=>p(!1),children:"Cancelar"}),e.jsx(c,{onClick:F,disabled:l.length===0,className:"bg-[#073372] hover:bg-[#062b61] text-white",children:"Agregar Horarios"})]})]})})]})]})};export{$e as default};
